(function(u,yt){typeof exports=="object"&&typeof module<"u"?yt(exports):typeof define=="function"&&define.amd?define(["exports"],yt):(u=typeof globalThis<"u"?globalThis:u||self,yt(u.deepslate={}))})(this,function(u){"use strict";var Ou=Object.defineProperty;var zu=(u,yt,xe)=>yt in u?Ou(u,yt,{enumerable:!0,configurable:!0,writable:!0,value:xe}):u[yt]=xe;var _=(u,yt,xe)=>(zu(u,typeof yt!="symbol"?yt+"":yt,xe),xe);function yt(n){var t=n.slice(0,2);return t.length===2&&t[0]===31&&t[1]===139}function xe(n){const t=n.slice(0,2);return t.length===2&&t[0]===120&&(t[1]===1||t[1]===94||t[1]===156||t[2]===218)}function ua(n){const t=n.slice(0,8),e=new DataView(t.buffer,t.byteOffset),r=e.getUint32(0,!0),i=e.getUint32(4,!0);if(t.length===8&&r>0&&r<100&&i===n.byteLength-8)return r}function ha(n){var t=[],e,r;for(e=0;e<n.length;e++)r=n.charCodeAt(e),r<128?t.push(r):r<2048?(t.push(192|r>>6),t.push(128|r&63)):r<65536?(t.push(224|r>>12),t.push(128|r>>6&63),t.push(128|r&63)):(t.push(240|r>>18&7),t.push(128|r>>12&63),t.push(128|r>>6&63),t.push(128|r&63));return t}function fa(n){var t=[],e;for(e=0;e<n.length;e++)(n[e]&128)===0?t.push(n[e]&127):e+1<n.length&&(n[e]&224)===192&&(n[e+1]&192)===128?t.push((n[e]&31)<<6|n[e+1]&63):e+2<n.length&&(n[e]&240)===224&&(n[e+1]&192)===128&&(n[e+2]&192)===128?t.push((n[e]&15)<<12|(n[e+1]&63)<<6|n[e+2]&63):e+3<n.length&&(n[e]&248)===240&&(n[e+1]&192)===128&&(n[e+2]&192)===128&&(n[e+3]&192)===128&&t.push((n[e]&7)<<18|(n[e+1]&63)<<12|(n[e+2]&63)<<6|n[e+3]&63);return String.fromCharCode.apply(null,t)}class ui{constructor(t,e){_(this,"littleEndian");_(this,"offset");_(this,"array");_(this,"view");_(this,"readByte",this.readNumber.bind(this,"getInt8",1));_(this,"readShort",this.readNumber.bind(this,"getInt16",2));_(this,"readInt",this.readNumber.bind(this,"getInt32",4));_(this,"readFloat",this.readNumber.bind(this,"getFloat32",4));_(this,"readDouble",this.readNumber.bind(this,"getFloat64",8));var r,i;this.littleEndian=(r=e==null?void 0:e.littleEndian)!=null?r:!1,this.offset=(i=e==null?void 0:e.offset)!=null?i:0,this.array=t instanceof Uint8Array?t:new Uint8Array(t),this.view=new DataView(this.array.buffer,this.array.byteOffset)}readNumber(t,e){const r=this.view[t](this.offset,this.littleEndian);return this.offset+=e,r}readBytes(t){const e=this.array.slice(this.offset,this.offset+t);return this.offset+=t,e}readString(){const t=this.readShort(),e=this.readBytes(t);return fa(e)}}class hi{constructor(t){_(this,"littleEndian");_(this,"offset");_(this,"buffer");_(this,"array");_(this,"view");_(this,"writeByte",this.writeNumber.bind(this,"setInt8",1));_(this,"writeShort",this.writeNumber.bind(this,"setInt16",2));_(this,"writeInt",this.writeNumber.bind(this,"setInt32",4));_(this,"writeFloat",this.writeNumber.bind(this,"setFloat32",4));_(this,"writeDouble",this.writeNumber.bind(this,"setFloat64",8));var e,r,i;this.littleEndian=(e=t==null?void 0:t.littleEndian)!=null?e:!1,this.offset=(r=t==null?void 0:t.offset)!=null?r:0,this.buffer=new ArrayBuffer((i=t==null?void 0:t.initialSize)!=null?i:1024),this.array=new Uint8Array(this.buffer),this.view=new DataView(this.buffer)}accommodate(t){const e=this.offset+t;if(this.buffer.byteLength>=e)return;let r=this.buffer.byteLength;for(;r<e;)r*=2;const i=new ArrayBuffer(r),s=new Uint8Array(i);s.set(this.array),this.offset>this.buffer.byteLength&&s.fill(0,this.buffer.byteLength,this.offset),this.buffer=i,this.view=new DataView(i),this.array=s}writeNumber(t,e,r){this.accommodate(e),this.view[t](this.offset,r,this.littleEndian),this.offset+=e}writeBytes(t){this.accommodate(t.length),this.array.set(t,this.offset),this.offset+=t.length}writeString(t){const e=ha(t);this.writeShort(e.length),this.writeBytes(e)}getData(){return this.accommodate(0),this.array.slice(0,this.offset)}}u.Json=void 0,(n=>{function t(d){return typeof d=="number"?d:void 0}n.readNumber=t;function e(d){return typeof d=="number"?Math.floor(d):void 0}n.readInt=e;function r(d){return typeof d=="string"?d:void 0}n.readString=r;function i(d){return typeof d=="boolean"?d:void 0}n.readBoolean=i;function s(d){return typeof d=="object"&&d!==null&&!Array.isArray(d)?d:void 0}n.readObject=s;function o(d,g){if(!!Array.isArray(d))return g?d.map(f=>g(f)):d}n.readArray=o;function a(d,g){if(!!Array.isArray(d))return[0,1].map(f=>g(d[f]))}n.readPair=a;function h(d,g){var p;const f=(p=s(d))!=null?p:{};return Object.fromEntries(Object.entries(f).map(([E,m])=>[E,g(m)]))}n.readMap=h;function l(d,g,f){const p=g(d);return p?f(p):void 0}n.compose=l;function c(d,g){return typeof d!="string"?g[0]:g.includes(d)?d:g[0]}n.readEnum=c})(u.Json||(u.Json={}));class St{constructor(t){_(this,"source");_(this,"cursor");this.source=t,this.cursor=0}get remainingLength(){return this.source.length-this.cursor}get totalLength(){return this.source.length}getRead(t=0){return this.source.substring(t,this.cursor)}getRemaining(){return this.source.substring(this.cursor)}canRead(t=1){return this.cursor+t<=this.source.length}peek(t=0){return this.source.charAt(this.cursor+t)}read(){return this.source.charAt(this.cursor++)}skip(){this.cursor+=1}skipWhitespace(){for(;this.canRead()&&St.isWhitespace(this.peek());)this.skip()}expect(t,e=!1){if(e&&this.skipWhitespace(),!this.canRead()||this.peek()!==t)throw this.createError(`Expected '${t}'`);this.skip()}readInt(){const t=this.cursor;for(;this.canRead()&&St.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(e.length===0)throw this.createError("Expected integer");try{const r=Number(e);if(isNaN(r)||!Number.isInteger(r))throw new Error;return r}catch{throw this.cursor=t,this.createError(`Invalid integer '${e}'`)}}readFloat(){const t=this.cursor;for(;this.canRead()&&St.isAllowedInNumber(this.peek());)this.skip();const e=this.getRead(t);if(e.length===0)throw this.createError("Expected float");try{const r=Number(e);if(isNaN(r))throw new Error;return r}catch{throw this.cursor=t,this.createError(`Invalid float '${e}'`)}}readUnquotedString(){const t=this.cursor;for(;this.canRead()&&St.isAllowedInUnquotedString(this.peek());)this.skip();return this.getRead(t)}readQuotedString(){if(!this.canRead())return"";const t=this.peek();if(!St.isQuotedStringStart(t))throw this.createError("Expected quote to start a string");return this.skip(),this.readStringUntil(t)}readString(){if(!this.canRead())return"";const t=this.peek();return St.isQuotedStringStart(t)?(this.skip(),this.readStringUntil(t)):this.readUnquotedString()}readStringUntil(t){const e=[];let r=!1;for(;this.canRead();){const i=this.read();if(r)if(i===t||i==="\\")e.push(i),r=!1;else throw this.cursor-=1,this.createError(`Invalid escape sequence '${i}' in quoted string`);else if(i==="\\")r=!0;else{if(i===t)return e.join("");e.push(i)}}throw this.createError("Unclosed quoted string")}readBoolean(){const t=this.cursor,e=this.readUnquotedString();if(e.length===0)throw this.createError("Expected bool");if(e==="true")return!0;if(e==="false")return!1;throw this.cursor=t,this.createError(`Invalid bool, expected true or false but found '${e}'`)}static isAllowedInNumber(t){return t>="0"&&t<="9"||t==="."||t==="-"}static isAllowedInUnquotedString(t){return t>="0"&&t<="9"||t>="A"&&t<="Z"||t>="a"&&t<="z"||t==="_"||t==="-"||t==="."||t==="+"}static isQuotedStringStart(t){return t==="'"||t==='"'}static isWhitespace(t){return t===" "||t==="	"||t===`
`||t==="\r"}createError(t){const e=Math.min(this.source.length,this.cursor),r=(e>10?"...":"")+this.source.substring(Math.max(0,e-10),e);return new Error(`${t} at position ${this.cursor}: ${r}<--[HERE]`)}}function on(n){let t=null;return()=>(t==null&&(t=n()),t)}function ke(n,t,e){const r=n.get(t);if(r!==void 0)return r;const i=e(t);return n.set(t,i),i}function _r(n,t,e,r){const i=n.get(t),s=i!=null?i:e;return r(s,t),n.set(t,s),s}function dt(n){const t=n>>16&255,e=n>>8&255,r=n&255;return[t/255,e/255,r/255]}/*! pako 2.0.4 https://github.com/nodeca/pako @license (MIT AND Zlib) */const da=4,fi=0,di=1,ga=2;function Ge(n){let t=n.length;for(;--t>=0;)n[t]=0}const ma=0,gi=1,pa=2,wa=3,va=258,br=29,ln=256,cn=ln+1+br,Ve=30,yr=19,mi=2*cn+1,Ae=15,Sr=16,_a=7,Er=256,pi=16,wi=17,vi=18,Ir=new Uint8Array([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0]),Fn=new Uint8Array([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13]),ba=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7]),_i=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ya=512,$t=new Array((cn+2)*2);Ge($t);const un=new Array(Ve*2);Ge(un);const hn=new Array(ya);Ge(hn);const fn=new Array(va-wa+1);Ge(fn);const xr=new Array(br);Ge(xr);const Un=new Array(Ve);Ge(Un);function kr(n,t,e,r,i){this.static_tree=n,this.extra_bits=t,this.extra_base=e,this.elems=r,this.max_length=i,this.has_stree=n&&n.length}let bi,yi,Si;function Ar(n,t){this.dyn_tree=n,this.max_code=0,this.stat_desc=t}const Ei=n=>n<256?hn[n]:hn[256+(n>>>7)],dn=(n,t)=>{n.pending_buf[n.pending++]=t&255,n.pending_buf[n.pending++]=t>>>8&255},vt=(n,t,e)=>{n.bi_valid>Sr-e?(n.bi_buf|=t<<n.bi_valid&65535,dn(n,n.bi_buf),n.bi_buf=t>>Sr-n.bi_valid,n.bi_valid+=e-Sr):(n.bi_buf|=t<<n.bi_valid&65535,n.bi_valid+=e)},Jt=(n,t,e)=>{vt(n,e[t*2],e[t*2+1])},Ii=(n,t)=>{let e=0;do e|=n&1,n>>>=1,e<<=1;while(--t>0);return e>>>1},Sa=n=>{n.bi_valid===16?(dn(n,n.bi_buf),n.bi_buf=0,n.bi_valid=0):n.bi_valid>=8&&(n.pending_buf[n.pending++]=n.bi_buf&255,n.bi_buf>>=8,n.bi_valid-=8)},Ea=(n,t)=>{const e=t.dyn_tree,r=t.max_code,i=t.stat_desc.static_tree,s=t.stat_desc.has_stree,o=t.stat_desc.extra_bits,a=t.stat_desc.extra_base,h=t.stat_desc.max_length;let l,c,d,g,f,p,E=0;for(g=0;g<=Ae;g++)n.bl_count[g]=0;for(e[n.heap[n.heap_max]*2+1]=0,l=n.heap_max+1;l<mi;l++)c=n.heap[l],g=e[e[c*2+1]*2+1]+1,g>h&&(g=h,E++),e[c*2+1]=g,!(c>r)&&(n.bl_count[g]++,f=0,c>=a&&(f=o[c-a]),p=e[c*2],n.opt_len+=p*(g+f),s&&(n.static_len+=p*(i[c*2+1]+f)));if(E!==0){do{for(g=h-1;n.bl_count[g]===0;)g--;n.bl_count[g]--,n.bl_count[g+1]+=2,n.bl_count[h]--,E-=2}while(E>0);for(g=h;g!==0;g--)for(c=n.bl_count[g];c!==0;)d=n.heap[--l],!(d>r)&&(e[d*2+1]!==g&&(n.opt_len+=(g-e[d*2+1])*e[d*2],e[d*2+1]=g),c--)}},xi=(n,t,e)=>{const r=new Array(Ae+1);let i=0,s,o;for(s=1;s<=Ae;s++)r[s]=i=i+e[s-1]<<1;for(o=0;o<=t;o++){let a=n[o*2+1];a!==0&&(n[o*2]=Ii(r[a]++,a))}},Ia=()=>{let n,t,e,r,i;const s=new Array(Ae+1);for(e=0,r=0;r<br-1;r++)for(xr[r]=e,n=0;n<1<<Ir[r];n++)fn[e++]=r;for(fn[e-1]=r,i=0,r=0;r<16;r++)for(Un[r]=i,n=0;n<1<<Fn[r];n++)hn[i++]=r;for(i>>=7;r<Ve;r++)for(Un[r]=i<<7,n=0;n<1<<Fn[r]-7;n++)hn[256+i++]=r;for(t=0;t<=Ae;t++)s[t]=0;for(n=0;n<=143;)$t[n*2+1]=8,n++,s[8]++;for(;n<=255;)$t[n*2+1]=9,n++,s[9]++;for(;n<=279;)$t[n*2+1]=7,n++,s[7]++;for(;n<=287;)$t[n*2+1]=8,n++,s[8]++;for(xi($t,cn+1,s),n=0;n<Ve;n++)un[n*2+1]=5,un[n*2]=Ii(n,5);bi=new kr($t,Ir,ln+1,cn,Ae),yi=new kr(un,Fn,0,Ve,Ae),Si=new kr(new Array(0),ba,0,yr,_a)},ki=n=>{let t;for(t=0;t<cn;t++)n.dyn_ltree[t*2]=0;for(t=0;t<Ve;t++)n.dyn_dtree[t*2]=0;for(t=0;t<yr;t++)n.bl_tree[t*2]=0;n.dyn_ltree[Er*2]=1,n.opt_len=n.static_len=0,n.last_lit=n.matches=0},Ai=n=>{n.bi_valid>8?dn(n,n.bi_buf):n.bi_valid>0&&(n.pending_buf[n.pending++]=n.bi_buf),n.bi_buf=0,n.bi_valid=0},xa=(n,t,e,r)=>{Ai(n),r&&(dn(n,e),dn(n,~e)),n.pending_buf.set(n.window.subarray(t,t+e),n.pending),n.pending+=e},Mi=(n,t,e,r)=>{const i=t*2,s=e*2;return n[i]<n[s]||n[i]===n[s]&&r[t]<=r[e]},Mr=(n,t,e)=>{const r=n.heap[e];let i=e<<1;for(;i<=n.heap_len&&(i<n.heap_len&&Mi(t,n.heap[i+1],n.heap[i],n.depth)&&i++,!Mi(t,r,n.heap[i],n.depth));)n.heap[e]=n.heap[i],e=i,i<<=1;n.heap[e]=r},Ri=(n,t,e)=>{let r,i,s=0,o,a;if(n.last_lit!==0)do r=n.pending_buf[n.d_buf+s*2]<<8|n.pending_buf[n.d_buf+s*2+1],i=n.pending_buf[n.l_buf+s],s++,r===0?Jt(n,i,t):(o=fn[i],Jt(n,o+ln+1,t),a=Ir[o],a!==0&&(i-=xr[o],vt(n,i,a)),r--,o=Ei(r),Jt(n,o,e),a=Fn[o],a!==0&&(r-=Un[o],vt(n,r,a)));while(s<n.last_lit);Jt(n,Er,t)},Rr=(n,t)=>{const e=t.dyn_tree,r=t.stat_desc.static_tree,i=t.stat_desc.has_stree,s=t.stat_desc.elems;let o,a,h=-1,l;for(n.heap_len=0,n.heap_max=mi,o=0;o<s;o++)e[o*2]!==0?(n.heap[++n.heap_len]=h=o,n.depth[o]=0):e[o*2+1]=0;for(;n.heap_len<2;)l=n.heap[++n.heap_len]=h<2?++h:0,e[l*2]=1,n.depth[l]=0,n.opt_len--,i&&(n.static_len-=r[l*2+1]);for(t.max_code=h,o=n.heap_len>>1;o>=1;o--)Mr(n,e,o);l=s;do o=n.heap[1],n.heap[1]=n.heap[n.heap_len--],Mr(n,e,1),a=n.heap[1],n.heap[--n.heap_max]=o,n.heap[--n.heap_max]=a,e[l*2]=e[o*2]+e[a*2],n.depth[l]=(n.depth[o]>=n.depth[a]?n.depth[o]:n.depth[a])+1,e[o*2+1]=e[a*2+1]=l,n.heap[1]=l++,Mr(n,e,1);while(n.heap_len>=2);n.heap[--n.heap_max]=n.heap[1],Ea(n,t),xi(e,h,n.bl_count)},Ni=(n,t,e)=>{let r,i=-1,s,o=t[0*2+1],a=0,h=7,l=4;for(o===0&&(h=138,l=3),t[(e+1)*2+1]=65535,r=0;r<=e;r++)s=o,o=t[(r+1)*2+1],!(++a<h&&s===o)&&(a<l?n.bl_tree[s*2]+=a:s!==0?(s!==i&&n.bl_tree[s*2]++,n.bl_tree[pi*2]++):a<=10?n.bl_tree[wi*2]++:n.bl_tree[vi*2]++,a=0,i=s,o===0?(h=138,l=3):s===o?(h=6,l=3):(h=7,l=4))},Bi=(n,t,e)=>{let r,i=-1,s,o=t[0*2+1],a=0,h=7,l=4;for(o===0&&(h=138,l=3),r=0;r<=e;r++)if(s=o,o=t[(r+1)*2+1],!(++a<h&&s===o)){if(a<l)do Jt(n,s,n.bl_tree);while(--a!==0);else s!==0?(s!==i&&(Jt(n,s,n.bl_tree),a--),Jt(n,pi,n.bl_tree),vt(n,a-3,2)):a<=10?(Jt(n,wi,n.bl_tree),vt(n,a-3,3)):(Jt(n,vi,n.bl_tree),vt(n,a-11,7));a=0,i=s,o===0?(h=138,l=3):s===o?(h=6,l=3):(h=7,l=4)}},ka=n=>{let t;for(Ni(n,n.dyn_ltree,n.l_desc.max_code),Ni(n,n.dyn_dtree,n.d_desc.max_code),Rr(n,n.bl_desc),t=yr-1;t>=3&&n.bl_tree[_i[t]*2+1]===0;t--);return n.opt_len+=3*(t+1)+5+5+4,t},Aa=(n,t,e,r)=>{let i;for(vt(n,t-257,5),vt(n,e-1,5),vt(n,r-4,4),i=0;i<r;i++)vt(n,n.bl_tree[_i[i]*2+1],3);Bi(n,n.dyn_ltree,t-1),Bi(n,n.dyn_dtree,e-1)},Ma=n=>{let t=4093624447,e;for(e=0;e<=31;e++,t>>>=1)if(t&1&&n.dyn_ltree[e*2]!==0)return fi;if(n.dyn_ltree[9*2]!==0||n.dyn_ltree[10*2]!==0||n.dyn_ltree[13*2]!==0)return di;for(e=32;e<ln;e++)if(n.dyn_ltree[e*2]!==0)return di;return fi};let Ci=!1;const Ra=n=>{Ci||(Ia(),Ci=!0),n.l_desc=new Ar(n.dyn_ltree,bi),n.d_desc=new Ar(n.dyn_dtree,yi),n.bl_desc=new Ar(n.bl_tree,Si),n.bi_buf=0,n.bi_valid=0,ki(n)},Ti=(n,t,e,r)=>{vt(n,(ma<<1)+(r?1:0),3),xa(n,t,e,!0)},Na=n=>{vt(n,gi<<1,3),Jt(n,Er,$t),Sa(n)},Ba=(n,t,e,r)=>{let i,s,o=0;n.level>0?(n.strm.data_type===ga&&(n.strm.data_type=Ma(n)),Rr(n,n.l_desc),Rr(n,n.d_desc),o=ka(n),i=n.opt_len+3+7>>>3,s=n.static_len+3+7>>>3,s<=i&&(i=s)):i=s=e+5,e+4<=i&&t!==-1?Ti(n,t,e,r):n.strategy===da||s===i?(vt(n,(gi<<1)+(r?1:0),3),Ri(n,$t,un)):(vt(n,(pa<<1)+(r?1:0),3),Aa(n,n.l_desc.max_code+1,n.d_desc.max_code+1,o+1),Ri(n,n.dyn_ltree,n.dyn_dtree)),ki(n),r&&Ai(n)},Ca=(n,t,e)=>(n.pending_buf[n.d_buf+n.last_lit*2]=t>>>8&255,n.pending_buf[n.d_buf+n.last_lit*2+1]=t&255,n.pending_buf[n.l_buf+n.last_lit]=e&255,n.last_lit++,t===0?n.dyn_ltree[e*2]++:(n.matches++,t--,n.dyn_ltree[(fn[e]+ln+1)*2]++,n.dyn_dtree[Ei(t)*2]++),n.last_lit===n.lit_bufsize-1);var Ta=Ra,La=Ti,Pa=Ba,Oa=Ca,za=Na,Ja={_tr_init:Ta,_tr_stored_block:La,_tr_flush_block:Pa,_tr_tally:Oa,_tr_align:za},gn=(n,t,e,r)=>{let i=n&65535|0,s=n>>>16&65535|0,o=0;for(;e!==0;){o=e>2e3?2e3:e,e-=o;do i=i+t[r++]|0,s=s+i|0;while(--o);i%=65521,s%=65521}return i|s<<16|0};const Da=()=>{let n,t=[];for(var e=0;e<256;e++){n=e;for(var r=0;r<8;r++)n=n&1?3988292384^n>>>1:n>>>1;t[e]=n}return t},Fa=new Uint32Array(Da());var ct=(n,t,e,r)=>{const i=Fa,s=r+e;n^=-1;for(let o=r;o<s;o++)n=n>>>8^i[(n^t[o])&255];return n^-1},Me={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"},Re={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_MEM_ERROR:-4,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8};const{_tr_init:Ua,_tr_stored_block:Za,_tr_flush_block:Ha,_tr_tally:ae,_tr_align:Ga}=Ja,{Z_NO_FLUSH:Ne,Z_PARTIAL_FLUSH:Va,Z_FULL_FLUSH:$a,Z_FINISH:oe,Z_BLOCK:Li,Z_OK:Dt,Z_STREAM_END:Pi,Z_STREAM_ERROR:xt,Z_DATA_ERROR:Ya,Z_BUF_ERROR:Nr,Z_DEFAULT_COMPRESSION:qa,Z_FILTERED:Wa,Z_HUFFMAN_ONLY:Zn,Z_RLE:Xa,Z_FIXED:ja,Z_DEFAULT_STRATEGY:Ka,Z_UNKNOWN:Qa,Z_DEFLATED:Hn}=Re,to=9,eo=15,no=8,ro=29,Br=256+1+ro,io=30,so=19,ao=2*Br+1,oo=15,V=3,le=258,Ct=le+V+1,lo=32,Gn=42,Cr=69,Vn=73,$n=91,Yn=103,Be=113,mn=666,it=1,pn=2,Ce=3,$e=4,co=3,ce=(n,t)=>(n.msg=Me[t],t),Oi=n=>(n<<1)-(n>4?9:0),ue=n=>{let t=n.length;for(;--t>=0;)n[t]=0};let he=(n,t,e)=>(t<<n.hash_shift^e)&n.hash_mask;const fe=n=>{const t=n.state;let e=t.pending;e>n.avail_out&&(e=n.avail_out),e!==0&&(n.output.set(t.pending_buf.subarray(t.pending_out,t.pending_out+e),n.next_out),n.next_out+=e,t.pending_out+=e,n.total_out+=e,n.avail_out-=e,t.pending-=e,t.pending===0&&(t.pending_out=0))},ut=(n,t)=>{Ha(n,n.block_start>=0?n.block_start:-1,n.strstart-n.block_start,t),n.block_start=n.strstart,fe(n.strm)},$=(n,t)=>{n.pending_buf[n.pending++]=t},wn=(n,t)=>{n.pending_buf[n.pending++]=t>>>8&255,n.pending_buf[n.pending++]=t&255},uo=(n,t,e,r)=>{let i=n.avail_in;return i>r&&(i=r),i===0?0:(n.avail_in-=i,t.set(n.input.subarray(n.next_in,n.next_in+i),e),n.state.wrap===1?n.adler=gn(n.adler,t,i,e):n.state.wrap===2&&(n.adler=ct(n.adler,t,i,e)),n.next_in+=i,n.total_in+=i,i)},zi=(n,t)=>{let e=n.max_chain_length,r=n.strstart,i,s,o=n.prev_length,a=n.nice_match;const h=n.strstart>n.w_size-Ct?n.strstart-(n.w_size-Ct):0,l=n.window,c=n.w_mask,d=n.prev,g=n.strstart+le;let f=l[r+o-1],p=l[r+o];n.prev_length>=n.good_match&&(e>>=2),a>n.lookahead&&(a=n.lookahead);do if(i=t,!(l[i+o]!==p||l[i+o-1]!==f||l[i]!==l[r]||l[++i]!==l[r+1])){r+=2,i++;do;while(l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&l[++r]===l[++i]&&r<g);if(s=le-(g-r),r=g-le,s>o){if(n.match_start=t,o=s,s>=a)break;f=l[r+o-1],p=l[r+o]}}while((t=d[t&c])>h&&--e!==0);return o<=n.lookahead?o:n.lookahead},Te=n=>{const t=n.w_size;let e,r,i,s,o;do{if(s=n.window_size-n.lookahead-n.strstart,n.strstart>=t+(t-Ct)){n.window.set(n.window.subarray(t,t+t),0),n.match_start-=t,n.strstart-=t,n.block_start-=t,r=n.hash_size,e=r;do i=n.head[--e],n.head[e]=i>=t?i-t:0;while(--r);r=t,e=r;do i=n.prev[--e],n.prev[e]=i>=t?i-t:0;while(--r);s+=t}if(n.strm.avail_in===0)break;if(r=uo(n.strm,n.window,n.strstart+n.lookahead,s),n.lookahead+=r,n.lookahead+n.insert>=V)for(o=n.strstart-n.insert,n.ins_h=n.window[o],n.ins_h=he(n,n.ins_h,n.window[o+1]);n.insert&&(n.ins_h=he(n,n.ins_h,n.window[o+V-1]),n.prev[o&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=o,o++,n.insert--,!(n.lookahead+n.insert<V)););}while(n.lookahead<Ct&&n.strm.avail_in!==0)},ho=(n,t)=>{let e=65535;for(e>n.pending_buf_size-5&&(e=n.pending_buf_size-5);;){if(n.lookahead<=1){if(Te(n),n.lookahead===0&&t===Ne)return it;if(n.lookahead===0)break}n.strstart+=n.lookahead,n.lookahead=0;const r=n.block_start+e;if((n.strstart===0||n.strstart>=r)&&(n.lookahead=n.strstart-r,n.strstart=r,ut(n,!1),n.strm.avail_out===0)||n.strstart-n.block_start>=n.w_size-Ct&&(ut(n,!1),n.strm.avail_out===0))return it}return n.insert=0,t===oe?(ut(n,!0),n.strm.avail_out===0?Ce:$e):(n.strstart>n.block_start&&(ut(n,!1),n.strm.avail_out===0),it)},Tr=(n,t)=>{let e,r;for(;;){if(n.lookahead<Ct){if(Te(n),n.lookahead<Ct&&t===Ne)return it;if(n.lookahead===0)break}if(e=0,n.lookahead>=V&&(n.ins_h=he(n,n.ins_h,n.window[n.strstart+V-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),e!==0&&n.strstart-e<=n.w_size-Ct&&(n.match_length=zi(n,e)),n.match_length>=V)if(r=ae(n,n.strstart-n.match_start,n.match_length-V),n.lookahead-=n.match_length,n.match_length<=n.max_lazy_match&&n.lookahead>=V){n.match_length--;do n.strstart++,n.ins_h=he(n,n.ins_h,n.window[n.strstart+V-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart;while(--n.match_length!==0);n.strstart++}else n.strstart+=n.match_length,n.match_length=0,n.ins_h=n.window[n.strstart],n.ins_h=he(n,n.ins_h,n.window[n.strstart+1]);else r=ae(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++;if(r&&(ut(n,!1),n.strm.avail_out===0))return it}return n.insert=n.strstart<V-1?n.strstart:V-1,t===oe?(ut(n,!0),n.strm.avail_out===0?Ce:$e):n.last_lit&&(ut(n,!1),n.strm.avail_out===0)?it:pn},Ye=(n,t)=>{let e,r,i;for(;;){if(n.lookahead<Ct){if(Te(n),n.lookahead<Ct&&t===Ne)return it;if(n.lookahead===0)break}if(e=0,n.lookahead>=V&&(n.ins_h=he(n,n.ins_h,n.window[n.strstart+V-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart),n.prev_length=n.match_length,n.prev_match=n.match_start,n.match_length=V-1,e!==0&&n.prev_length<n.max_lazy_match&&n.strstart-e<=n.w_size-Ct&&(n.match_length=zi(n,e),n.match_length<=5&&(n.strategy===Wa||n.match_length===V&&n.strstart-n.match_start>4096)&&(n.match_length=V-1)),n.prev_length>=V&&n.match_length<=n.prev_length){i=n.strstart+n.lookahead-V,r=ae(n,n.strstart-1-n.prev_match,n.prev_length-V),n.lookahead-=n.prev_length-1,n.prev_length-=2;do++n.strstart<=i&&(n.ins_h=he(n,n.ins_h,n.window[n.strstart+V-1]),e=n.prev[n.strstart&n.w_mask]=n.head[n.ins_h],n.head[n.ins_h]=n.strstart);while(--n.prev_length!==0);if(n.match_available=0,n.match_length=V-1,n.strstart++,r&&(ut(n,!1),n.strm.avail_out===0))return it}else if(n.match_available){if(r=ae(n,0,n.window[n.strstart-1]),r&&ut(n,!1),n.strstart++,n.lookahead--,n.strm.avail_out===0)return it}else n.match_available=1,n.strstart++,n.lookahead--}return n.match_available&&(r=ae(n,0,n.window[n.strstart-1]),n.match_available=0),n.insert=n.strstart<V-1?n.strstart:V-1,t===oe?(ut(n,!0),n.strm.avail_out===0?Ce:$e):n.last_lit&&(ut(n,!1),n.strm.avail_out===0)?it:pn},fo=(n,t)=>{let e,r,i,s;const o=n.window;for(;;){if(n.lookahead<=le){if(Te(n),n.lookahead<=le&&t===Ne)return it;if(n.lookahead===0)break}if(n.match_length=0,n.lookahead>=V&&n.strstart>0&&(i=n.strstart-1,r=o[i],r===o[++i]&&r===o[++i]&&r===o[++i])){s=n.strstart+le;do;while(r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&r===o[++i]&&i<s);n.match_length=le-(s-i),n.match_length>n.lookahead&&(n.match_length=n.lookahead)}if(n.match_length>=V?(e=ae(n,1,n.match_length-V),n.lookahead-=n.match_length,n.strstart+=n.match_length,n.match_length=0):(e=ae(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++),e&&(ut(n,!1),n.strm.avail_out===0))return it}return n.insert=0,t===oe?(ut(n,!0),n.strm.avail_out===0?Ce:$e):n.last_lit&&(ut(n,!1),n.strm.avail_out===0)?it:pn},go=(n,t)=>{let e;for(;;){if(n.lookahead===0&&(Te(n),n.lookahead===0)){if(t===Ne)return it;break}if(n.match_length=0,e=ae(n,0,n.window[n.strstart]),n.lookahead--,n.strstart++,e&&(ut(n,!1),n.strm.avail_out===0))return it}return n.insert=0,t===oe?(ut(n,!0),n.strm.avail_out===0?Ce:$e):n.last_lit&&(ut(n,!1),n.strm.avail_out===0)?it:pn};function Ft(n,t,e,r,i){this.good_length=n,this.max_lazy=t,this.nice_length=e,this.max_chain=r,this.func=i}const vn=[new Ft(0,0,0,0,ho),new Ft(4,4,8,4,Tr),new Ft(4,5,16,8,Tr),new Ft(4,6,32,32,Tr),new Ft(4,4,16,16,Ye),new Ft(8,16,32,32,Ye),new Ft(8,16,128,128,Ye),new Ft(8,32,128,256,Ye),new Ft(32,128,258,1024,Ye),new Ft(32,258,258,4096,Ye)],mo=n=>{n.window_size=2*n.w_size,ue(n.head),n.max_lazy_match=vn[n.level].max_lazy,n.good_match=vn[n.level].good_length,n.nice_match=vn[n.level].nice_length,n.max_chain_length=vn[n.level].max_chain,n.strstart=0,n.block_start=0,n.lookahead=0,n.insert=0,n.match_length=n.prev_length=V-1,n.match_available=0,n.ins_h=0};function po(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=Hn,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new Uint16Array(ao*2),this.dyn_dtree=new Uint16Array((2*io+1)*2),this.bl_tree=new Uint16Array((2*so+1)*2),ue(this.dyn_ltree),ue(this.dyn_dtree),ue(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new Uint16Array(oo+1),this.heap=new Uint16Array(2*Br+1),ue(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new Uint16Array(2*Br+1),ue(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}const Ji=n=>{if(!n||!n.state)return ce(n,xt);n.total_in=n.total_out=0,n.data_type=Qa;const t=n.state;return t.pending=0,t.pending_out=0,t.wrap<0&&(t.wrap=-t.wrap),t.status=t.wrap?Gn:Be,n.adler=t.wrap===2?0:1,t.last_flush=Ne,Ua(t),Dt},Di=n=>{const t=Ji(n);return t===Dt&&mo(n.state),t},wo=(n,t)=>!n||!n.state||n.state.wrap!==2?xt:(n.state.gzhead=t,Dt),Fi=(n,t,e,r,i,s)=>{if(!n)return xt;let o=1;if(t===qa&&(t=6),r<0?(o=0,r=-r):r>15&&(o=2,r-=16),i<1||i>to||e!==Hn||r<8||r>15||t<0||t>9||s<0||s>ja)return ce(n,xt);r===8&&(r=9);const a=new po;return n.state=a,a.strm=n,a.wrap=o,a.gzhead=null,a.w_bits=r,a.w_size=1<<a.w_bits,a.w_mask=a.w_size-1,a.hash_bits=i+7,a.hash_size=1<<a.hash_bits,a.hash_mask=a.hash_size-1,a.hash_shift=~~((a.hash_bits+V-1)/V),a.window=new Uint8Array(a.w_size*2),a.head=new Uint16Array(a.hash_size),a.prev=new Uint16Array(a.w_size),a.lit_bufsize=1<<i+6,a.pending_buf_size=a.lit_bufsize*4,a.pending_buf=new Uint8Array(a.pending_buf_size),a.d_buf=1*a.lit_bufsize,a.l_buf=(1+2)*a.lit_bufsize,a.level=t,a.strategy=s,a.method=e,Di(n)},vo=(n,t)=>Fi(n,t,Hn,eo,no,Ka),_o=(n,t)=>{let e,r;if(!n||!n.state||t>Li||t<0)return n?ce(n,xt):xt;const i=n.state;if(!n.output||!n.input&&n.avail_in!==0||i.status===mn&&t!==oe)return ce(n,n.avail_out===0?Nr:xt);i.strm=n;const s=i.last_flush;if(i.last_flush=t,i.status===Gn)if(i.wrap===2)n.adler=0,$(i,31),$(i,139),$(i,8),i.gzhead?($(i,(i.gzhead.text?1:0)+(i.gzhead.hcrc?2:0)+(i.gzhead.extra?4:0)+(i.gzhead.name?8:0)+(i.gzhead.comment?16:0)),$(i,i.gzhead.time&255),$(i,i.gzhead.time>>8&255),$(i,i.gzhead.time>>16&255),$(i,i.gzhead.time>>24&255),$(i,i.level===9?2:i.strategy>=Zn||i.level<2?4:0),$(i,i.gzhead.os&255),i.gzhead.extra&&i.gzhead.extra.length&&($(i,i.gzhead.extra.length&255),$(i,i.gzhead.extra.length>>8&255)),i.gzhead.hcrc&&(n.adler=ct(n.adler,i.pending_buf,i.pending,0)),i.gzindex=0,i.status=Cr):($(i,0),$(i,0),$(i,0),$(i,0),$(i,0),$(i,i.level===9?2:i.strategy>=Zn||i.level<2?4:0),$(i,co),i.status=Be);else{let o=Hn+(i.w_bits-8<<4)<<8,a=-1;i.strategy>=Zn||i.level<2?a=0:i.level<6?a=1:i.level===6?a=2:a=3,o|=a<<6,i.strstart!==0&&(o|=lo),o+=31-o%31,i.status=Be,wn(i,o),i.strstart!==0&&(wn(i,n.adler>>>16),wn(i,n.adler&65535)),n.adler=1}if(i.status===Cr)if(i.gzhead.extra){for(e=i.pending;i.gzindex<(i.gzhead.extra.length&65535)&&!(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=ct(n.adler,i.pending_buf,i.pending-e,e)),fe(n),e=i.pending,i.pending===i.pending_buf_size));)$(i,i.gzhead.extra[i.gzindex]&255),i.gzindex++;i.gzhead.hcrc&&i.pending>e&&(n.adler=ct(n.adler,i.pending_buf,i.pending-e,e)),i.gzindex===i.gzhead.extra.length&&(i.gzindex=0,i.status=Vn)}else i.status=Vn;if(i.status===Vn)if(i.gzhead.name){e=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=ct(n.adler,i.pending_buf,i.pending-e,e)),fe(n),e=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.name.length?r=i.gzhead.name.charCodeAt(i.gzindex++)&255:r=0,$(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>e&&(n.adler=ct(n.adler,i.pending_buf,i.pending-e,e)),r===0&&(i.gzindex=0,i.status=$n)}else i.status=$n;if(i.status===$n)if(i.gzhead.comment){e=i.pending;do{if(i.pending===i.pending_buf_size&&(i.gzhead.hcrc&&i.pending>e&&(n.adler=ct(n.adler,i.pending_buf,i.pending-e,e)),fe(n),e=i.pending,i.pending===i.pending_buf_size)){r=1;break}i.gzindex<i.gzhead.comment.length?r=i.gzhead.comment.charCodeAt(i.gzindex++)&255:r=0,$(i,r)}while(r!==0);i.gzhead.hcrc&&i.pending>e&&(n.adler=ct(n.adler,i.pending_buf,i.pending-e,e)),r===0&&(i.status=Yn)}else i.status=Yn;if(i.status===Yn&&(i.gzhead.hcrc?(i.pending+2>i.pending_buf_size&&fe(n),i.pending+2<=i.pending_buf_size&&($(i,n.adler&255),$(i,n.adler>>8&255),n.adler=0,i.status=Be)):i.status=Be),i.pending!==0){if(fe(n),n.avail_out===0)return i.last_flush=-1,Dt}else if(n.avail_in===0&&Oi(t)<=Oi(s)&&t!==oe)return ce(n,Nr);if(i.status===mn&&n.avail_in!==0)return ce(n,Nr);if(n.avail_in!==0||i.lookahead!==0||t!==Ne&&i.status!==mn){let o=i.strategy===Zn?go(i,t):i.strategy===Xa?fo(i,t):vn[i.level].func(i,t);if((o===Ce||o===$e)&&(i.status=mn),o===it||o===Ce)return n.avail_out===0&&(i.last_flush=-1),Dt;if(o===pn&&(t===Va?Ga(i):t!==Li&&(Za(i,0,0,!1),t===$a&&(ue(i.head),i.lookahead===0&&(i.strstart=0,i.block_start=0,i.insert=0))),fe(n),n.avail_out===0))return i.last_flush=-1,Dt}return t!==oe?Dt:i.wrap<=0?Pi:(i.wrap===2?($(i,n.adler&255),$(i,n.adler>>8&255),$(i,n.adler>>16&255),$(i,n.adler>>24&255),$(i,n.total_in&255),$(i,n.total_in>>8&255),$(i,n.total_in>>16&255),$(i,n.total_in>>24&255)):(wn(i,n.adler>>>16),wn(i,n.adler&65535)),fe(n),i.wrap>0&&(i.wrap=-i.wrap),i.pending!==0?Dt:Pi)},bo=n=>{if(!n||!n.state)return xt;const t=n.state.status;return t!==Gn&&t!==Cr&&t!==Vn&&t!==$n&&t!==Yn&&t!==Be&&t!==mn?ce(n,xt):(n.state=null,t===Be?ce(n,Ya):Dt)},yo=(n,t)=>{let e=t.length;if(!n||!n.state)return xt;const r=n.state,i=r.wrap;if(i===2||i===1&&r.status!==Gn||r.lookahead)return xt;if(i===1&&(n.adler=gn(n.adler,t,e,0)),r.wrap=0,e>=r.w_size){i===0&&(ue(r.head),r.strstart=0,r.block_start=0,r.insert=0);let h=new Uint8Array(r.w_size);h.set(t.subarray(e-r.w_size,e),0),t=h,e=r.w_size}const s=n.avail_in,o=n.next_in,a=n.input;for(n.avail_in=e,n.next_in=0,n.input=t,Te(r);r.lookahead>=V;){let h=r.strstart,l=r.lookahead-(V-1);do r.ins_h=he(r,r.ins_h,r.window[h+V-1]),r.prev[h&r.w_mask]=r.head[r.ins_h],r.head[r.ins_h]=h,h++;while(--l);r.strstart=h,r.lookahead=V-1,Te(r)}return r.strstart+=r.lookahead,r.block_start=r.strstart,r.insert=r.lookahead,r.lookahead=0,r.match_length=r.prev_length=V-1,r.match_available=0,n.next_in=o,n.input=a,n.avail_in=s,r.wrap=i,Dt};var So=vo,Eo=Fi,Io=Di,xo=Ji,ko=wo,Ao=_o,Mo=bo,Ro=yo,No="pako deflate (from Nodeca project)",_n={deflateInit:So,deflateInit2:Eo,deflateReset:Io,deflateResetKeep:xo,deflateSetHeader:ko,deflate:Ao,deflateEnd:Mo,deflateSetDictionary:Ro,deflateInfo:No};const Bo=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);var Co=function(n){const t=Array.prototype.slice.call(arguments,1);for(;t.length;){const e=t.shift();if(!!e){if(typeof e!="object")throw new TypeError(e+"must be non-object");for(const r in e)Bo(e,r)&&(n[r]=e[r])}}return n},To=n=>{let t=0;for(let r=0,i=n.length;r<i;r++)t+=n[r].length;const e=new Uint8Array(t);for(let r=0,i=0,s=n.length;r<s;r++){let o=n[r];e.set(o,i),i+=o.length}return e},qn={assign:Co,flattenChunks:To};let Ui=!0;try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{Ui=!1}const bn=new Uint8Array(256);for(let n=0;n<256;n++)bn[n]=n>=252?6:n>=248?5:n>=240?4:n>=224?3:n>=192?2:1;bn[254]=bn[254]=1;var Lo=n=>{if(typeof TextEncoder=="function"&&TextEncoder.prototype.encode)return new TextEncoder().encode(n);let t,e,r,i,s,o=n.length,a=0;for(i=0;i<o;i++)e=n.charCodeAt(i),(e&64512)===55296&&i+1<o&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),a+=e<128?1:e<2048?2:e<65536?3:4;for(t=new Uint8Array(a),s=0,i=0;s<a;i++)e=n.charCodeAt(i),(e&64512)===55296&&i+1<o&&(r=n.charCodeAt(i+1),(r&64512)===56320&&(e=65536+(e-55296<<10)+(r-56320),i++)),e<128?t[s++]=e:e<2048?(t[s++]=192|e>>>6,t[s++]=128|e&63):e<65536?(t[s++]=224|e>>>12,t[s++]=128|e>>>6&63,t[s++]=128|e&63):(t[s++]=240|e>>>18,t[s++]=128|e>>>12&63,t[s++]=128|e>>>6&63,t[s++]=128|e&63);return t};const Po=(n,t)=>{if(t<65534&&n.subarray&&Ui)return String.fromCharCode.apply(null,n.length===t?n:n.subarray(0,t));let e="";for(let r=0;r<t;r++)e+=String.fromCharCode(n[r]);return e};var Oo=(n,t)=>{const e=t||n.length;if(typeof TextDecoder=="function"&&TextDecoder.prototype.decode)return new TextDecoder().decode(n.subarray(0,t));let r,i;const s=new Array(e*2);for(i=0,r=0;r<e;){let o=n[r++];if(o<128){s[i++]=o;continue}let a=bn[o];if(a>4){s[i++]=65533,r+=a-1;continue}for(o&=a===2?31:a===3?15:7;a>1&&r<e;)o=o<<6|n[r++]&63,a--;if(a>1){s[i++]=65533;continue}o<65536?s[i++]=o:(o-=65536,s[i++]=55296|o>>10&1023,s[i++]=56320|o&1023)}return Po(s,i)},zo=(n,t)=>{t=t||n.length,t>n.length&&(t=n.length);let e=t-1;for(;e>=0&&(n[e]&192)===128;)e--;return e<0||e===0?t:e+bn[n[e]]>t?e:t},yn={string2buf:Lo,buf2string:Oo,utf8border:zo};function Jo(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}var Zi=Jo;const Hi=Object.prototype.toString,{Z_NO_FLUSH:Do,Z_SYNC_FLUSH:Fo,Z_FULL_FLUSH:Uo,Z_FINISH:Zo,Z_OK:Wn,Z_STREAM_END:Ho,Z_DEFAULT_COMPRESSION:Go,Z_DEFAULT_STRATEGY:Vo,Z_DEFLATED:$o}=Re;function Sn(n){this.options=qn.assign({level:Go,method:$o,chunkSize:16384,windowBits:15,memLevel:8,strategy:Vo},n||{});let t=this.options;t.raw&&t.windowBits>0?t.windowBits=-t.windowBits:t.gzip&&t.windowBits>0&&t.windowBits<16&&(t.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zi,this.strm.avail_out=0;let e=_n.deflateInit2(this.strm,t.level,t.method,t.windowBits,t.memLevel,t.strategy);if(e!==Wn)throw new Error(Me[e]);if(t.header&&_n.deflateSetHeader(this.strm,t.header),t.dictionary){let r;if(typeof t.dictionary=="string"?r=yn.string2buf(t.dictionary):Hi.call(t.dictionary)==="[object ArrayBuffer]"?r=new Uint8Array(t.dictionary):r=t.dictionary,e=_n.deflateSetDictionary(this.strm,r),e!==Wn)throw new Error(Me[e]);this._dict_set=!0}}Sn.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize;let i,s;if(this.ended)return!1;for(t===~~t?s=t:s=t===!0?Zo:Do,typeof n=="string"?e.input=yn.string2buf(n):Hi.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){if(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),(s===Fo||s===Uo)&&e.avail_out<=6){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(i=_n.deflate(e,s),i===Ho)return e.next_out>0&&this.onData(e.output.subarray(0,e.next_out)),i=_n.deflateEnd(this.strm),this.onEnd(i),this.ended=!0,i===Wn;if(e.avail_out===0){this.onData(e.output);continue}if(s>0&&e.next_out>0){this.onData(e.output.subarray(0,e.next_out)),e.avail_out=0;continue}if(e.avail_in===0)break}return!0},Sn.prototype.onData=function(n){this.chunks.push(n)},Sn.prototype.onEnd=function(n){n===Wn&&(this.result=qn.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Lr(n,t){const e=new Sn(t);if(e.push(n,!0),e.err)throw e.msg||Me[e.err];return e.result}function Yo(n,t){return t=t||{},t.raw=!0,Lr(n,t)}function qo(n,t){return t=t||{},t.gzip=!0,Lr(n,t)}var Wo=Sn,Xo=Lr,jo=Yo,Ko=qo,Qo=Re,tl={Deflate:Wo,deflate:Xo,deflateRaw:jo,gzip:Ko,constants:Qo};const Xn=30,el=12;var nl=function(t,e){let r,i,s,o,a,h,l,c,d,g,f,p,E,m,v,b,w,S,k,R,x,A,B,M;const C=t.state;r=t.next_in,B=t.input,i=r+(t.avail_in-5),s=t.next_out,M=t.output,o=s-(e-t.avail_out),a=s+(t.avail_out-257),h=C.dmax,l=C.wsize,c=C.whave,d=C.wnext,g=C.window,f=C.hold,p=C.bits,E=C.lencode,m=C.distcode,v=(1<<C.lenbits)-1,b=(1<<C.distbits)-1;t:do{p<15&&(f+=B[r++]<<p,p+=8,f+=B[r++]<<p,p+=8),w=E[f&v];e:for(;;){if(S=w>>>24,f>>>=S,p-=S,S=w>>>16&255,S===0)M[s++]=w&65535;else if(S&16){k=w&65535,S&=15,S&&(p<S&&(f+=B[r++]<<p,p+=8),k+=f&(1<<S)-1,f>>>=S,p-=S),p<15&&(f+=B[r++]<<p,p+=8,f+=B[r++]<<p,p+=8),w=m[f&b];n:for(;;){if(S=w>>>24,f>>>=S,p-=S,S=w>>>16&255,S&16){if(R=w&65535,S&=15,p<S&&(f+=B[r++]<<p,p+=8,p<S&&(f+=B[r++]<<p,p+=8)),R+=f&(1<<S)-1,R>h){t.msg="invalid distance too far back",C.mode=Xn;break t}if(f>>>=S,p-=S,S=s-o,R>S){if(S=R-S,S>c&&C.sane){t.msg="invalid distance too far back",C.mode=Xn;break t}if(x=0,A=g,d===0){if(x+=l-S,S<k){k-=S;do M[s++]=g[x++];while(--S);x=s-R,A=M}}else if(d<S){if(x+=l+d-S,S-=d,S<k){k-=S;do M[s++]=g[x++];while(--S);if(x=0,d<k){S=d,k-=S;do M[s++]=g[x++];while(--S);x=s-R,A=M}}}else if(x+=d-S,S<k){k-=S;do M[s++]=g[x++];while(--S);x=s-R,A=M}for(;k>2;)M[s++]=A[x++],M[s++]=A[x++],M[s++]=A[x++],k-=3;k&&(M[s++]=A[x++],k>1&&(M[s++]=A[x++]))}else{x=s-R;do M[s++]=M[x++],M[s++]=M[x++],M[s++]=M[x++],k-=3;while(k>2);k&&(M[s++]=M[x++],k>1&&(M[s++]=M[x++]))}}else if((S&64)===0){w=m[(w&65535)+(f&(1<<S)-1)];continue n}else{t.msg="invalid distance code",C.mode=Xn;break t}break}}else if((S&64)===0){w=E[(w&65535)+(f&(1<<S)-1)];continue e}else if(S&32){C.mode=el;break t}else{t.msg="invalid literal/length code",C.mode=Xn;break t}break}}while(r<i&&s<a);k=p>>3,r-=k,p-=k<<3,f&=(1<<p)-1,t.next_in=r,t.next_out=s,t.avail_in=r<i?5+(i-r):5-(r-i),t.avail_out=s<a?257+(a-s):257-(s-a),C.hold=f,C.bits=p};const qe=15,Gi=852,Vi=592,$i=0,Pr=1,Yi=2,rl=new Uint16Array([3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0]),il=new Uint8Array([16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78]),sl=new Uint16Array([1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0]),al=new Uint8Array([16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64]);var En=(n,t,e,r,i,s,o,a)=>{const h=a.bits;let l=0,c=0,d=0,g=0,f=0,p=0,E=0,m=0,v=0,b=0,w,S,k,R,x,A=null,B=0,M;const C=new Uint16Array(qe+1),O=new Uint16Array(qe+1);let F=null,D=0,X,Q,rt;for(l=0;l<=qe;l++)C[l]=0;for(c=0;c<r;c++)C[t[e+c]]++;for(f=h,g=qe;g>=1&&C[g]===0;g--);if(f>g&&(f=g),g===0)return i[s++]=1<<24|64<<16|0,i[s++]=1<<24|64<<16|0,a.bits=1,0;for(d=1;d<g&&C[d]===0;d++);for(f<d&&(f=d),m=1,l=1;l<=qe;l++)if(m<<=1,m-=C[l],m<0)return-1;if(m>0&&(n===$i||g!==1))return-1;for(O[1]=0,l=1;l<qe;l++)O[l+1]=O[l]+C[l];for(c=0;c<r;c++)t[e+c]!==0&&(o[O[t[e+c]]++]=c);if(n===$i?(A=F=o,M=19):n===Pr?(A=rl,B-=257,F=il,D-=257,M=256):(A=sl,F=al,M=-1),b=0,c=0,l=d,x=s,p=f,E=0,k=-1,v=1<<f,R=v-1,n===Pr&&v>Gi||n===Yi&&v>Vi)return 1;for(;;){X=l-E,o[c]<M?(Q=0,rt=o[c]):o[c]>M?(Q=F[D+o[c]],rt=A[B+o[c]]):(Q=32+64,rt=0),w=1<<l-E,S=1<<p,d=S;do S-=w,i[x+(b>>E)+S]=X<<24|Q<<16|rt|0;while(S!==0);for(w=1<<l-1;b&w;)w>>=1;if(w!==0?(b&=w-1,b+=w):b=0,c++,--C[l]===0){if(l===g)break;l=t[e+o[c]]}if(l>f&&(b&R)!==k){for(E===0&&(E=f),x+=d,p=l-E,m=1<<p;p+E<g&&(m-=C[p+E],!(m<=0));)p++,m<<=1;if(v+=1<<p,n===Pr&&v>Gi||n===Yi&&v>Vi)return 1;k=b&R,i[k]=f<<24|p<<16|x-s|0}}return b!==0&&(i[x+b]=l-E<<24|64<<16|0),a.bits=f,0};const ol=0,qi=1,Wi=2,{Z_FINISH:Xi,Z_BLOCK:ll,Z_TREES:jn,Z_OK:Le,Z_STREAM_END:cl,Z_NEED_DICT:ul,Z_STREAM_ERROR:kt,Z_DATA_ERROR:ji,Z_MEM_ERROR:Ki,Z_BUF_ERROR:hl,Z_DEFLATED:Qi}=Re,ts=1,es=2,ns=3,rs=4,is=5,ss=6,as=7,os=8,ls=9,cs=10,Kn=11,Yt=12,Or=13,us=14,zr=15,hs=16,fs=17,ds=18,gs=19,Qn=20,tr=21,ms=22,ps=23,ws=24,vs=25,_s=26,Jr=27,bs=28,ys=29,tt=30,Ss=31,fl=32,dl=852,gl=592,ml=15,Es=n=>(n>>>24&255)+(n>>>8&65280)+((n&65280)<<8)+((n&255)<<24);function pl(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new Uint16Array(320),this.work=new Uint16Array(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}const Is=n=>{if(!n||!n.state)return kt;const t=n.state;return n.total_in=n.total_out=t.total=0,n.msg="",t.wrap&&(n.adler=t.wrap&1),t.mode=ts,t.last=0,t.havedict=0,t.dmax=32768,t.head=null,t.hold=0,t.bits=0,t.lencode=t.lendyn=new Int32Array(dl),t.distcode=t.distdyn=new Int32Array(gl),t.sane=1,t.back=-1,Le},xs=n=>{if(!n||!n.state)return kt;const t=n.state;return t.wsize=0,t.whave=0,t.wnext=0,Is(n)},ks=(n,t)=>{let e;if(!n||!n.state)return kt;const r=n.state;return t<0?(e=0,t=-t):(e=(t>>4)+1,t<48&&(t&=15)),t&&(t<8||t>15)?kt:(r.window!==null&&r.wbits!==t&&(r.window=null),r.wrap=e,r.wbits=t,xs(n))},As=(n,t)=>{if(!n)return kt;const e=new pl;n.state=e,e.window=null;const r=ks(n,t);return r!==Le&&(n.state=null),r},wl=n=>As(n,ml);let Ms=!0,Dr,Fr;const vl=n=>{if(Ms){Dr=new Int32Array(512),Fr=new Int32Array(32);let t=0;for(;t<144;)n.lens[t++]=8;for(;t<256;)n.lens[t++]=9;for(;t<280;)n.lens[t++]=7;for(;t<288;)n.lens[t++]=8;for(En(qi,n.lens,0,288,Dr,0,n.work,{bits:9}),t=0;t<32;)n.lens[t++]=5;En(Wi,n.lens,0,32,Fr,0,n.work,{bits:5}),Ms=!1}n.lencode=Dr,n.lenbits=9,n.distcode=Fr,n.distbits=5},Rs=(n,t,e,r)=>{let i;const s=n.state;return s.window===null&&(s.wsize=1<<s.wbits,s.wnext=0,s.whave=0,s.window=new Uint8Array(s.wsize)),r>=s.wsize?(s.window.set(t.subarray(e-s.wsize,e),0),s.wnext=0,s.whave=s.wsize):(i=s.wsize-s.wnext,i>r&&(i=r),s.window.set(t.subarray(e-r,e-r+i),s.wnext),r-=i,r?(s.window.set(t.subarray(e-r,e),0),s.wnext=r,s.whave=s.wsize):(s.wnext+=i,s.wnext===s.wsize&&(s.wnext=0),s.whave<s.wsize&&(s.whave+=i))),0},_l=(n,t)=>{let e,r,i,s,o,a,h,l,c,d,g,f,p,E,m=0,v,b,w,S,k,R,x,A;const B=new Uint8Array(4);let M,C;const O=new Uint8Array([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]);if(!n||!n.state||!n.output||!n.input&&n.avail_in!==0)return kt;e=n.state,e.mode===Yt&&(e.mode=Or),o=n.next_out,i=n.output,h=n.avail_out,s=n.next_in,r=n.input,a=n.avail_in,l=e.hold,c=e.bits,d=a,g=h,A=Le;t:for(;;)switch(e.mode){case ts:if(e.wrap===0){e.mode=Or;break}for(;c<16;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(e.wrap&2&&l===35615){e.check=0,B[0]=l&255,B[1]=l>>>8&255,e.check=ct(e.check,B,2,0),l=0,c=0,e.mode=es;break}if(e.flags=0,e.head&&(e.head.done=!1),!(e.wrap&1)||(((l&255)<<8)+(l>>8))%31){n.msg="incorrect header check",e.mode=tt;break}if((l&15)!==Qi){n.msg="unknown compression method",e.mode=tt;break}if(l>>>=4,c-=4,x=(l&15)+8,e.wbits===0)e.wbits=x;else if(x>e.wbits){n.msg="invalid window size",e.mode=tt;break}e.dmax=1<<e.wbits,n.adler=e.check=1,e.mode=l&512?cs:Yt,l=0,c=0;break;case es:for(;c<16;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(e.flags=l,(e.flags&255)!==Qi){n.msg="unknown compression method",e.mode=tt;break}if(e.flags&57344){n.msg="unknown header flags set",e.mode=tt;break}e.head&&(e.head.text=l>>8&1),e.flags&512&&(B[0]=l&255,B[1]=l>>>8&255,e.check=ct(e.check,B,2,0)),l=0,c=0,e.mode=ns;case ns:for(;c<32;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}e.head&&(e.head.time=l),e.flags&512&&(B[0]=l&255,B[1]=l>>>8&255,B[2]=l>>>16&255,B[3]=l>>>24&255,e.check=ct(e.check,B,4,0)),l=0,c=0,e.mode=rs;case rs:for(;c<16;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}e.head&&(e.head.xflags=l&255,e.head.os=l>>8),e.flags&512&&(B[0]=l&255,B[1]=l>>>8&255,e.check=ct(e.check,B,2,0)),l=0,c=0,e.mode=is;case is:if(e.flags&1024){for(;c<16;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}e.length=l,e.head&&(e.head.extra_len=l),e.flags&512&&(B[0]=l&255,B[1]=l>>>8&255,e.check=ct(e.check,B,2,0)),l=0,c=0}else e.head&&(e.head.extra=null);e.mode=ss;case ss:if(e.flags&1024&&(f=e.length,f>a&&(f=a),f&&(e.head&&(x=e.head.extra_len-e.length,e.head.extra||(e.head.extra=new Uint8Array(e.head.extra_len)),e.head.extra.set(r.subarray(s,s+f),x)),e.flags&512&&(e.check=ct(e.check,r,f,s)),a-=f,s+=f,e.length-=f),e.length))break t;e.length=0,e.mode=as;case as:if(e.flags&2048){if(a===0)break t;f=0;do x=r[s+f++],e.head&&x&&e.length<65536&&(e.head.name+=String.fromCharCode(x));while(x&&f<a);if(e.flags&512&&(e.check=ct(e.check,r,f,s)),a-=f,s+=f,x)break t}else e.head&&(e.head.name=null);e.length=0,e.mode=os;case os:if(e.flags&4096){if(a===0)break t;f=0;do x=r[s+f++],e.head&&x&&e.length<65536&&(e.head.comment+=String.fromCharCode(x));while(x&&f<a);if(e.flags&512&&(e.check=ct(e.check,r,f,s)),a-=f,s+=f,x)break t}else e.head&&(e.head.comment=null);e.mode=ls;case ls:if(e.flags&512){for(;c<16;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(l!==(e.check&65535)){n.msg="header crc mismatch",e.mode=tt;break}l=0,c=0}e.head&&(e.head.hcrc=e.flags>>9&1,e.head.done=!0),n.adler=e.check=0,e.mode=Yt;break;case cs:for(;c<32;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}n.adler=e.check=Es(l),l=0,c=0,e.mode=Kn;case Kn:if(e.havedict===0)return n.next_out=o,n.avail_out=h,n.next_in=s,n.avail_in=a,e.hold=l,e.bits=c,ul;n.adler=e.check=1,e.mode=Yt;case Yt:if(t===ll||t===jn)break t;case Or:if(e.last){l>>>=c&7,c-=c&7,e.mode=Jr;break}for(;c<3;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}switch(e.last=l&1,l>>>=1,c-=1,l&3){case 0:e.mode=us;break;case 1:if(vl(e),e.mode=Qn,t===jn){l>>>=2,c-=2;break t}break;case 2:e.mode=fs;break;case 3:n.msg="invalid block type",e.mode=tt}l>>>=2,c-=2;break;case us:for(l>>>=c&7,c-=c&7;c<32;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if((l&65535)!==(l>>>16^65535)){n.msg="invalid stored block lengths",e.mode=tt;break}if(e.length=l&65535,l=0,c=0,e.mode=zr,t===jn)break t;case zr:e.mode=hs;case hs:if(f=e.length,f){if(f>a&&(f=a),f>h&&(f=h),f===0)break t;i.set(r.subarray(s,s+f),o),a-=f,s+=f,h-=f,o+=f,e.length-=f;break}e.mode=Yt;break;case fs:for(;c<14;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(e.nlen=(l&31)+257,l>>>=5,c-=5,e.ndist=(l&31)+1,l>>>=5,c-=5,e.ncode=(l&15)+4,l>>>=4,c-=4,e.nlen>286||e.ndist>30){n.msg="too many length or distance symbols",e.mode=tt;break}e.have=0,e.mode=ds;case ds:for(;e.have<e.ncode;){for(;c<3;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}e.lens[O[e.have++]]=l&7,l>>>=3,c-=3}for(;e.have<19;)e.lens[O[e.have++]]=0;if(e.lencode=e.lendyn,e.lenbits=7,M={bits:e.lenbits},A=En(ol,e.lens,0,19,e.lencode,0,e.work,M),e.lenbits=M.bits,A){n.msg="invalid code lengths set",e.mode=tt;break}e.have=0,e.mode=gs;case gs:for(;e.have<e.nlen+e.ndist;){for(;m=e.lencode[l&(1<<e.lenbits)-1],v=m>>>24,b=m>>>16&255,w=m&65535,!(v<=c);){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(w<16)l>>>=v,c-=v,e.lens[e.have++]=w;else{if(w===16){for(C=v+2;c<C;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(l>>>=v,c-=v,e.have===0){n.msg="invalid bit length repeat",e.mode=tt;break}x=e.lens[e.have-1],f=3+(l&3),l>>>=2,c-=2}else if(w===17){for(C=v+3;c<C;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}l>>>=v,c-=v,x=0,f=3+(l&7),l>>>=3,c-=3}else{for(C=v+7;c<C;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}l>>>=v,c-=v,x=0,f=11+(l&127),l>>>=7,c-=7}if(e.have+f>e.nlen+e.ndist){n.msg="invalid bit length repeat",e.mode=tt;break}for(;f--;)e.lens[e.have++]=x}}if(e.mode===tt)break;if(e.lens[256]===0){n.msg="invalid code -- missing end-of-block",e.mode=tt;break}if(e.lenbits=9,M={bits:e.lenbits},A=En(qi,e.lens,0,e.nlen,e.lencode,0,e.work,M),e.lenbits=M.bits,A){n.msg="invalid literal/lengths set",e.mode=tt;break}if(e.distbits=6,e.distcode=e.distdyn,M={bits:e.distbits},A=En(Wi,e.lens,e.nlen,e.ndist,e.distcode,0,e.work,M),e.distbits=M.bits,A){n.msg="invalid distances set",e.mode=tt;break}if(e.mode=Qn,t===jn)break t;case Qn:e.mode=tr;case tr:if(a>=6&&h>=258){n.next_out=o,n.avail_out=h,n.next_in=s,n.avail_in=a,e.hold=l,e.bits=c,nl(n,g),o=n.next_out,i=n.output,h=n.avail_out,s=n.next_in,r=n.input,a=n.avail_in,l=e.hold,c=e.bits,e.mode===Yt&&(e.back=-1);break}for(e.back=0;m=e.lencode[l&(1<<e.lenbits)-1],v=m>>>24,b=m>>>16&255,w=m&65535,!(v<=c);){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(b&&(b&240)===0){for(S=v,k=b,R=w;m=e.lencode[R+((l&(1<<S+k)-1)>>S)],v=m>>>24,b=m>>>16&255,w=m&65535,!(S+v<=c);){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}l>>>=S,c-=S,e.back+=S}if(l>>>=v,c-=v,e.back+=v,e.length=w,b===0){e.mode=_s;break}if(b&32){e.back=-1,e.mode=Yt;break}if(b&64){n.msg="invalid literal/length code",e.mode=tt;break}e.extra=b&15,e.mode=ms;case ms:if(e.extra){for(C=e.extra;c<C;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}e.length+=l&(1<<e.extra)-1,l>>>=e.extra,c-=e.extra,e.back+=e.extra}e.was=e.length,e.mode=ps;case ps:for(;m=e.distcode[l&(1<<e.distbits)-1],v=m>>>24,b=m>>>16&255,w=m&65535,!(v<=c);){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if((b&240)===0){for(S=v,k=b,R=w;m=e.distcode[R+((l&(1<<S+k)-1)>>S)],v=m>>>24,b=m>>>16&255,w=m&65535,!(S+v<=c);){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}l>>>=S,c-=S,e.back+=S}if(l>>>=v,c-=v,e.back+=v,b&64){n.msg="invalid distance code",e.mode=tt;break}e.offset=w,e.extra=b&15,e.mode=ws;case ws:if(e.extra){for(C=e.extra;c<C;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}e.offset+=l&(1<<e.extra)-1,l>>>=e.extra,c-=e.extra,e.back+=e.extra}if(e.offset>e.dmax){n.msg="invalid distance too far back",e.mode=tt;break}e.mode=vs;case vs:if(h===0)break t;if(f=g-h,e.offset>f){if(f=e.offset-f,f>e.whave&&e.sane){n.msg="invalid distance too far back",e.mode=tt;break}f>e.wnext?(f-=e.wnext,p=e.wsize-f):p=e.wnext-f,f>e.length&&(f=e.length),E=e.window}else E=i,p=o-e.offset,f=e.length;f>h&&(f=h),h-=f,e.length-=f;do i[o++]=E[p++];while(--f);e.length===0&&(e.mode=tr);break;case _s:if(h===0)break t;i[o++]=e.length,h--,e.mode=tr;break;case Jr:if(e.wrap){for(;c<32;){if(a===0)break t;a--,l|=r[s++]<<c,c+=8}if(g-=h,n.total_out+=g,e.total+=g,g&&(n.adler=e.check=e.flags?ct(e.check,i,g,o-g):gn(e.check,i,g,o-g)),g=h,(e.flags?l:Es(l))!==e.check){n.msg="incorrect data check",e.mode=tt;break}l=0,c=0}e.mode=bs;case bs:if(e.wrap&&e.flags){for(;c<32;){if(a===0)break t;a--,l+=r[s++]<<c,c+=8}if(l!==(e.total&4294967295)){n.msg="incorrect length check",e.mode=tt;break}l=0,c=0}e.mode=ys;case ys:A=cl;break t;case tt:A=ji;break t;case Ss:return Ki;case fl:default:return kt}return n.next_out=o,n.avail_out=h,n.next_in=s,n.avail_in=a,e.hold=l,e.bits=c,(e.wsize||g!==n.avail_out&&e.mode<tt&&(e.mode<Jr||t!==Xi))&&Rs(n,n.output,n.next_out,g-n.avail_out),d-=n.avail_in,g-=n.avail_out,n.total_in+=d,n.total_out+=g,e.total+=g,e.wrap&&g&&(n.adler=e.check=e.flags?ct(e.check,i,g,n.next_out-g):gn(e.check,i,g,n.next_out-g)),n.data_type=e.bits+(e.last?64:0)+(e.mode===Yt?128:0)+(e.mode===Qn||e.mode===zr?256:0),(d===0&&g===0||t===Xi)&&A===Le&&(A=hl),A},bl=n=>{if(!n||!n.state)return kt;let t=n.state;return t.window&&(t.window=null),n.state=null,Le},yl=(n,t)=>{if(!n||!n.state)return kt;const e=n.state;return(e.wrap&2)===0?kt:(e.head=t,t.done=!1,Le)},Sl=(n,t)=>{const e=t.length;let r,i,s;return!n||!n.state||(r=n.state,r.wrap!==0&&r.mode!==Kn)?kt:r.mode===Kn&&(i=1,i=gn(i,t,e,0),i!==r.check)?ji:(s=Rs(n,t,e,e),s?(r.mode=Ss,Ki):(r.havedict=1,Le))};var El=xs,Il=ks,xl=Is,kl=wl,Al=As,Ml=_l,Rl=bl,Nl=yl,Bl=Sl,Cl="pako inflate (from Nodeca project)",qt={inflateReset:El,inflateReset2:Il,inflateResetKeep:xl,inflateInit:kl,inflateInit2:Al,inflate:Ml,inflateEnd:Rl,inflateGetHeader:Nl,inflateSetDictionary:Bl,inflateInfo:Cl};function Tl(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}var Ll=Tl;const Ns=Object.prototype.toString,{Z_NO_FLUSH:Pl,Z_FINISH:Ol,Z_OK:In,Z_STREAM_END:Ur,Z_NEED_DICT:Zr,Z_STREAM_ERROR:zl,Z_DATA_ERROR:Bs,Z_MEM_ERROR:Jl}=Re;function xn(n){this.options=qn.assign({chunkSize:1024*64,windowBits:15,to:""},n||{});const t=this.options;t.raw&&t.windowBits>=0&&t.windowBits<16&&(t.windowBits=-t.windowBits,t.windowBits===0&&(t.windowBits=-15)),t.windowBits>=0&&t.windowBits<16&&!(n&&n.windowBits)&&(t.windowBits+=32),t.windowBits>15&&t.windowBits<48&&(t.windowBits&15)===0&&(t.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new Zi,this.strm.avail_out=0;let e=qt.inflateInit2(this.strm,t.windowBits);if(e!==In)throw new Error(Me[e]);if(this.header=new Ll,qt.inflateGetHeader(this.strm,this.header),t.dictionary&&(typeof t.dictionary=="string"?t.dictionary=yn.string2buf(t.dictionary):Ns.call(t.dictionary)==="[object ArrayBuffer]"&&(t.dictionary=new Uint8Array(t.dictionary)),t.raw&&(e=qt.inflateSetDictionary(this.strm,t.dictionary),e!==In)))throw new Error(Me[e])}xn.prototype.push=function(n,t){const e=this.strm,r=this.options.chunkSize,i=this.options.dictionary;let s,o,a;if(this.ended)return!1;for(t===~~t?o=t:o=t===!0?Ol:Pl,Ns.call(n)==="[object ArrayBuffer]"?e.input=new Uint8Array(n):e.input=n,e.next_in=0,e.avail_in=e.input.length;;){for(e.avail_out===0&&(e.output=new Uint8Array(r),e.next_out=0,e.avail_out=r),s=qt.inflate(e,o),s===Zr&&i&&(s=qt.inflateSetDictionary(e,i),s===In?s=qt.inflate(e,o):s===Bs&&(s=Zr));e.avail_in>0&&s===Ur&&e.state.wrap>0&&n[e.next_in]!==0;)qt.inflateReset(e),s=qt.inflate(e,o);switch(s){case zl:case Bs:case Zr:case Jl:return this.onEnd(s),this.ended=!0,!1}if(a=e.avail_out,e.next_out&&(e.avail_out===0||s===Ur))if(this.options.to==="string"){let h=yn.utf8border(e.output,e.next_out),l=e.next_out-h,c=yn.buf2string(e.output,h);e.next_out=l,e.avail_out=r-l,l&&e.output.set(e.output.subarray(h,h+l),0),this.onData(c)}else this.onData(e.output.length===e.next_out?e.output:e.output.subarray(0,e.next_out));if(!(s===In&&a===0)){if(s===Ur)return s=qt.inflateEnd(this.strm),this.onEnd(s),this.ended=!0,!0;if(e.avail_in===0)break}}return!0},xn.prototype.onData=function(n){this.chunks.push(n)},xn.prototype.onEnd=function(n){n===In&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=qn.flattenChunks(this.chunks)),this.chunks=[],this.err=n,this.msg=this.strm.msg};function Hr(n,t){const e=new xn(t);if(e.push(n),e.err)throw e.msg||Me[e.err];return e.result}function Dl(n,t){return t=t||{},t.raw=!0,Hr(n,t)}var Fl=xn,Ul=Hr,Zl=Dl,Hl=Hr,Gl=Re,Vl={Inflate:Fl,inflate:Ul,inflateRaw:Zl,ungzip:Hl,constants:Gl};const{Deflate:$l,deflate:Yl,deflateRaw:ql,gzip:Wl}=tl,{Inflate:Xl,inflate:jl,inflateRaw:Kl,ungzip:Ql}=Vl;var tc=$l,ec=Yl,nc=ql,rc=Wl,ic=Xl,sc=jl,ac=Kl,oc=Ql,lc=Re,Gr={Deflate:tc,deflate:ec,deflateRaw:nc,gzip:rc,Inflate:ic,inflate:sc,inflateRaw:ac,ungzip:oc,constants:lc},L=(n=>(n[n.End=0]="End",n[n.Byte=1]="Byte",n[n.Short=2]="Short",n[n.Int=3]="Int",n[n.Long=4]="Long",n[n.Float=5]="Float",n[n.Double=6]="Double",n[n.ByteArray=7]="ByteArray",n[n.String=8]="String",n[n.List=9]="List",n[n.Compound=10]="Compound",n[n.IntArray=11]="IntArray",n[n.LongArray=12]="LongArray",n))(L||{});const wr=class{static register(t,e){const r=e.create().getId();if(r!==t)throw new Error(`Registered factory ${L[r]} does not match type ${L[t]}`);wr.FACTORIES.set(t,e)}isEnd(){return this.getId()===L.End}isByte(){return this.getId()===L.Byte}isShort(){return this.getId()===L.Short}isInt(){return this.getId()===L.Int}isLong(){return this.getId()===L.Long}isFloat(){return this.getId()===L.Float}isDouble(){return this.getId()===L.Double}isByteArray(){return this.getId()===L.ByteArray}isString(){return this.getId()===L.String}isList(){return this.getId()===L.List}isCompound(){return this.getId()===L.Compound}isIntArray(){return this.getId()===L.IntArray}isLongArray(){return this.getId()===L.LongArray}isNumber(){return this.isByte()||this.isShort()||this.isInt()||this.isLong()||this.isFloat()||this.isDouble()}isArray(){return this.isByteArray()||this.isIntArray()||this.isLongArray()}isListOrArray(){return this.isList()||this.isArray()}getAsNumber(){return 0}getAsString(){return""}toJsonWithId(){return{type:this.getId(),value:this.toJson()}}static getFactory(t){const e=this.FACTORIES.get(t);if(!e)throw new Error(`Invalid tag id ${t}`);return e}static create(t){return this.getFactory(t).create()}static fromString(t){const e=typeof t=="string"?new St(t):t;return this.getFactory(L.Compound).fromString(e)}static fromJson(t,e=L.Compound){return this.getFactory(e).fromJson(t)}static fromJsonWithId(t){var i,s,o;const e=(i=u.Json.readObject(t))!=null?i:{},r=(s=u.Json.readInt(e.type))!=null?s:0;return wr.fromJson((o=e.value)!=null?o:{},r)}static fromBytes(t,e=L.Compound){return this.getFactory(e).fromBytes(t)}};let Y=wr;_(Y,"FACTORIES",new Map);const Ue=class extends Y{constructor(e){super();_(this,"value");this.value=typeof e=="number"?e:e?1:0}getId(){return L.Byte}equals(e){return e.isByte()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"b"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeByte(this.value)}static create(){return Ue.ZERO}static fromJson(e){var r;return new Ue((r=u.Json.readInt(e))!=null?r:0)}static fromBytes(e){const r=e.readByte();return new Ue(r)}};let Ut=Ue;_(Ut,"ZERO",new Ue(0)),_(Ut,"ONE",new Ue(1)),Y.register(L.Byte,Ut);class kn extends Y{constructor(e){super();_(this,"items");this.items=e}getItems(){return this.items.slice(0)}getAsTuple(e,r){return[...Array(e)].map((i,s)=>r(this.items[s]))}get(e){if(e=Math.floor(e),!(e<0||e>=this.items.length))return this.items[e]}get length(){return this.items.length}map(e){return this.items.map(e)}filter(e){return this.items.filter(e)}forEach(e){this.items.forEach(e)}set(e,r){this.items[e]=r}add(e){this.items.push(e)}insert(e,r){this.items.splice(e,0,r)}delete(e){this.items.splice(e,1)}clear(){this.items=[]}}class de extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="number"?new Ut(e):e))}getId(){return L.ByteArray}equals(t){return t.isByteArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return L.Byte}toString(){return"[B;"+this.items.map(e=>e.getAsNumber().toFixed()+"B").join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length),t.writeBytes(this.items.map(e=>e.getAsNumber()))}static create(){return new de([])}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readNumber(i))!=null?s:0}))!=null?r:[];return new de(e)}static fromBytes(t){const e=t.readInt(),r=t.readBytes(e);return new de(r)}}Y.register(L.ByteArray,de);class Pe extends Y{constructor(e){super();_(this,"value");this.value=e}getId(){return L.Float}equals(e){return e.isFloat()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toString()+"f"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeFloat(this.value)}static create(){return new Pe(0)}static fromJson(e){var r;return new Pe((r=u.Json.readNumber(e))!=null?r:0)}static fromBytes(e){const r=e.readFloat();return new Pe(r)}}Y.register(L.Float,Pe);class Zt extends Y{constructor(e){super();_(this,"value");this.value=e}getId(){return L.Int}equals(e){return e.isInt()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeInt(this.value)}static create(){return new Zt(0)}static fromJson(e){var r;return new Zt((r=u.Json.readInt(e))!=null?r:0)}static fromBytes(e){const r=e.readInt();return new Zt(r)}}Y.register(L.Int,Zt);class Wt extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="number"?new Zt(e):e))}getId(){return L.IntArray}equals(t){return t.isIntArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return L.Int}get length(){return this.items.length}toString(){return"[I;"+this.items.map(e=>e.getAsNumber().toFixed()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsNumber())}toJson(){return this.items.map(t=>t.getAsNumber())}toBytes(t){t.writeInt(this.items.length);for(const e of this.items)t.writeInt(e.getAsNumber())}static create(){return new Wt}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readNumber(i))!=null?s:0}))!=null?r:[];return new Wt(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let i=0;i<e;i+=1)r.push(t.readInt());return new Wt(r)}}Y.register(L.IntArray,Wt);class Tt extends kn{constructor(e,r){super(e!=null?e:[]);_(this,"type");this.type=this.items.length===0?L.End:r!=null?r:this.items[0].getId()}static make(e,r){return new Tt(r.map(i=>new e(i)))}getId(){return L.List}equals(e){return e.isList()&&this.type===e.type&&this.length===e.length&&this.items.every((r,i)=>r.equals(e.items[i]))}getType(){return this.type}getNumber(e){const r=this.get(e);return r!=null&&r.isNumber()?r.getAsNumber():0}getString(e){const r=this.get(e);return r!=null&&r.isString()?r.getAsString():""}getList(e,r){const i=this.get(e);return(i==null?void 0:i.isList())&&i.getType()===r?i:Tt.create()}getCompound(e){const r=this.get(e);return r!=null&&r.isCompound()?r:pt.create()}set(e,r){this.updateType(r),super.set(e,r)}add(e){this.updateType(e),super.add(e)}insert(e,r){this.updateType(r),super.insert(e,r)}updateType(e){if(e.getId()!==L.End){if(this.type===L.End)this.type=e.getId();else if(this.type!==e.getId())throw new Error(`Trying to add tag of type ${L[e.getId()]} to list of ${L[this.type]}`)}}clear(){super.clear(),this.type=L.End}toString(){return"["+this.items.map(e=>e.toString()).join(",")+"]"}toPrettyString(e="  ",r=0){if(this.length===0)return"[]";const i=e.repeat(r),s=e.repeat(r+1);return`[
`+this.map(o=>s+o.toPrettyString(e,r+1)).join(`,
`)+`
`+i+"]"}toSimplifiedJson(){return this.map(e=>e.toSimplifiedJson())}toJson(){return{type:this.type,items:this.items.map(e=>e.toJson())}}toBytes(e){this.items.length===0?this.type=L.End:this.type=this.items[0].getId(),e.writeByte(this.type),e.writeInt(this.items.length);for(const r of this.items)r.toBytes(e)}static create(){return new Tt}static fromJson(e){var o,a,h;const r=(o=u.Json.readObject(e))!=null?o:{},i=(a=u.Json.readNumber(r.type))!=null?a:L.Compound,s=((h=u.Json.readArray(r.items))!=null?h:[]).flatMap(l=>l!==void 0?[Y.fromJson(l,i)]:[]);return new Tt(s,i)}static fromBytes(e){const r=e.readByte(),i=e.readInt();if(r===L.End&&i>0)throw new Error(`Missing type on ListTag but length is ${i}`);const s=[];for(let o=0;o<i;o+=1)s.push(Y.fromBytes(e,r));return new Tt(s,r)}}Y.register(L.List,Tt);const st=class extends Y{constructor(e){super();_(this,"value");this.value=st.toPair(e)}static toPair(e){return Array.isArray(e)?e:st.bigintToPair(e)}static bigintToPair(e){return st.dataview.setBigInt64(0,e),[st.dataview.getInt32(0),st.dataview.getInt32(4)]}static pairToBigint(e){return st.dataview.setInt32(0,Number(e[0])),st.dataview.setInt32(4,Number(e[1])),st.dataview.getBigInt64(0)}static pairToString(e){return st.pairToBigint(e).toString()}static pairToNumber(e){return Number(st.pairToBigint(e))}getId(){return L.Long}equals(e){return e.isLong()&&this.value[0]===e.value[0]&&this.value[1]===e.value[1]}getAsNumber(){return st.pairToNumber(this.value)}getAsPair(){return this.value}toBigInt(){return st.pairToBigint(this.value)}toString(){return st.pairToString(this.value)+"L"}toPrettyString(){return this.toString()}toSimplifiedJson(){return st.pairToNumber(this.value)}toJson(){return this.value}toBytes(e){e.writeInt(this.value[0]),e.writeInt(this.value[1])}static create(){return new st([0,0])}static fromJson(e){return new st(Array.isArray(e)&&e.length===2?e.map(r=>typeof r=="number"?r:0):[0,0])}static fromBytes(e){const r=e.readInt(),i=e.readInt();return new st([r,i])}};let Oe=st;_(Oe,"dataview",new DataView(new Uint8Array(8).buffer)),Y.register(L.Long,Oe);class ge extends kn{constructor(t){super(Array.from(t!=null?t:[],e=>typeof e=="bigint"||Array.isArray(e)?new Oe(e):e))}getId(){return L.LongArray}equals(t){return t.isLongArray()&&this.length===t.length&&this.items.every((e,r)=>e.equals(t.items[r]))}getType(){return L.Long}get length(){return this.items.length}toString(){return"[I;"+this.items.map(e=>e.toString()).join(",")+"]"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.items.map(t=>t.getAsPair())}toJson(){return this.items.map(t=>t.getAsPair())}toBytes(t){t.writeInt(this.items.length);for(const e of this.items){const[r,i]=e.getAsPair();t.writeInt(r),t.writeInt(i)}}static create(){return new ge}static fromJson(t){var r;const e=(r=u.Json.readArray(t,i=>{var s;return(s=u.Json.readPair(i,o=>{var a;return(a=u.Json.readNumber(o))!=null?a:0}))!=null?s:[0,0]}))!=null?r:[];return new ge(e)}static fromBytes(t){const e=t.readInt(),r=[];for(let i=0;i<e;i+=1)r.push([t.readInt(),t.readInt()]);return new ge(r)}}Y.register(L.LongArray,ge);class ze extends Y{constructor(e){super();_(this,"value");this.value=e}getId(){return L.Short}equals(e){return e.isShort()&&this.value===e.value}getAsNumber(){return this.value}toString(){return this.value.toFixed()+"s"}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeShort(this.value)}static create(){return new ze(0)}static fromJson(e){return new ze(typeof e=="number"?Math.floor(e):0)}static fromBytes(e){const r=e.readShort();return new ze(r)}}Y.register(L.Short,ze);const tn=class extends Y{constructor(e){super();_(this,"value");this.value=e}getId(){return L.String}equals(e){return e.isString()&&this.value===e.value}getAsString(){return this.value}toString(){return'"'+this.value.replace(/(\\|")/g,"\\$1")+'"'}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeString(this.value)}static create(){return tn.EMPTY}static fromJson(e){return new tn(typeof e=="string"?e:"")}static fromBytes(e){const r=e.readString();return new tn(r)}};let _t=tn;_(_t,"EMPTY",new tn("")),Y.register(L.String,_t);var Vr;(n=>{const t=new RegExp("^[-+]?(?:[0-9]+[.]|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?$","i"),e=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?d$","i"),r=new RegExp("^[-+]?(?:[0-9]+[.]?|[0-9]*[.][0-9]+)(?:e[-+]?[0-9]+)?f$","i"),i=new RegExp("^[-+]?(?:0|[1-9][0-9]*)b$","i"),s=new RegExp("^[-+]?(?:0|[1-9][0-9]*)l$","i"),o=new RegExp("^[-+]?(?:0|[1-9][0-9]*)s$","i"),a=new RegExp("^[-+]?(?:0|[1-9][0-9]*)$","i");function h(f){if(f.skipWhitespace(),!f.canRead())throw f.createError("Expected value");const p=f.peek();if(p==="{")return l(f);if(p==="[")if(f.canRead(3)&&!St.isQuotedStringStart(f.peek(1))&&f.peek(2)===";"){f.expect("[",!0);const E=f.cursor,m=f.read();if(f.skip(),f.skipWhitespace(),f.canRead()){if(m==="B")return d(f,de,L.ByteArray,L.Byte);if(m==="L")return d(f,ge,L.LongArray,L.Long);if(m==="I")return d(f,Wt,L.IntArray,L.Int);throw f.cursor=E,f.createError(`Invalid array type '${m}'`)}else throw f.createError("Expected value")}else return c(f);else{f.skipWhitespace();const E=f.cursor;if(St.isQuotedStringStart(f.peek()))return new _t(f.readQuotedString());{const m=f.readUnquotedString();if(m.length===0)throw f.cursor=E,f.createError("Expected value");try{if(r.test(m)){const v=Number(m.substring(0,m.length-1));return new Pe(v)}else if(i.test(m)){const v=Number(m.substring(0,m.length-1));return new Ut(Math.floor(v))}else if(s.test(m)){const v=BigInt(m.substring(0,m.length-1));return new Oe(v)}else if(o.test(m)){const v=Number(m.substring(0,m.length-1));return new ze(Math.floor(v))}else if(a.test(m)){const v=Number(m);return new Zt(Math.floor(v))}else if(e.test(m)){const v=Number(m.substring(0,m.length-1));return new pe(v)}else if(t.test(m)){const v=Number(m);return new pe(v)}else{if(m.toLowerCase()==="true")return Ut.ONE;if(m.toLowerCase()==="false")return Ut.ZERO}}catch{}return m.length===0?_t.EMPTY:new _t(m)}}}n.readTag=h;function l(f){f.expect("{",!0);const p=new Map;for(f.skipWhitespace();f.canRead()&&f.peek()!=="}";){const E=f.cursor;if(f.skipWhitespace(),!f.canRead())throw f.createError("Expected key");const m=f.readString();if(m.length===0)throw f.cursor=E,f.createError("Expected key");f.expect(":",!0);const v=h(f);if(p.set(m,v),!g(f))break;if(!f.canRead())throw f.createError("Expected key")}return f.expect("}",!0),new pt(p)}function c(f){if(f.expect("[",!0),f.skipWhitespace(),!f.canRead())throw f.createError("Expected value");const p=[];let E=L.End;for(;f.peek()!=="]";){const m=f.cursor,v=h(f),b=v.getId();if(E===L.End)E=b;else if(b!==E)throw f.cursor=m,f.createError(`Can't insert ${L[b]} into list of ${L[E]}`);if(p.push(v),!g(f))break;if(!f.canRead())throw f.createError("Expected value")}return f.expect("]",!0),new Tt(p,E)}function d(f,p,E,m){const v=[];for(;f.peek()!=="]";){const b=h(f);if(b.getId()!==m)throw f.createError(`Can't insert ${L[b.getId()]} into ${L[E]}`);if(v.push(b.isLong()?b.getAsPair():b.getAsNumber()),!g(f))break;if(!f.canRead())throw f.createError("Expected value")}return f.expect("]"),new p(v)}function g(f){return f.skipWhitespace(),f.canRead()&&f.peek()===","?(f.skip(),f.skipWhitespace(),!0):!1}})(Vr||(Vr={}));class pt extends Y{constructor(e){super();_(this,"properties");this.properties=e!=null?e:new Map}getId(){return L.Compound}equals(e){return e.isCompound()&&this.size===e.size&&[...this.properties.entries()].every(([r,i])=>{const s=e.properties.get(r);return s!==void 0&&i.equals(s)})}has(e){return this.properties.has(e)}hasNumber(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isNumber())!=null?i:!1}hasString(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isString())!=null?i:!1}hasList(e,r,i){var o;const s=this.get(e);return(o=(s==null?void 0:s.isList())&&(r===void 0||s.getType()===r)&&(i===void 0||s.length===i))!=null?o:!1}hasCompound(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.isCompound())!=null?i:!1}get(e){return this.properties.get(e)}getString(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.getAsString())!=null?i:""}getNumber(e){var r,i;return(i=(r=this.get(e))==null?void 0:r.getAsNumber())!=null?i:0}getBoolean(e){return this.getNumber(e)!==0}getList(e,r){const i=this.get(e);return(i==null?void 0:i.isList())&&(r===void 0||i.getType()===r)?i:Tt.create()}getCompound(e){const r=this.get(e);return r!=null&&r.isCompound()?r:pt.create()}getByteArray(e){const r=this.get(e);return r!=null&&r.isByteArray()?r:de.create()}getIntArray(e){const r=this.get(e);return r!=null&&r.isIntArray()?r:Wt.create()}getLongArray(e){const r=this.get(e);return r!=null&&r.isLongArray()?r:ge.create()}keys(){return this.properties.keys()}get size(){return this.properties.size}map(e){return Object.fromEntries([...this.properties.entries()].map(([r,i])=>e(r,i,this)))}forEach(e){[...this.properties.entries()].forEach(([r,i])=>e(r,i,this))}set(e,r){return this.properties.set(e,r),this}delete(e){return this.properties.delete(e)}clear(){return this.properties.clear(),this}toString(){const e=[];for(const[r,i]of this.properties.entries()){const s=r.split("").some(o=>!St.isAllowedInUnquotedString(o));e.push((s?JSON.stringify(r):r)+":"+i.toString())}return"{"+e.join(",")+"}"}toPrettyString(e="  ",r=0){if(this.size===0)return"{}";const i=e.repeat(r),s=e.repeat(r+1),o=[];for(const[a,h]of this.properties.entries()){const l=a.split("").some(c=>!St.isAllowedInUnquotedString(c));o.push((l?JSON.stringify(a):a)+": "+h.toPrettyString(e,r+1))}return`{
`+o.map(a=>s+a).join(`,
`)+`
`+i+"}"}toSimplifiedJson(){return this.map((e,r)=>[e,r.toSimplifiedJson()])}toJson(){return this.map((e,r)=>[e,{type:r.getId(),value:r.toJson()}])}toBytes(e){for(const[r,i]of this.properties.entries()){const s=i.getId();e.writeByte(s),e.writeString(r),i.toBytes(e)}e.writeByte(L.End)}static create(){return new pt}static fromString(e){return Vr.readTag(e)}static fromJson(e){const r=u.Json.readMap(e,i=>{var l;const{type:s,value:o}=(l=u.Json.readObject(i))!=null?l:{},a=u.Json.readNumber(s);return Y.fromJson(o!=null?o:{},a)});return new pt(new Map(Object.entries(r)))}static fromBytes(e){const r=new Map;for(;;){const i=e.readByte();if(i===L.End)break;const s=e.readString(),o=Y.fromBytes(e,i);r.set(s,o)}return new pt(r)}}Y.register(L.Compound,pt);const Se=class{constructor(t,e,r,i,s){this.name=t,this.root=e,this.compression=r,this.littleEndian=i,this.bedrockHeader=s}writeNamedTag(t){t.writeByte(L.Compound),t.writeString(this.name),this.root.toBytes(t)}write(){const t=this.littleEndian===!0||this.bedrockHeader!==void 0,e=new hi({littleEndian:t,offset:this.bedrockHeader&&8});if(this.writeNamedTag(e),this.bedrockHeader!==void 0){const i=e.offset;e.offset=0,e.writeInt(this.bedrockHeader),e.writeInt(i-8),e.offset=i}const r=e.getData();return this.compression==="gzip"?Gr.gzip(r):this.compression==="zlib"?Gr.deflate(r):r}static readNamedTag(t){if(t.readByte()!==L.Compound)throw new Error("Top tag should be a compound");return{name:t.readString(),root:pt.fromBytes(t)}}static create(t={}){var a,h,l;const e=(a=t.name)!=null?a:Se.DEFAULT_NAME,r=pt.create(),i=(h=t.compression)!=null?h:"none",s=typeof t.bedrockHeader=="boolean"?Se.DEFAULT_BEDROCK_HEADER:t.bedrockHeader,o=(l=t.littleEndian)!=null?l:t.bedrockHeader!==void 0;return new Se(e,r,i,o,s)}static read(t,e={}){var g;const r=typeof e.bedrockHeader=="number"?e.bedrockHeader:e.bedrockHeader?ua(t):void 0,i=e.compression==="gzip"||!r&&e.compression===void 0&&yt(t),s=e.compression==="zlib"||!r&&e.compression===void 0&&xe(t),o=s||i?Gr.inflate(t):t,a=e.littleEndian||r!==void 0,h=i?"gzip":s?"zlib":"none",l=new ui(o,{littleEndian:a,offset:r&&8}),{name:c,root:d}=Se.readNamedTag(l);return new Se((g=e.name)!=null?g:c,d,h,a,r)}toJson(){var t;return{name:this.name,root:this.root.toJson(),compression:this.compression,littleEndian:this.littleEndian,bedrockHeader:(t=this.bedrockHeader)!=null?t:null}}static fromJson(t){var h,l,c,d,g;const e=(h=u.Json.readObject(t))!=null?h:{},r=(l=u.Json.readString(e.name))!=null?l:"",i=pt.fromJson((c=e.root)!=null?c:{}),s=(d=u.Json.readString(e.compression))!=null?d:"none",o=(g=u.Json.readBoolean(e.littleEndian))!=null?g:!1,a=u.Json.readNumber(e.bedrockHeader);return new Se(r,i,s,o,a)}};let Ht=Se;_(Ht,"DEFAULT_NAME",""),_(Ht,"DEFAULT_BEDROCK_HEADER",4);class Xt{constructor(t,e,r,i,s){_(this,"file");_(this,"dirty");this.x=t,this.z=e,this.compression=r,this.timestamp=i,this.raw=s,this.dirty=!1}getCompression(){switch(this.compression){case 1:return"gzip";case 2:return"zlib";case 3:return"none";default:throw new Error(`Invalid compression mode ${this.compression}`)}}setCompression(t){switch(t){case"gzip":this.compression=1;break;case"zlib":this.compression=2;break;case"none":this.compression=3;break;default:throw new Error(`Invalid compression mode ${t}`)}}getFile(){return this.file===void 0&&(this.file=Ht.read(this.raw,{compression:this.getCompression()})),this.file}getRoot(){return this.getFile().root}setRoot(t){this.file===void 0&&(this.file=Ht.create({compression:this.getCompression()})),this.file.root=t,this.markDirty()}markDirty(){this.dirty=!0}getRaw(){if(this.file===void 0||this.dirty===!1)return this.raw;this.file.compression=this.getCompression();const t=this.file.write();return this.raw=t,this.dirty=!1,t}toJson(){return{x:this.x,z:this.z,compression:this.compression,timestamp:this.timestamp,size:this.raw.byteLength}}toRef(t){return new Xt.Ref(this.x,this.z,this.compression,this.timestamp,this.raw.byteLength,t)}static create(t,e,r,i){const s=new Xt(t,e,0,i!=null?i:0,r.write());return s.setCompression(r.compression),s}static fromJson(t,e){var l,c,d,g,f,p;const r=(l=u.Json.readObject(t))!=null?l:{},i=(c=u.Json.readInt(r.x))!=null?c:0,s=(d=u.Json.readInt(r.z))!=null?d:0,o=(g=u.Json.readNumber(r.compression))!=null?g:2,a=(f=u.Json.readInt(r.timestamp))!=null?f:0,h=(p=u.Json.readInt(r.size))!=null?p:0;return new Xt.Ref(i,s,o,a,h,e)}}(n=>{class t{constructor(r,i,s,o,a,h){_(this,"file");this.x=r,this.z=i,this.compression=s,this.timestamp=o,this.size=a,this.resolver=h}getFile(){if(this.file instanceof Ht)return this.file}getRoot(){if(this.file instanceof Ht)return this.file.root}async getFileAsync(){return this.file?this.file:(this.file=(async()=>{const r=await this.resolver(this.x,this.z);return this.file=r,r})(),this.file)}async getRootAsync(){return(await this.getFileAsync()).root}isResolved(){return this.file instanceof Ht}}n.Ref=t})(Xt||(Xt={}));class Cs{constructor(t){_(this,"chunks");this.chunks=Array(32*32).fill(void 0);for(const e of t){const r=me.getIndex(e.x,e.z);this.chunks[r]=e}}getChunkPositions(){return this.chunks.flatMap(t=>t?[[t.x,t.z]]:[])}getChunk(t){if(!(t<0||t>=32*32))return this.chunks[t]}findChunk(t,e){return this.getChunk(me.getIndex(t,e))}getFirstChunk(){return this.chunks.filter(t=>t!==void 0)[0]}filter(t){return this.chunks.filter(e=>e!==void 0&&t(e))}map(t){return this.chunks.flatMap(e=>e!==void 0?[t(e)]:[])}}class me extends Cs{constructor(t){super(t)}write(){let t=0;for(const s of this.chunks)s!==void 0&&(t+=Math.ceil(s.getRaw().length/4096));const e=new Uint8Array(8192+t*4096),r=new DataView(e.buffer);let i=2;for(const s of this.chunks){if(s===void 0)continue;const o=s.getRaw(),a=4*((s.x&31)+(s.z&31)*32),h=Math.ceil(o.length/4096);r.setInt8(a,i>>16),r.setInt16(a+1,i&65535),r.setInt8(a+3,h),r.setInt32(a+4096,s.timestamp);const l=i*4096;r.setInt32(l,o.length+1),r.setInt8(l+4,s.compression),e.set(o,l+5),i+=h}return e}static read(t){const e=[];for(let r=0;r<32;r+=1)for(let i=0;i<32;i+=1){const s=4*((r&31)+(i&31)*32);if(t[s+3]===0)continue;const a=(t[s]<<16)+(t[s+1]<<8)+t[s+2],h=(t[s+4096]<<24)+(t[s+4097]<<16)+(t[s+4098]<<8)+t[s+4099],l=a*4096,c=(t[l]<<24)+(t[l+1]<<16)+(t[l+2]<<8)+t[l+3],d=t[l+4],g=t.slice(l+5,l+4+c);e.push(new Xt(r,i,d,h,g))}return new me(e)}static getIndex(t,e){return(t&31)+(e&31)*32}toJson(){return{chunks:this.map(t=>t.toJson())}}static fromJson(t,e){var o,a;const r=(o=u.Json.readObject(t))!=null?o:{},s=((a=u.Json.readArray(r.chunks))!=null?a:[]).flatMap(h=>h!==void 0?[Xt.fromJson(h,e)]:[]);return new me.Ref(s)}}(n=>{class t extends Cs{}n.Ref=t})(me||(me={}));class pe extends Y{constructor(e){super();_(this,"value");this.value=e}getId(){return L.Double}equals(e){return e.isDouble()&&this.value===e.value}getAsNumber(){return this.value}toString(){return Number.isInteger(this.value)?this.value.toFixed(1):this.value.toString()}toPrettyString(){return this.toString()}toSimplifiedJson(){return this.value}toJson(){return this.value}toBytes(e){e.writeDouble(this.value)}static create(){return new pe(0)}static fromJson(e){var r;return new pe((r=u.Json.readNumber(e))!=null?r:0)}static fromBytes(e){const r=e.readDouble();return new pe(r)}}Y.register(L.Double,pe);const en=class extends Y{constructor(){super()}getId(){return L.End}equals(t){return t.isEnd()}toString(){return"END"}toPrettyString(){return this.toString()}toSimplifiedJson(){return null}toJson(){return null}toBytes(){}static create(){return en.INSTANCE}static fromJson(){return en.INSTANCE}static fromBytes(){return en.INSTANCE}};let An=en;_(An,"INSTANCE",new en),Y.register(L.End,An),u.Direction=(n=>(n.UP="up",n.DOWN="down",n.NORTH="north",n.EAST="east",n.SOUTH="south",n.WEST="west",n))(u.Direction||{});const cc={up:[0,1,0],down:[0,-1,0],north:[0,0,-1],east:[1,0,0],south:[0,0,1],west:[-1,0,0]};(n=>{n.ALL=["up","down","north","east","south","west"];function t(e){return cc[e]}n.normal=t})(u.Direction||(u.Direction={})),u.BlockPos=void 0,(n=>{function t(d,g,f){return[d,g,f]}n.create=t,n.ZERO=n.create(0,0,0);function e(d,g,f,p){return[d[0]+g,d[1]+f,d[2]+p]}n.offset=e;function r(d,g){return[d[0]-g[0],d[1]-g[1],d[2]-g[2]]}n.subtract=r;function i(d,g){return[d[0]+g[0],d[1]+g[1],d[2]+g[2]]}n.add=i;function s(d,g){return n.offset(d,...u.Direction.normal(g))}n.towards=s;function o(d,g){return d===g?!0:d[0]===g[0]&&d[1]===g[1]&&d[2]===g[2]}n.equals=o;function a(d){return d[0]*d[0]+d[1]*d[1]+d[2]*d[2]}n.magnitude=a;function h(d){return new Tt(d.map(g=>new Zt(g)))}n.toNbt=h;function l(d){return d.getAsTuple(3,g=>g!=null&&g.isInt()?g.getAsNumber():0)}n.fromNbt=l;function c(d){var f;const g=(f=u.Json.readArray(d,p=>{var E;return(E=u.Json.readInt(p))!=null?E:0}))!=null?f:[0,0,0];return t(g[0],g[1],g[2])}n.fromJson=c})(u.BlockPos||(u.BlockPos={}));const se=class{constructor(t,e){this.namespace=t,this.path=e}is(t){return this.equals(se.parse(t))}equals(t){return this===t?!0:t instanceof se?this.namespace===t.namespace&&this.path===t.path:!1}toString(){return this.namespace+se.SEPARATOR+this.path}withPrefix(t){return new se(this.namespace,t+this.path)}static create(t){return new se(this.DEFAULT_NAMESPACE,t)}static parse(t){const e=t.indexOf(this.SEPARATOR);if(e>=0){const r=e>=1?t.substring(0,e):this.DEFAULT_NAMESPACE,i=t.substring(e+1);return new se(r,i)}return new se(this.DEFAULT_NAMESPACE,t)}};let N=se;_(N,"DEFAULT_NAMESPACE","minecraft"),_(N,"SEPARATOR",":");const wt=class{constructor(t,e={}){_(this,"name");this.properties=e,this.name=typeof t=="string"?N.parse(t):t}getName(){return this.name}getProperties(){return this.properties}getProperty(t){return this.properties[t]}isFluid(){return this.is(wt.WATER)||this.is(wt.LAVA)}isWaterlogged(){return this.is(wt.WATER)||this.is(wt.LAVA)||this.is("bubble_column")||this.is("kelp")||this.is("kelp_plant")||this.is("seagrass")||this.is("tall_seagrass")||this.properties.waterlogged==="true"}equals(t){return this.name.equals(t.name)?Object.keys(this.properties).every(e=>t.properties[e]===this.properties[e]):!1}is(t){return typeof t=="string"?this.name.equals(N.parse(t)):t instanceof N?this.name.equals(t):this.name.equals(t.name)}toString(){return Object.keys(this.properties).length===0?this.name.toString():`${this.name.toString()}[${Object.entries(this.properties).map(([t,e])=>t+"="+e).join(",")}]`}static parse(t){const e=t.indexOf("[");if(e===-1)return new wt(t);{const r=t.substring(0,e),i=t.substring(e+1,t.length-1).split(","),s=Object.fromEntries(i.map(o=>o.split("=")));return new wt(r,s)}}static fromNbt(t){const e=N.parse(t.getString("Name")),r=t.getCompound("Properties").map((i,s)=>[i,s.getAsString()]);return new wt(e,r)}static fromJson(t){var s,o;const e=(s=u.Json.readObject(t))!=null?s:{},r=N.parse((o=u.Json.readString(e.Name))!=null?o:wt.STONE.name.toString()),i=u.Json.readMap(e.Properties,a=>{var h;return(h=u.Json.readString(a))!=null?h:""});return new wt(r,i)}};let H=wt;_(H,"AIR",new wt(N.create("air"))),_(H,"STONE",new wt(N.create("stone"))),_(H,"WATER",new wt(N.create("water"),{level:"0"})),_(H,"LAVA",new wt(N.create("lava"),{level:"0"}));class Ts{constructor(t,e){_(this,"storage");_(this,"palette");this.size=t,this.defaultValue=e,this.storage=Array(t).fill(0),this.palette=[e]}index(t,e,r){return(t<<8)+(e<<4)+r}get(t,e,r){const i=this.storage[this.index(t,e,r)];return this.palette[i]}set(t,e,r,i){let s=this.palette.findIndex(o=>o.equals(i));s===-1&&(s=this.palette.length,this.palette.push(i)),this.storage[this.index(t,e,r)]=s}}const nn=class{constructor(t){_(this,"states");this.minY=t,this.states=new Ts(nn.SIZE,H.AIR)}get minBlockY(){return this.minY<<4}getBlockState(t,e,r){return this.states.get(t,e,r)}setBlockState(t,e,r,i){this.states.set(t,e,r,i)}};let We=nn;_(We,"WIDTH",16),_(We,"SIZE",nn.WIDTH*nn.WIDTH*nn.WIDTH);class uc{constructor(t,e,r){_(this,"sections");this.minY=t,this.height=e,this.pos=r,this.sections=Array(this.sectionsCount).fill(null)}get maxY(){return this.minY+this.height}get minSection(){return this.minY>>4}get maxSection(){return(this.maxY-1>>4)+1}get sectionsCount(){return this.maxSection-this.minSection}getSectionIndex(t){return(t>>4)-this.minSection}getBlockState(t){var o;const[e,r,i]=t,s=this.sections[this.getSectionIndex(r)];return(o=s==null?void 0:s.getBlockState(e&15,r&15,i&15))!=null?o:H.AIR}setBlockState(t,e){const[r,i,s]=t,o=this.getSectionIndex(i);let a=this.sections[o];if(a===null){if(e.equals(H.AIR))return;a=this.getOrCreateSection(o)}a.setBlockState(r&15,i&15,s&15,e)}getOrCreateSection(t){return this.sections[t]==null&&(this.sections[t]=new We(this.minSection+t)),this.sections[t]}}u.ChunkPos=void 0,(n=>{function t(c,d){return[c,d]}n.create=t;function e(c){return[c[0]>>4,c[2]>>4]}n.fromBlockPos=e;function r(c){return[Number(c)&4294967295,Number(c>>BigInt(32))]}n.fromLong=r;function i(c){return s(c[0],c[1])}n.toLong=i;function s(c,d){return BigInt(c&4294967295)|BigInt(d&4294967295)<<BigInt(32)}n.asLong=s;function o(c){return c[0]<<4}n.minBlockX=o;function a(c){return c[1]<<4}n.minBlockZ=a;function h(c){return(c[0]<<4)+15}n.maxBlockX=h;function l(c){return(c[1]<<4)+15}n.maxBlockZ=l})(u.ChunkPos||(u.ChunkPos={}));const Ls=new Map([["minecraft:speed",3402751],["minecraft:slowness",9154528],["minecraft:haste",14270531],["minecraft:mining_fatigue",4866583],["minecraft:strength",16762624],["minecraft:instant_health",16262179],["minecraft:instant_damage",11101546],["minecraft:jump_boost",16646020],["minecraft:nausea",5578058],["minecraft:regeneration",13458603],["minecraft:resistance",9520880],["minecraft:fire_resistance",16750848],["minecraft:water_breathing",10017472],["minecraft:invisibility",16185078],["minecraft:blindness",2039587],["minecraft:night_vision",12779366],["minecraft:hunger",5797459],["minecraft:weakness",4738376],["minecraft:poison",8889187],["minecraft:wither",7561558],["minecraft:health_boost",16284963],["minecraft:absorption",2445989],["minecraft:saturation",16262179],["minecraft:glowing",9740385],["minecraft:levitation",13565951],["minecraft:luck",5882118],["minecraft:unluck",12624973],["minecraft:slow_falling",15978425],["minecraft:conduit_power",1950417],["minecraft:dolphins_grace",8954814],["minecraft:bad_omen",745784],["minecraft:hero_of_the_village",4521796],["minecraft:darkness",2696993],["minecraft:trial_omen",1484454],["minecraft:raid_omen",14565464],["minecraft:wind_charged",12438015],["minecraft:weaving",7891290],["minecraft:oozing",10092451],["minecraft:infested",9214860]]);u.MobEffectInstance=void 0,(n=>{function t(e){return{effect:N.parse(e.getString("id")),duration:e.getNumber("duration"),amplifier:e.getNumber("amplifier")}}n.fromNbt=t})(u.MobEffectInstance||(u.MobEffectInstance={}));const Ps=new Map([["minecraft:empty",[]],["minecraft:water",[]],["minecraft:mundane",[]],["minecraft:thick",[]],["minecraft:awkward",[]],["minecraft:night_vision",[{effect:N.create("night_vision"),duration:3600,amplifier:0}]],["minecraft:long_night_vision",[{effect:N.create("night_vision"),duration:9600,amplifier:0}]],["minecraft:invisibility",[{effect:N.create("invisibility"),duration:3600,amplifier:0}]],["minecraft:long_invisibility",[{effect:N.create("invisibility"),duration:9600,amplifier:0}]],["minecraft:leaping",[{effect:N.create("jump_boost"),duration:3600,amplifier:0}]],["minecraft:long_leaping",[{effect:N.create("jump_boost"),duration:9600,amplifier:0}]],["minecraft:strong_leaping",[{effect:N.create("jump_boost"),duration:1800,amplifier:1}]],["minecraft:fire_resistance",[{effect:N.create("fire_resistance"),duration:3600,amplifier:0}]],["minecraft:long_fire_resistance",[{effect:N.create("fire_resistance"),duration:9600,amplifier:0}]],["minecraft:swiftness",[{effect:N.create("speed"),duration:3600,amplifier:0}]],["minecraft:long_swiftness",[{effect:N.create("speed"),duration:9600,amplifier:0}]],["minecraft:strong_swiftness",[{effect:N.create("speed"),duration:1800,amplifier:1}]],["minecraft:slowness",[{effect:N.create("slowness"),duration:1800,amplifier:0}]],["minecraft:long_slowness",[{effect:N.create("slowness"),duration:4800,amplifier:0}]],["minecraft:strong_slowness",[{effect:N.create("slowness"),duration:400,amplifier:3}]],["minecraft:turtle_master",[{effect:N.create("slowness"),duration:400,amplifier:3},{effect:N.create("resistance"),duration:400,amplifier:2}]],["minecraft:long_turtle_master",[{effect:N.create("slowness"),duration:800,amplifier:3},{effect:N.create("resistance"),duration:800,amplifier:2}]],["minecraft:strong_turtle_master",[{effect:N.create("slowness"),duration:400,amplifier:5},{effect:N.create("resistance"),duration:400,amplifier:3}]],["minecraft:water_breathing",[{effect:N.create("water_breathing"),duration:3600,amplifier:0}]],["minecraft:long_water_breathing",[{effect:N.create("water_breathing"),duration:9600,amplifier:0}]],["minecraft:healing",[{effect:N.create("instant_health"),duration:1,amplifier:0}]],["minecraft:strong_healing",[{effect:N.create("instant_health"),duration:1,amplifier:1}]],["minecraft:harming",[{effect:N.create("instant_damage"),duration:1,amplifier:0}]],["minecraft:strong_harming",[{effect:N.create("instant_damage"),duration:1,amplifier:1}]],["minecraft:poison",[{effect:N.create("poison"),duration:900,amplifier:0}]],["minecraft:long_poison",[{effect:N.create("poison"),duration:1800,amplifier:0}]],["minecraft:strong_poison",[{effect:N.create("poison"),duration:432,amplifier:1}]],["minecraft:regeneration",[{effect:N.create("regeneration"),duration:900,amplifier:0}]],["minecraft:long_regeneration",[{effect:N.create("regeneration"),duration:1800,amplifier:0}]],["minecraft:strong_regeneration",[{effect:N.create("regeneration"),duration:450,amplifier:1}]],["minecraft:strength",[{effect:N.create("strength"),duration:3600,amplifier:0}]],["minecraft:long_strength",[{effect:N.create("strength"),duration:9600,amplifier:0}]],["minecraft:strong_strength",[{effect:N.create("strength"),duration:1800,amplifier:1}]],["minecraft:weakness",[{effect:N.create("weakness"),duration:1800,amplifier:0}]],["minecraft:long_weakness",[{effect:N.create("weakness"),duration:4800,amplifier:0}]],["minecraft:luck",[{effect:N.create("luck"),duration:6e3,amplifier:0}]],["minecraft:slow_falling",[{effect:N.create("slow_falling"),duration:1800,amplifier:0}]],["minecraft:long_slow_falling",[{effect:N.create("slow_falling"),duration:4800,amplifier:0}]],["minecraft:wind_charged",[{effect:N.create("wind_charged"),duration:3600,amplifier:0}]],["minecraft:weaving",[{effect:N.create("weaving"),duration:3600,amplifier:0}]],["minecraft:oozing",[{effect:N.create("oozing"),duration:3600,amplifier:0}]],["minecraft:infested",[{effect:N.create("infested"),duration:3600,amplifier:0}]]]);u.PotionContents=void 0,(n=>{function t(s){const o={};return s.isString()?o.potion=N.parse(s.getAsString()):s.isCompound()&&(s.hasString("potion")&&(o.potion=N.parse(s.getString("potion"))),s.hasNumber("custom_color")&&(o.customColor=s.getNumber("custom_color")),s.hasList("custom_effects")&&(o.customEffects=s.getList("custom_effects",L.Compound).map(u.MobEffectInstance.fromNbt))),o}n.fromNbt=t;function e(s){if(s.customColor)return dt(s.customColor);const o=r(s);return i(o)}n.getColor=e;function r(s){var a;const o=[];return s.potion&&o.push(...(a=Ps.get(s.potion.toString()))!=null?a:[]),s.customEffects&&o.push(...s.customEffects),o}n.getAllEffects=r;function i(s){let[o,a,h]=[0,0,0],l=0;for(const c of s){const d=Ls.get(c.effect.toString());if(d===void 0)continue;const g=dt(d),f=c.amplifier+1;o+=f*g[0],a+=f*g[1],h+=f*g[2],l+=f}return l===0?dt(-13083194):(o=o/l,a=a/l,h=h/l,[o,a,h])}})(u.PotionContents||(u.PotionContents={})),u.Holder=void 0,(n=>{function t(i,s){return o=>typeof o=="string"?r(i,N.parse(o)):e(s(o))}n.parser=t;function e(i,s){return{value:()=>i,key:()=>s}}n.direct=e;function r(i,s,o=!0){return o?{value:()=>i.getOrThrow(s),key:()=>s}:{value:()=>i.get(s),key:()=>s}}n.reference=r})(u.Holder||(u.Holder={}));class we{constructor(t){this.entries=t}static parser(t,e){const r=e!=null?e:i=>{var s;return u.Holder.reference(t,N.parse((s=u.Json.readString(i))!=null?s:""))};return i=>{var s,o;return typeof i=="string"?i.startsWith("#")?u.Holder.reference(t.getTagRegistry(),N.parse(i.substring(1))):u.Holder.direct(new we([])):u.Holder.direct((o=new we((s=u.Json.readArray(i,r))!=null?s:[]))!=null?o:[])}}static fromJson(t,e,r){var a,h,l;const i=(a=u.Json.readObject(e))!=null?a:{},s=(h=u.Json.readBoolean(i.replace))!=null?h:!1,o=(l=u.Json.readArray(i.values,c=>{var f,p,E;var d=!0,g="";if(typeof c=="string")g=c;else{const m=(f=u.Json.readObject(c))!=null?f:{};d=(p=u.Json.readBoolean(m.required))!=null?p:!1,g=(E=u.Json.readString(m.id))!=null?E:""}return g.startsWith("#")?u.Holder.reference(t.getTagRegistry(),N.parse(g.substring(1)),d):u.Holder.reference(t,N.parse(g),d)}))!=null?l:[];return r&&!s&&t.getTagRegistry().has(r)&&(o==null||o.push(u.Holder.direct(t.getTagRegistry().get(r)))),new we(o)}*getEntries(){for(const t of this.entries){const e=t.value();e!==void 0&&(e instanceof we?yield*e.getEntries():yield t)}}}class jt{constructor(t,e,r=new Map){this.id=t,this.count=e,this.components=r}getComponent(t,e){typeof t=="string"&&(t=N.parse(t));const r=this.components.get(t.toString());if(r)return e(r)}hasComponent(t){return typeof t=="string"&&(t=N.parse(t)),this.components.has(t.toString())}clone(){const t=new Map(this.components);return new jt(this.id,this.count,t)}is(t){return typeof t=="string"?this.id.equals(N.parse(t)):t instanceof N?this.id.equals(t):this.id.equals(t.id)}equals(t){return this===t?!0:t instanceof jt?this.count===t.count&&this.isSameItemSameComponents(t):!1}isSameItemSameComponents(t){if(!this.id.equals(t.id)||this.components.size!==t.components.size)return!1;for(const[e,r]of this.components){const i=t.components.get(e);if(r.toString()!==(i==null?void 0:i.toString()))return!1}return!0}toString(){let t=this.id.toString();return this.components.size>0&&(t+=`[${[...this.components.entries()].map(([e,r])=>`${e}=${r.toString()}`).join(",")}]`),this.count>1&&(t+=` ${this.count}`),t}toNbt(){const t=new pt().set("id",new _t(this.id.toString()));return this.count>1&&t.set("count",new Zt(this.count)),this.components.size>0&&t.set("components",new pt(this.components)),t}static fromNbt(t){const e=N.parse(t.getString("id")),r=t.hasNumber("count")?t.getNumber("count"):1,i=new Map(Object.entries(t.getCompound("components").map((s,o)=>[N.parse(s).toString(),o])));return new jt(e,r,i)}}const Ze=class{constructor(t,e){_(this,"storage",new Map);_(this,"builtin",new Map);_(this,"tags");this.key=t,this.parser=e}static createAndRegister(t,e){const r=new Ze(N.create(t),e);return Ze.REGISTRY.register(r.key,r),r}register(t,e,r){return this.storage.set(t.toString(),e),r&&this.builtin.set(t.toString(),e),u.Holder.reference(this,t)}delete(t){const e=this.storage.delete(t.toString());return this.builtin.delete(t.toString()),e}keys(){return[...this.storage.keys()].map(t=>N.parse(t))}has(t){return this.storage.has(t.toString())}get(t){var e=this.storage.get(t.toString());return e instanceof Function&&(e=e(),this.storage.set(t.toString(),e)),e}getOrThrow(t){const e=this.get(t);if(e===void 0)throw new Error(`Missing key in ${this.key.toString()}: ${t.toString()}`);return e}parse(t){if(!this.parser)throw new Error(`No parser exists for ${this.key.toString()}`);return this.parser(t)}clear(){this.storage.clear();for(const[t,e]of this.builtin.entries())this.storage.set(t,e);return this.tags&&this.tags.clear(),this}assign(t){if(!this.key.equals(t.key))throw new Error(`Cannot assign registry of type ${t.key.toString()} to registry of type ${this.key.toString()}`);for(const e of t.keys())this.storage.set(e.toString(),t.getOrThrow(e));return this}cloneEmpty(){return new Ze(this.key,this.parser)}forEach(t){for(const[e,r]of this.storage.entries())t(N.parse(e),r instanceof Function?r():r,this)}map(t){return[...this.storage.entries()].map(([e,r])=>t(N.parse(e),r instanceof Function?r():r,this))}getTagRegistry(){return this.tags===void 0&&(this.tags=new Ze(new N(this.key.namespace,`tags/${this.key.path}`))),this.tags}};let Et=Ze;_(Et,"REGISTRY",new Ze(N.create("root"))),u.Rotation=(n=>(n.NONE="none",n.CLOCKWISE_90="clockwise_90",n.CLOCKWISE_180="180",n.COUNTERCLOCKWISE_90="counterclockwise_90",n))(u.Rotation||{}),(n=>{function t(e){return["none","clockwise_90","180","counterclockwise_90"][e.nextInt(4)]}n.getRandom=t})(u.Rotation||(u.Rotation={}));const vr=class{constructor(t,e=[],r=[]){_(this,"blocksMap",[]);this.size=t,this.palette=e,this.blocks=r,r.forEach(i=>{if(!this.isInside(i.pos))throw new Error(`Found block at ${i.pos} which is outside the structure bounds ${this.size}`);this.blocksMap[i.pos[0]*t[1]*t[2]+i.pos[1]*t[2]+i.pos[2]]=i})}getSize(){return this.size}addBlock(t,e,r,i){if(!this.isInside(t))throw new Error(`Cannot add block at ${t} outside the structure bounds ${this.size}`);const s=new H(e,r);let o=this.palette.findIndex(a=>a.equals(s));return o===-1&&(o=this.palette.length,this.palette.push(s)),this.blocks.push({pos:t,state:o,nbt:i}),this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]]={pos:t,state:o,nbt:i},this}getBlocks(){return this.blocks.map(t=>this.toPlacedBlock(t))}getBlock(t){if(!this.isInside(t))return null;const e=this.blocksMap[t[0]*this.size[1]*this.size[2]+t[1]*this.size[2]+t[2]];return e?this.toPlacedBlock(e):null}toPlacedBlock(t){const e=this.palette[t.state];if(!e)throw new Error(`Block at ${t.pos.join(" ")} in structure references invalid palette index ${t.state}`);return{pos:t.pos,state:e,nbt:t.nbt}}isInside(t){return t[0]>=0&&t[0]<this.size[0]&&t[1]>=0&&t[1]<this.size[1]&&t[2]>=0&&t[2]<this.size[2]}static fromNbt(t){const e=u.BlockPos.fromNbt(t.getList("size")),r=t.getList("palette",L.Compound).map(s=>H.fromNbt(s)),i=t.getList("blocks",L.Compound).map(s=>{const o=u.BlockPos.fromNbt(s.getList("pos")),a=s.getNumber("state"),h=s.getCompound("nbt");return{pos:o,state:a,nbt:h.size>0?h:void 0}});return new vr(e,r,i)}static transform(t,e,r){switch(e){case u.Rotation.COUNTERCLOCKWISE_90:return u.BlockPos.create(r[0]-r[2]+t[2],t[1],r[0]+r[2]-t[0]);case u.Rotation.CLOCKWISE_90:return u.BlockPos.create(r[0]+r[2]-t[2],t[1],r[2]-r[0]+t[0]);case u.Rotation.CLOCKWISE_180:return u.BlockPos.create(r[0]+r[0]-t[0],t[1],r[2]+r[2]-t[2]);default:return t}}};let Kt=vr;_(Kt,"REGISTRY",Et.createAndRegister("structures")),_(Kt,"EMPTY",new vr(u.BlockPos.ZERO));function Qt(n){return n*n}function ve(n,t,e){return Math.max(t,Math.min(e,n))}function te(n,t,e){return t+n*(e-t)}function er(n,t,e,r,i,s){return te(t,te(n,e,r),te(n,i,s))}function Os(n,t,e,r,i,s,o,a,h,l,c){return te(e,er(n,t,r,i,s,o),er(n,t,a,h,l,c))}function Mn(n,t,e){return n===0?t():n===1?e():t()+n*(e()-t())}function $r(n,t,e,r,i,s){return Mn(t,()=>Mn(n,e,r),()=>Mn(n,i,s))}function zs(n,t,e,r,i,s,o,a,h,l,c){return Mn(e,()=>$r(n,t,r,i,s,o),()=>$r(n,t,a,h,l,c))}function nr(n,t,e){return e<0?n:e>1?t:te(e,n,t)}function Yr(n,t,e){return(n-t)/(e-t)}function rr(n){return n*n*n*(n*(n*6-15)+10)}function Rn(n,t,e,r,i){return te(Yr(n,t,e),r,i)}function qr(n,t,e,r,i){return nr(r,i,Yr(n,t,e))}function Js(n,t,e){let r=t-n;for(;r>0;){const i=Math.floor(r/2),s=n+i;if(e(s)){r=i;continue}n=s+1,r-=i+1}return n}function Wr(n,t,e){let r=BigInt(n*3129871)^BigInt(e)*BigInt(116129781)^BigInt(t);return r=r*r*BigInt(42317861)+r*BigInt(11),r>>BigInt(16)}function ir(n,t,e,r,i,s,o,a){return BigInt(n)<<BigInt(56)|BigInt(t)<<BigInt(48)|BigInt(e)<<BigInt(40)|BigInt(r)<<BigInt(32)|BigInt(i)<<BigInt(24)|BigInt(s)<<BigInt(16)|BigInt(o)<<BigInt(8)|BigInt(a)}function Xr(n){return(n&n-1)===0}function Ds(n){return n-=1,n|=n>>1,n|=n>>2,n|=n>>4,n|=n>>8,n|=n>>18,n|=n>>32,n+1}function sr(n,t,e){return n.nextInt(e-t+1)+t}function ar(n,t,e){return t>=e?t:n.nextInt(e-t+1)+t}function Fs(n,t){for(var e=n.length;e>1;e--){const r=t.nextInt(e),i=n[r];n[r]=n[e-1],n[e-1]=i}}u.MinMaxNumberFunction=void 0,(n=>{function t(e){return typeof e=="object"&&e!==null&&"minValue"in e&&"maxValue"in e}n.is=t})(u.MinMaxNumberFunction||(u.MinMaxNumberFunction={})),u.CubicSpline=void 0,(n=>{function t(i,s){var l,c,d,g;if(typeof i=="number")return new e(i);const o=(l=u.Json.readObject(i))!=null?l:{},a=new r(s(o.coordinate)),h=(c=u.Json.readArray(o.points,f=>{var p;return(p=u.Json.readObject(f))!=null?p:{}}))!=null?c:[];if(h.length===0)return new e(0);for(const f of h){const p=(d=u.Json.readNumber(f.location))!=null?d:0,E=t(f.value,s),m=(g=u.Json.readNumber(f.derivative))!=null?g:0;a.addPoint(p,E,m)}return a}n.fromJson=t;class e{constructor(s){this.value=s}compute(){return this.value}min(){return this.value}max(){return this.value}mapAll(){return this}calculateMinMax(){}}n.Constant=e;class r{constructor(s,o=[],a=[],h=[]){_(this,"calculatedMin",Number.NEGATIVE_INFINITY);_(this,"calculatedMax",Number.POSITIVE_INFINITY);this.coordinate=s,this.locations=o,this.values=a,this.derivatives=h}compute(s){const o=this.coordinate.compute(s),a=Js(0,this.locations.length,w=>o<this.locations[w])-1,h=this.locations.length-1;if(a<0)return this.values[0].compute(s)+this.derivatives[0]*(o-this.locations[0]);if(a===h)return this.values[h].compute(s)+this.derivatives[h]*(o-this.locations[h]);const l=this.locations[a],c=this.locations[a+1],d=this.derivatives[a],g=this.derivatives[a+1],f=(o-l)/(c-l),p=this.values[a].compute(s),E=this.values[a+1].compute(s),m=d*(c-l)-(E-p),v=-g*(c-l)+(E-p);return te(f,p,E)+f*(1-f)*te(f,m,v)}min(){return this.calculatedMin}max(){return this.calculatedMax}mapAll(s){return new r(s(this.coordinate),this.locations,this.values.map(o=>o.mapAll(s)),this.derivatives)}addPoint(s,o,a=0){return this.locations.push(s),this.values.push(typeof o=="number"?new n.Constant(o):o),this.derivatives.push(a),this}calculateMinMax(){if(!u.MinMaxNumberFunction.is(this.coordinate))return;const s=this.locations.length-1;var o=Number.POSITIVE_INFINITY,a=Number.NEGATIVE_INFINITY;const h=this.coordinate.minValue(),l=this.coordinate.maxValue();for(const d of this.values)d.calculateMinMax();if(h<this.locations[0]){const d=r.linearExtend(h,this.locations,this.values[0].min(),this.derivatives,0),g=r.linearExtend(h,this.locations,this.values[0].max(),this.derivatives,0);o=Math.min(o,Math.min(d,g)),a=Math.max(a,Math.max(d,g))}if(l>this.locations[s]){const d=r.linearExtend(l,this.locations,this.values[s].min(),this.derivatives,s),g=r.linearExtend(l,this.locations,this.values[s].max(),this.derivatives,s);o=Math.min(o,Math.min(d,g)),a=Math.max(a,Math.max(d,g))}for(const d of this.values)o=Math.min(o,d.min()),a=Math.max(a,d.max());for(var c=0;c<s;++c){const d=this.locations[c],f=this.locations[c+1]-d,p=this.values[c],E=this.values[c+1],m=p.min(),v=p.max(),b=E.min(),w=E.max(),S=this.derivatives[c],k=this.derivatives[c+1];if(S!==0||k!==0){const R=S*f,x=k*f,A=Math.min(m,b),B=Math.max(v,w),M=R-w+m,C=R-b+v,O=-x+b-v,F=-x+w-m,D=Math.min(M,O),X=Math.max(C,F);o=Math.min(o,A+.25*D),a=Math.max(a,B+.25*X)}}this.calculatedMin=o,this.calculatedMax=a}static linearExtend(s,o,a,h,l){const c=h[l];return c==0?a:a+c*(s-o[l])}}n.MultiPoint=r})(u.CubicSpline||(u.CubicSpline={}));var or=1e-6,ee=typeof Float32Array<"u"?Float32Array:Array,hc=Math.PI/180;function jr(n){return n*hc}Math.hypot||(Math.hypot=function(){for(var n=0,t=arguments.length;t--;)n+=arguments[t]*arguments[t];return Math.sqrt(n)});function Kr(){var n=new ee(9);return ee!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[5]=0,n[6]=0,n[7]=0),n[0]=1,n[4]=1,n[8]=1,n}function fc(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[4],n[4]=t[5],n[5]=t[6],n[6]=t[8],n[7]=t[9],n[8]=t[10],n}function dc(n){var t=new ee(9);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t}function gc(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function mc(n,t){if(n===t){var e=t[1],r=t[2],i=t[5];n[1]=t[3],n[2]=t[6],n[3]=e,n[5]=t[7],n[6]=r,n[7]=i}else n[0]=t[0],n[1]=t[3],n[2]=t[6],n[3]=t[1],n[4]=t[4],n[5]=t[7],n[6]=t[2],n[7]=t[5],n[8]=t[8];return n}function pc(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],h=t[6],l=t[7],c=t[8],d=c*o-a*l,g=-c*s+a*h,f=l*s-o*h,p=e*d+r*g+i*f;return p?(p=1/p,n[0]=d*p,n[1]=(-c*r+i*l)*p,n[2]=(a*r-i*o)*p,n[3]=g*p,n[4]=(c*e-i*h)*p,n[5]=(-a*e+i*s)*p,n[6]=f*p,n[7]=(-l*e+r*h)*p,n[8]=(o*e-r*s)*p,n):null}function wc(n,t,e){var r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],c=t[7],d=t[8],g=e[0],f=e[1],p=e[2],E=e[3],m=e[4],v=e[5],b=e[6],w=e[7],S=e[8];return n[0]=g*r+f*o+p*l,n[1]=g*i+f*a+p*c,n[2]=g*s+f*h+p*d,n[3]=E*r+m*o+v*l,n[4]=E*i+m*a+v*c,n[5]=E*s+m*h+v*d,n[6]=b*r+w*o+S*l,n[7]=b*i+w*a+S*c,n[8]=b*s+w*h+S*d,n}function vc(n,t,e){var r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],c=t[7],d=t[8],g=e[0],f=e[1];return n[0]=r,n[1]=i,n[2]=s,n[3]=o,n[4]=a,n[5]=h,n[6]=g*r+f*o+l,n[7]=g*i+f*a+c,n[8]=g*s+f*h+d,n}function _c(n,t,e){var r=e[0],i=e[1];return n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n[3]=i*t[3],n[4]=i*t[4],n[5]=i*t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n}function bc(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],o=e+e,a=r+r,h=i+i,l=e*o,c=r*o,d=r*a,g=i*o,f=i*a,p=i*h,E=s*o,m=s*a,v=s*h;return n[0]=1-d-p,n[3]=c-v,n[6]=g+m,n[1]=c+v,n[4]=1-l-p,n[7]=f-E,n[2]=g-m,n[5]=f+E,n[8]=1-l-d,n}function yc(n){return"mat3("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+")"}function Sc(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n}function Ec(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n}function Ic(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n}var xc=wc,kc=Ec;function K(){var n=new ee(16);return ee!=Float32Array&&(n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=0,n[12]=0,n[13]=0,n[14]=0),n[0]=1,n[5]=1,n[10]=1,n[15]=1,n}function Ac(n){var t=new ee(16);return t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t[4]=n[4],t[5]=n[5],t[6]=n[6],t[7]=n[7],t[8]=n[8],t[9]=n[9],t[10]=n[10],t[11]=n[11],t[12]=n[12],t[13]=n[13],t[14]=n[14],t[15]=n[15],t}function Mc(n,t){return n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Rc(n,t){if(n===t){var e=t[1],r=t[2],i=t[3],s=t[6],o=t[7],a=t[11];n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=e,n[6]=t[9],n[7]=t[13],n[8]=r,n[9]=s,n[11]=t[14],n[12]=i,n[13]=o,n[14]=a}else n[0]=t[0],n[1]=t[4],n[2]=t[8],n[3]=t[12],n[4]=t[1],n[5]=t[5],n[6]=t[9],n[7]=t[13],n[8]=t[2],n[9]=t[6],n[10]=t[10],n[11]=t[14],n[12]=t[3],n[13]=t[7],n[14]=t[11],n[15]=t[15];return n}function Nc(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],o=t[4],a=t[5],h=t[6],l=t[7],c=t[8],d=t[9],g=t[10],f=t[11],p=t[12],E=t[13],m=t[14],v=t[15],b=e*a-r*o,w=e*h-i*o,S=e*l-s*o,k=r*h-i*a,R=r*l-s*a,x=i*l-s*h,A=c*E-d*p,B=c*m-g*p,M=c*v-f*p,C=d*m-g*E,O=d*v-f*E,F=g*v-f*m,D=b*F-w*O+S*C+k*M-R*B+x*A;return D?(D=1/D,n[0]=(a*F-h*O+l*C)*D,n[1]=(i*O-r*F-s*C)*D,n[2]=(E*x-m*R+v*k)*D,n[3]=(g*R-d*x-f*k)*D,n[4]=(h*M-o*F-l*B)*D,n[5]=(e*F-i*M+s*B)*D,n[6]=(m*S-p*x-v*w)*D,n[7]=(c*x-g*S+f*w)*D,n[8]=(o*O-a*M+l*A)*D,n[9]=(r*M-e*O-s*A)*D,n[10]=(p*R-E*S+v*b)*D,n[11]=(d*S-c*R-f*b)*D,n[12]=(a*B-o*C-h*A)*D,n[13]=(e*C-r*B+i*A)*D,n[14]=(E*w-p*k-m*b)*D,n[15]=(c*k-d*w+g*b)*D,n):null}function Bc(n,t,e){var r=t[0],i=t[1],s=t[2],o=t[3],a=t[4],h=t[5],l=t[6],c=t[7],d=t[8],g=t[9],f=t[10],p=t[11],E=t[12],m=t[13],v=t[14],b=t[15],w=e[0],S=e[1],k=e[2],R=e[3];return n[0]=w*r+S*a+k*d+R*E,n[1]=w*i+S*h+k*g+R*m,n[2]=w*s+S*l+k*f+R*v,n[3]=w*o+S*c+k*p+R*b,w=e[4],S=e[5],k=e[6],R=e[7],n[4]=w*r+S*a+k*d+R*E,n[5]=w*i+S*h+k*g+R*m,n[6]=w*s+S*l+k*f+R*v,n[7]=w*o+S*c+k*p+R*b,w=e[8],S=e[9],k=e[10],R=e[11],n[8]=w*r+S*a+k*d+R*E,n[9]=w*i+S*h+k*g+R*m,n[10]=w*s+S*l+k*f+R*v,n[11]=w*o+S*c+k*p+R*b,w=e[12],S=e[13],k=e[14],R=e[15],n[12]=w*r+S*a+k*d+R*E,n[13]=w*i+S*h+k*g+R*m,n[14]=w*s+S*l+k*f+R*v,n[15]=w*o+S*c+k*p+R*b,n}function G(n,t,e){var r=e[0],i=e[1],s=e[2],o,a,h,l,c,d,g,f,p,E,m,v;return t===n?(n[12]=t[0]*r+t[4]*i+t[8]*s+t[12],n[13]=t[1]*r+t[5]*i+t[9]*s+t[13],n[14]=t[2]*r+t[6]*i+t[10]*s+t[14],n[15]=t[3]*r+t[7]*i+t[11]*s+t[15]):(o=t[0],a=t[1],h=t[2],l=t[3],c=t[4],d=t[5],g=t[6],f=t[7],p=t[8],E=t[9],m=t[10],v=t[11],n[0]=o,n[1]=a,n[2]=h,n[3]=l,n[4]=c,n[5]=d,n[6]=g,n[7]=f,n[8]=p,n[9]=E,n[10]=m,n[11]=v,n[12]=o*r+c*i+p*s+t[12],n[13]=a*r+d*i+E*s+t[13],n[14]=h*r+g*i+m*s+t[14],n[15]=l*r+f*i+v*s+t[15]),n}function At(n,t,e){var r=e[0],i=e[1],s=e[2];return n[0]=t[0]*r,n[1]=t[1]*r,n[2]=t[2]*r,n[3]=t[3]*r,n[4]=t[4]*i,n[5]=t[5]*i,n[6]=t[6]*i,n[7]=t[7]*i,n[8]=t[8]*s,n[9]=t[9]*s,n[10]=t[10]*s,n[11]=t[11]*s,n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15],n}function Cc(n,t,e,r){var i=r[0],s=r[1],o=r[2],a=Math.hypot(i,s,o),h,l,c,d,g,f,p,E,m,v,b,w,S,k,R,x,A,B,M,C,O,F,D,X;return a<or?null:(a=1/a,i*=a,s*=a,o*=a,h=Math.sin(e),l=Math.cos(e),c=1-l,d=t[0],g=t[1],f=t[2],p=t[3],E=t[4],m=t[5],v=t[6],b=t[7],w=t[8],S=t[9],k=t[10],R=t[11],x=i*i*c+l,A=s*i*c+o*h,B=o*i*c-s*h,M=i*s*c-o*h,C=s*s*c+l,O=o*s*c+i*h,F=i*o*c+s*h,D=s*o*c-i*h,X=o*o*c+l,n[0]=d*x+E*A+w*B,n[1]=g*x+m*A+S*B,n[2]=f*x+v*A+k*B,n[3]=p*x+b*A+R*B,n[4]=d*M+E*C+w*O,n[5]=g*M+m*C+S*O,n[6]=f*M+v*C+k*O,n[7]=p*M+b*C+R*O,n[8]=d*F+E*D+w*X,n[9]=g*F+m*D+S*X,n[10]=f*F+v*D+k*X,n[11]=p*F+b*D+R*X,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n)}function Nn(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[4],o=t[5],a=t[6],h=t[7],l=t[8],c=t[9],d=t[10],g=t[11];return t!==n&&(n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=t[3],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[4]=s*i+l*r,n[5]=o*i+c*r,n[6]=a*i+d*r,n[7]=h*i+g*r,n[8]=l*i-s*r,n[9]=c*i-o*r,n[10]=d*i-a*r,n[11]=g*i-h*r,n}function bt(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[0],o=t[1],a=t[2],h=t[3],l=t[8],c=t[9],d=t[10],g=t[11];return t!==n&&(n[4]=t[4],n[5]=t[5],n[6]=t[6],n[7]=t[7],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=s*i-l*r,n[1]=o*i-c*r,n[2]=a*i-d*r,n[3]=h*i-g*r,n[8]=s*r+l*i,n[9]=o*r+c*i,n[10]=a*r+d*i,n[11]=h*r+g*i,n}function Us(n,t,e){var r=Math.sin(e),i=Math.cos(e),s=t[0],o=t[1],a=t[2],h=t[3],l=t[4],c=t[5],d=t[6],g=t[7];return t!==n&&(n[8]=t[8],n[9]=t[9],n[10]=t[10],n[11]=t[11],n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]),n[0]=s*i+l*r,n[1]=o*i+c*r,n[2]=a*i+d*r,n[3]=h*i+g*r,n[4]=l*i-s*r,n[5]=c*i-o*r,n[6]=d*i-a*r,n[7]=g*i-h*r,n}function Tc(n,t){return n[0]=t[12],n[1]=t[13],n[2]=t[14],n}function Lc(n,t){var e=t[0],r=t[1],i=t[2],s=t[3],o=e+e,a=r+r,h=i+i,l=e*o,c=r*o,d=r*a,g=i*o,f=i*a,p=i*h,E=s*o,m=s*a,v=s*h;return n[0]=1-d-p,n[1]=c+v,n[2]=g-m,n[3]=0,n[4]=c-v,n[5]=1-l-p,n[6]=f+E,n[7]=0,n[8]=g+m,n[9]=f-E,n[10]=1-l-d,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function Pc(n,t,e,r,i){var s=1/Math.tan(t/2),o;return n[0]=s/e,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=s,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0?(o=1/(r-i),n[10]=(i+r)*o,n[14]=2*i*r*o):(n[10]=-1,n[14]=-2*r),n}function Oc(n,t,e,r,i,s,o){var a=1/(t-e),h=1/(r-i),l=1/(s-o);return n[0]=-2*a,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*h,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*l,n[11]=0,n[12]=(t+e)*a,n[13]=(i+r)*h,n[14]=(o+s)*l,n[15]=1,n}function zc(n){return"mat4("+n[0]+", "+n[1]+", "+n[2]+", "+n[3]+", "+n[4]+", "+n[5]+", "+n[6]+", "+n[7]+", "+n[8]+", "+n[9]+", "+n[10]+", "+n[11]+", "+n[12]+", "+n[13]+", "+n[14]+", "+n[15]+")"}function Jc(n,t,e){return n[0]=t[0]+e[0],n[1]=t[1]+e[1],n[2]=t[2]+e[2],n[3]=t[3]+e[3],n[4]=t[4]+e[4],n[5]=t[5]+e[5],n[6]=t[6]+e[6],n[7]=t[7]+e[7],n[8]=t[8]+e[8],n[9]=t[9]+e[9],n[10]=t[10]+e[10],n[11]=t[11]+e[11],n[12]=t[12]+e[12],n[13]=t[13]+e[13],n[14]=t[14]+e[14],n[15]=t[15]+e[15],n}function Dc(n,t,e){return n[0]=t[0]-e[0],n[1]=t[1]-e[1],n[2]=t[2]-e[2],n[3]=t[3]-e[3],n[4]=t[4]-e[4],n[5]=t[5]-e[5],n[6]=t[6]-e[6],n[7]=t[7]-e[7],n[8]=t[8]-e[8],n[9]=t[9]-e[9],n[10]=t[10]-e[10],n[11]=t[11]-e[11],n[12]=t[12]-e[12],n[13]=t[13]-e[13],n[14]=t[14]-e[14],n[15]=t[15]-e[15],n}function Fc(n,t,e){return n[0]=t[0]*e,n[1]=t[1]*e,n[2]=t[2]*e,n[3]=t[3]*e,n[4]=t[4]*e,n[5]=t[5]*e,n[6]=t[6]*e,n[7]=t[7]*e,n[8]=t[8]*e,n[9]=t[9]*e,n[10]=t[10]*e,n[11]=t[11]*e,n[12]=t[12]*e,n[13]=t[13]*e,n[14]=t[14]*e,n[15]=t[15]*e,n}var Uc=Bc,Zc=Dc;function Qr(){var n=new ee(3);return ee!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function Hc(n,t,e){var r=new ee(3);return r[0]=n,r[1]=t,r[2]=e,r}function Gc(n,t){return n[0]=-t[0],n[1]=-t[1],n[2]=-t[2],n}function Vc(n,t,e){var r=t[0],i=t[1],s=t[2],o=e[3]*r+e[7]*i+e[11]*s+e[15];return o=o||1,n[0]=(e[0]*r+e[4]*i+e[8]*s+e[12])/o,n[1]=(e[1]*r+e[5]*i+e[9]*s+e[13])/o,n[2]=(e[2]*r+e[6]*i+e[10]*s+e[14])/o,n}function $c(n,t){var e=n[0],r=n[1],i=n[2],s=t[0],o=t[1],a=t[2];return Math.abs(e-s)<=or*Math.max(1,Math.abs(e),Math.abs(s))&&Math.abs(r-o)<=or*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(i-a)<=or*Math.max(1,Math.abs(i),Math.abs(a))}(function(){var n=Qr();return function(t,e,r,i,s,o){var a,h;for(e||(e=3),r||(r=0),i?h=Math.min(i*e+r,t.length):h=t.length,a=r;a<h;a+=e)n[0]=t[a],n[1]=t[a+1],n[2]=t[a+2],s(n,n,o),t[a]=n[0],t[a+1]=n[1],t[a+2]=n[2];return t}})();class Bn{constructor(t){_(this,"data");this.data=t!=null?t:Kr()}static fromMatrix4(t){return new Bn(fc(Kr(),t.data))}static fromQuat(t){return new Bn(bc(Kr(),t))}clone(){return new Bn(dc(this.data))}copy(t){return gc(this.data,t.data),this}translate(t){return vc(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}scale(t){return typeof t=="number"?Ic(this.data,this.data,t):_c(this.data,this.data,Array.isArray(t)?t:[t.x,t.y]),this}add(t){return Sc(this.data,this.data,t.data),this}sub(t){return kc(this.data,this.data,t.data),this}mul(t){return xc(this.data,this.data,t.data),this}transpose(){return mc(this.data,this.data),this}invert(){return pc(this.data,this.data),this}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m10(){return this.data[3]}get m11(){return this.data[4]}get m12(){return this.data[5]}get m20(){return this.data[6]}get m21(){return this.data[7]}get m22(){return this.data[8]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m10(t){this.data[3]=t}set m11(t){this.data[4]=t}set m12(t){this.data[5]=t}set m20(t){this.data[6]=t}set m21(t){this.data[7]=t}set m22(t){this.data[8]=t}toString(){return yc(this.data)}}class U{constructor(t,e,r){this.x=t,this.y=e,this.z=r}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}lengthSquared(){return this.x*this.x+this.y*this.y+this.z*this.z}distance(t){return this.sub(t).length()}distanceSquared(t){return this.sub(t).lengthSquared()}abs(){return new U(Math.abs(this.x),Math.abs(this.y),Math.abs(this.z))}add(t){return new U(this.x+t.x,this.y+t.y,this.z+t.z)}sub(t){return new U(this.x-t.x,this.y-t.y,this.z-t.z)}mul(t){return new U(this.x*t.x,this.y*t.y,this.z*t.z)}div(t){return new U(this.x/t.x,this.y/t.y,this.z/t.z)}scale(t){return new U(this.x*t,this.y*t,this.z*t)}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}cross(t){const e=this.y*t.z-this.z*t.y,r=this.z*t.x-this.x*t.z,i=this.x*t.y-this.y*t.x;return new U(e,r,i)}normalize(){if(this.x==0&&this.y==0&&this.z==0)return this;const t=1/this.length();return new U(this.x*t,this.y*t,this.z*t)}components(){return[this.x,this.y,this.z]}toString(){return`[${this.x} ${this.y} ${this.z}]`}}class lr{constructor(t){_(this,"data");this.data=t!=null?t:K()}static fromQuat(t){return new lr(Lc(K(),t))}clone(){return new lr(Ac(this.data))}translate(t){return G(this.data,this.data,Array.isArray(t)?t:t.components()),this}scale(t){return typeof t=="number"?Fc(this.data,this.data,t):At(this.data,this.data,Array.isArray(t)?t:t.components()),this}add(t){return Jc(this.data,this.data,t.data),this}sub(t){return Zc(this.data,this.data,t.data),this}mul(t){return Uc(this.data,this.data,t.data),this}transpose(){return Rc(this.data,this.data),this}invert(){return Nc(this.data,this.data),this}affine(){return this.scale(1/this.m33)}get m00(){return this.data[0]}get m01(){return this.data[1]}get m02(){return this.data[2]}get m03(){return this.data[3]}get m10(){return this.data[4]}get m11(){return this.data[5]}get m12(){return this.data[6]}get m13(){return this.data[7]}get m20(){return this.data[8]}get m21(){return this.data[9]}get m22(){return this.data[10]}get m23(){return this.data[11]}get m30(){return this.data[12]}get m31(){return this.data[13]}get m32(){return this.data[14]}get m33(){return this.data[15]}set m00(t){this.data[0]=t}set m01(t){this.data[1]=t}set m02(t){this.data[2]=t}set m03(t){this.data[3]=t}set m10(t){this.data[4]=t}set m11(t){this.data[5]=t}set m12(t){this.data[6]=t}set m13(t){this.data[7]=t}set m20(t){this.data[8]=t}set m21(t){this.data[9]=t}set m22(t){this.data[10]=t}set m23(t){this.data[11]=t}set m30(t){this.data[12]=t}set m31(t){this.data[13]=t}set m32(t){this.data[14]=t}set m33(t){this.data[15]=t}getTranslation(){const[t,e,r]=Tc(Qr(),this.data);return new U(t,e,r)}toString(){return zc(this.data)}}var ti={exports:{}},Zs={exports:{}};(function(){var n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",t={rotl:function(e,r){return e<<r|e>>>32-r},rotr:function(e,r){return e<<32-r|e>>>r},endian:function(e){if(e.constructor==Number)return t.rotl(e,8)&16711935|t.rotl(e,24)&4278255360;for(var r=0;r<e.length;r++)e[r]=t.endian(e[r]);return e},randomBytes:function(e){for(var r=[];e>0;e--)r.push(Math.floor(Math.random()*256));return r},bytesToWords:function(e){for(var r=[],i=0,s=0;i<e.length;i++,s+=8)r[s>>>5]|=e[i]<<24-s%32;return r},wordsToBytes:function(e){for(var r=[],i=0;i<e.length*32;i+=8)r.push(e[i>>>5]>>>24-i%32&255);return r},bytesToHex:function(e){for(var r=[],i=0;i<e.length;i++)r.push((e[i]>>>4).toString(16)),r.push((e[i]&15).toString(16));return r.join("")},hexToBytes:function(e){for(var r=[],i=0;i<e.length;i+=2)r.push(parseInt(e.substr(i,2),16));return r},bytesToBase64:function(e){for(var r=[],i=0;i<e.length;i+=3)for(var s=e[i]<<16|e[i+1]<<8|e[i+2],o=0;o<4;o++)i*8+o*6<=e.length*8?r.push(n.charAt(s>>>6*(3-o)&63)):r.push("=");return r.join("")},base64ToBytes:function(e){e=e.replace(/[^A-Z0-9+\/]/ig,"");for(var r=[],i=0,s=0;i<e.length;s=++i%4)s!=0&&r.push((n.indexOf(e.charAt(i-1))&Math.pow(2,-2*s+8)-1)<<s*2|n.indexOf(e.charAt(i))>>>6-s*2);return r}};Zs.exports=t})();var ei={utf8:{stringToBytes:function(n){return ei.bin.stringToBytes(unescape(encodeURIComponent(n)))},bytesToString:function(n){return decodeURIComponent(escape(ei.bin.bytesToString(n)))}},bin:{stringToBytes:function(n){for(var t=[],e=0;e<n.length;e++)t.push(n.charCodeAt(e)&255);return t},bytesToString:function(n){for(var t=[],e=0;e<n.length;e++)t.push(String.fromCharCode(n[e]));return t.join("")}}},Hs=ei;/*!
 * Determine if an object is a Buffer
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */var Yc=function(n){return n!=null&&(Gs(n)||qc(n)||!!n._isBuffer)};function Gs(n){return!!n.constructor&&typeof n.constructor.isBuffer=="function"&&n.constructor.isBuffer(n)}function qc(n){return typeof n.readFloatLE=="function"&&typeof n.slice=="function"&&Gs(n.slice(0,0))}(function(){var n=Zs.exports,t=Hs.utf8,e=Yc,r=Hs.bin,i=function(s,o){s.constructor==String?o&&o.encoding==="binary"?s=r.stringToBytes(s):s=t.stringToBytes(s):e(s)?s=Array.prototype.slice.call(s,0):!Array.isArray(s)&&s.constructor!==Uint8Array&&(s=s.toString());for(var a=n.bytesToWords(s),h=s.length*8,l=1732584193,c=-271733879,d=-1732584194,g=271733878,f=0;f<a.length;f++)a[f]=(a[f]<<8|a[f]>>>24)&16711935|(a[f]<<24|a[f]>>>8)&4278255360;a[h>>>5]|=128<<h%32,a[(h+64>>>9<<4)+14]=h;for(var p=i._ff,E=i._gg,m=i._hh,v=i._ii,f=0;f<a.length;f+=16){var b=l,w=c,S=d,k=g;l=p(l,c,d,g,a[f+0],7,-680876936),g=p(g,l,c,d,a[f+1],12,-389564586),d=p(d,g,l,c,a[f+2],17,606105819),c=p(c,d,g,l,a[f+3],22,-1044525330),l=p(l,c,d,g,a[f+4],7,-176418897),g=p(g,l,c,d,a[f+5],12,1200080426),d=p(d,g,l,c,a[f+6],17,-1473231341),c=p(c,d,g,l,a[f+7],22,-45705983),l=p(l,c,d,g,a[f+8],7,1770035416),g=p(g,l,c,d,a[f+9],12,-1958414417),d=p(d,g,l,c,a[f+10],17,-42063),c=p(c,d,g,l,a[f+11],22,-1990404162),l=p(l,c,d,g,a[f+12],7,1804603682),g=p(g,l,c,d,a[f+13],12,-40341101),d=p(d,g,l,c,a[f+14],17,-1502002290),c=p(c,d,g,l,a[f+15],22,1236535329),l=E(l,c,d,g,a[f+1],5,-165796510),g=E(g,l,c,d,a[f+6],9,-1069501632),d=E(d,g,l,c,a[f+11],14,643717713),c=E(c,d,g,l,a[f+0],20,-373897302),l=E(l,c,d,g,a[f+5],5,-701558691),g=E(g,l,c,d,a[f+10],9,38016083),d=E(d,g,l,c,a[f+15],14,-660478335),c=E(c,d,g,l,a[f+4],20,-405537848),l=E(l,c,d,g,a[f+9],5,568446438),g=E(g,l,c,d,a[f+14],9,-1019803690),d=E(d,g,l,c,a[f+3],14,-187363961),c=E(c,d,g,l,a[f+8],20,1163531501),l=E(l,c,d,g,a[f+13],5,-1444681467),g=E(g,l,c,d,a[f+2],9,-51403784),d=E(d,g,l,c,a[f+7],14,1735328473),c=E(c,d,g,l,a[f+12],20,-1926607734),l=m(l,c,d,g,a[f+5],4,-378558),g=m(g,l,c,d,a[f+8],11,-2022574463),d=m(d,g,l,c,a[f+11],16,1839030562),c=m(c,d,g,l,a[f+14],23,-35309556),l=m(l,c,d,g,a[f+1],4,-1530992060),g=m(g,l,c,d,a[f+4],11,1272893353),d=m(d,g,l,c,a[f+7],16,-155497632),c=m(c,d,g,l,a[f+10],23,-1094730640),l=m(l,c,d,g,a[f+13],4,681279174),g=m(g,l,c,d,a[f+0],11,-358537222),d=m(d,g,l,c,a[f+3],16,-722521979),c=m(c,d,g,l,a[f+6],23,76029189),l=m(l,c,d,g,a[f+9],4,-640364487),g=m(g,l,c,d,a[f+12],11,-421815835),d=m(d,g,l,c,a[f+15],16,530742520),c=m(c,d,g,l,a[f+2],23,-995338651),l=v(l,c,d,g,a[f+0],6,-198630844),g=v(g,l,c,d,a[f+7],10,1126891415),d=v(d,g,l,c,a[f+14],15,-1416354905),c=v(c,d,g,l,a[f+5],21,-57434055),l=v(l,c,d,g,a[f+12],6,1700485571),g=v(g,l,c,d,a[f+3],10,-1894986606),d=v(d,g,l,c,a[f+10],15,-1051523),c=v(c,d,g,l,a[f+1],21,-2054922799),l=v(l,c,d,g,a[f+8],6,1873313359),g=v(g,l,c,d,a[f+15],10,-30611744),d=v(d,g,l,c,a[f+6],15,-1560198380),c=v(c,d,g,l,a[f+13],21,1309151649),l=v(l,c,d,g,a[f+4],6,-145523070),g=v(g,l,c,d,a[f+11],10,-1120210379),d=v(d,g,l,c,a[f+2],15,718787259),c=v(c,d,g,l,a[f+9],21,-343485551),l=l+b>>>0,c=c+w>>>0,d=d+S>>>0,g=g+k>>>0}return n.endian([l,c,d,g])};i._ff=function(s,o,a,h,l,c,d){var g=s+(o&a|~o&h)+(l>>>0)+d;return(g<<c|g>>>32-c)+o},i._gg=function(s,o,a,h,l,c,d){var g=s+(o&h|a&~h)+(l>>>0)+d;return(g<<c|g>>>32-c)+o},i._hh=function(s,o,a,h,l,c,d){var g=s+(o^a^h)+(l>>>0)+d;return(g<<c|g>>>32-c)+o},i._ii=function(s,o,a,h,l,c,d){var g=s+(a^(o|~h))+(l>>>0)+d;return(g<<c|g>>>32-c)+o},i._blocksize=16,i._digestsize=16,ti.exports=function(s,o){if(s==null)throw new Error("Illegal argument "+s);var a=n.wordsToBytes(i(s,o));return o&&o.asBytes?a:o&&o.asString?r.bytesToString(a):n.bytesToHex(a)}})();const It=class{constructor(t){_(this,"seed",BigInt(0));this.setSeed(t)}static fromLargeFeatureSeed(t,e,r){const i=new It(t),s=i.nextLong(),o=i.nextLong(),a=BigInt(e)*s^BigInt(r)*o^t;return i.setSeed(a),i}static fromLargeFeatureWithSalt(t,e,r,i){const s=BigInt(e)*BigInt("341873128712")+BigInt(r)*BigInt("132897987541")+t+BigInt(i);return new It(s)}fork(){return new It(this.nextLong())}forkPositional(){return new Vs(this.nextLong())}setSeed(t){this.seed=(t^It.MULTIPLIER)&It.MODULUS_MASK}advance(){this.seed=this.seed*It.MULTIPLIER+It.INCREMENT&It.MODULUS_MASK}consume(t){for(let e=0;e<t;e+=1)this.advance()}next(t){this.advance();const e=Number(this.seed>>BigInt(It.MODULUS_BITS-t));return e>2147483647?e-4294967296:e}nextInt(t){if(t===void 0)return this.next(32);if((t&t-1)==0)return Number(BigInt(t)*BigInt(this.next(31))>>BigInt(31));let e,r;for(;(e=this.next(31))-(r=e%t)+(t-1)<0;);return r}nextLong(){return(BigInt(this.next(32))<<BigInt(32))+BigInt(this.next(32))}nextFloat(){return this.next(24)*It.FLOAT_MULTIPLIER}nextDouble(){const t=this.next(30);return this.advance(),t*It.DOUBLE_MULTIPLIER}};let nt=It;_(nt,"MODULUS_BITS",48),_(nt,"MODULUS_MASK",BigInt("281474976710655")),_(nt,"MULTIPLIER",BigInt("25214903917")),_(nt,"INCREMENT",BigInt("11")),_(nt,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),_(nt,"DOUBLE_MULTIPLIER",1/Math.pow(2,30));class Vs{constructor(t){this.seed=t}at(t,e,r){const i=Wr(t,e,r);return new nt(i^this.seed)}fromHashOf(t){const e=ti.exports(t,{asBytes:!0}),r=ir(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]);return new nt(r^this.seed)}seedKey(){return[this.seed,BigInt(0)]}}const J=class{constructor(t){_(this,"seed",[BigInt(0),BigInt(0)]);this.seed=t}static create(t){return new J(J.upgradeSeedTo128bit(t))}static mixStafford13(t){return t=(t^t>>J.BIGINT_30)*J.STAFFORD_1&J.MAX_ULONG,t=(t^t>>J.BIGINT_27)*J.STAFFORD_2&J.MAX_ULONG,(t^t>>J.BIGINT_31)&J.MAX_ULONG}static upgradeSeedTo128bit(t){t<0&&(t+=J.POW2_60);const e=t^J.SILVER_RATIO_64,r=e+J.GOLDEN_RATIO_64&J.MAX_ULONG;return[J.mixStafford13(e),J.mixStafford13(r)]}static rotateLeft(t,e){return t<<e&J.MAX_ULONG|t>>J.BIGINT_64-e}setSeed(t){this.seed=J.upgradeSeedTo128bit(t)}fork(){return new J([this.next(),this.next()])}forkPositional(){return new $s(this.next(),this.next())}next(){const t=this.seed[0];let e=this.seed[1];const r=J.rotateLeft(t+e&J.MAX_ULONG,J.BIGINT_17)+t&J.MAX_ULONG;return e^=t,this.seed=[J.rotateLeft(t,J.BIGINT_49)^e^e<<J.BIGINT_21&J.MAX_ULONG,J.rotateLeft(e,J.BIGINT_28)],r}nextLong(){let t=this.next();return t>J.POW2_63&&(t-=J.POW2_60),t}consume(t){let e=this.seed[0],r=this.seed[1];for(let i=0;i<t;i+=1)r^=e,e=J.rotateLeft(e,J.BIGINT_49)^r^r<<J.BIGINT_21,r=J.rotateLeft(r,J.BIGINT_28);this.seed=[e,r]}nextBits(t){return this.next()>>BigInt(64-t)}nextInt(t){let e=this.next()&J.MAX_UINT;if(t){const r=BigInt(t);let i=e*r,s=i&J.MAX_UINT;if(s<r){const a=((~r&J.MAX_UINT)+J.BIGINT_1)%r;for(;s<a;)e=this.next()&J.MAX_UINT,i=e*r,s=i&J.MAX_UINT}const o=i>>J.BIGINT_32;return Number(o)}else{let r=Number(e);return r>=2147483648&&(r-=4294967296),r}}nextFloat(){return Number(this.nextBits(24))*J.FLOAT_MULTIPLIER}nextDouble(){return Number(this.nextBits(53))*J.DOUBLE_MULTIPLIER}parityConfigString(){return"seedLo: "+this.seed[0]+", seedHi: "+this.seed[1]}};let W=J;_(W,"SILVER_RATIO_64",BigInt("7640891576956012809")),_(W,"GOLDEN_RATIO_64",BigInt("-7046029254386353131")),_(W,"FLOAT_MULTIPLIER",1/Math.pow(2,24)),_(W,"DOUBLE_MULTIPLIER",11102230246251565e-32),_(W,"BIGINT_1",BigInt(1)),_(W,"BIGINT_17",BigInt(17)),_(W,"BIGINT_21",BigInt(21)),_(W,"BIGINT_27",BigInt(27)),_(W,"BIGINT_28",BigInt(28)),_(W,"BIGINT_30",BigInt(30)),_(W,"BIGINT_31",BigInt(31)),_(W,"BIGINT_32",BigInt(32)),_(W,"BIGINT_49",BigInt(49)),_(W,"BIGINT_64",BigInt(64)),_(W,"STAFFORD_1",BigInt("-4658895280553007687")),_(W,"STAFFORD_2",BigInt("-7723592293110705685")),_(W,"MAX_ULONG",BigInt("0xFFFFFFFFFFFFFFFF")),_(W,"POW2_60",BigInt("0x10000000000000000")),_(W,"POW2_63",BigInt("0x8000000000000000")),_(W,"MAX_UINT",BigInt(4294967295));class $s{constructor(t,e){this.seedLo=t,this.seedHi=e}at(t,e,r){const s=Wr(t,e,r)^this.seedLo;return new W([s,this.seedHi])}fromHashOf(t){const e=ti.exports(t,{asBytes:!0}),r=ir(e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]),i=ir(e[8],e[9],e[10],e[11],e[12],e[13],e[14],e[15]);return new W([r^this.seedLo,i^this.seedHi])}seedKey(){return[this.seedLo,this.seedHi]}}const Vt=class{constructor(t){_(this,"p");_(this,"xo");_(this,"yo");_(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),i=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=i}}sample2D(t,e){let r,i,s;const o=(t+e)*Vt.F2,a=Math.floor(t+o),h=a-(r=(a+(i=Math.floor(e+o)))*Vt.G2),l=t-h;let c,d;l>(s=e-(i-r))?(c=1,d=0):(c=0,d=1);const g=l-c+Vt.G2,f=s-d+Vt.G2,p=l-1+2*Vt.G2,E=s-1+2*Vt.G2,m=a&255,v=i&255,b=this.P(m+this.P(v))%12,w=this.P(m+c+this.P(v+d))%12,S=this.P(m+1+this.P(v+1))%12,k=this.getCornerNoise3D(b,l,s,0,.5),R=this.getCornerNoise3D(w,g,f,0,.5),x=this.getCornerNoise3D(S,p,E,0,.5);return 70*(k+R+x)}sample(t,e,r){const i=(t+e+r)*.3333333333333333,s=Math.floor(t+i),o=Math.floor(e+i),a=Math.floor(r+i),h=(s+o+a)*.16666666666666666,l=t-(s-h),c=e-(o-h),d=r-(a-h);let g,f,p,E,m,v;l>=c?c>=d?(g=1,f=0,p=0,E=1,m=1,v=0):l>=d?(g=1,f=0,p=0,E=1,m=0,v=1):(g=0,f=0,p=1,E=1,m=0,v=1):c<d?(g=0,f=0,p=1,E=0,m=1,v=1):l<d?(g=0,f=1,p=0,E=0,m=1,v=1):(g=0,f=1,p=0,E=1,m=1,v=0);const b=l-g+.16666666666666666,w=c-f+.16666666666666666,S=d-p+.16666666666666666,k=l-E+.3333333333333333,R=c-m+.3333333333333333,x=d-v+.3333333333333333,A=l-.5,B=c-.5,M=d-.5,C=s&255,O=o&255,F=a&255,D=this.P(C+this.P(O+this.P(F)))%12,X=this.P(C+g+this.P(O+f+this.P(F+p)))%12,Q=this.P(C+E+this.P(O+m+this.P(F+v)))%12,rt=this.P(C+1+this.P(O+1+this.P(F+1)))%12,mt=this.getCornerNoise3D(D,l,c,d,.6),j=this.getCornerNoise3D(X,b,w,S,.6),I=this.getCornerNoise3D(Q,k,R,x,.6),y=this.getCornerNoise3D(rt,A,B,M,.6);return 32*(mt+j+I+y)}P(t){return this.p[t&255]}getCornerNoise3D(t,e,r,i,s){let o,a=s-e*e-r*r-i*i;return a<0?o=0:(a*=a,o=a*a*Vt.gradDot(t,e,r,i)),o}static gradDot(t,e,r,i){const s=Vt.GRADIENT[t&15];return s[0]*e+s[1]*r+s[2]*i}};let ht=Vt;_(ht,"GRADIENT",[[1,1,0],[-1,1,0],[1,-1,0],[-1,-1,0],[1,0,1],[-1,0,1],[1,0,-1],[-1,0,-1],[0,1,1],[0,-1,1],[0,1,-1],[0,-1,-1],[1,1,0],[0,-1,1],[-1,1,0],[0,-1,-1]]),_(ht,"F2",.5*(Math.sqrt(3)-1)),_(ht,"G2",(3-Math.sqrt(3))/6);class ni{constructor(t){_(this,"p");_(this,"xo");_(this,"yo");_(this,"zo");this.xo=t.nextDouble()*256,this.yo=t.nextDouble()*256,this.zo=t.nextDouble()*256,this.p=Array(256);for(let e=0;e<256;e+=1)this.p[e]=e>127?e-256:e;for(let e=0;e<256;e+=1){const r=t.nextInt(256-e),i=this.p[e];this.p[e]=this.p[e+r],this.p[e+r]=i}}sample(t,e,r,i=0,s=0){const o=t+this.xo,a=e+this.yo,h=r+this.zo,l=Math.floor(o),c=Math.floor(a),d=Math.floor(h),g=o-l,f=a-c,p=h-d;let E=0;if(i!==0){const m=s>=0&&s<f?s:f;E=Math.floor(m/i+1e-7)*i}return this.sampleAndLerp(l,c,d,g,f-E,p,f)}sampleAndLerp(t,e,r,i,s,o,a){const h=this.P(t),l=this.P(t+1),c=this.P(h+e),d=this.P(h+e+1),g=this.P(l+e),f=this.P(l+e+1),p=ht.gradDot(this.P(c+r),i,s,o),E=ht.gradDot(this.P(g+r),i-1,s,o),m=ht.gradDot(this.P(d+r),i,s-1,o),v=ht.gradDot(this.P(f+r),i-1,s-1,o),b=ht.gradDot(this.P(c+r+1),i,s,o-1),w=ht.gradDot(this.P(g+r+1),i-1,s,o-1),S=ht.gradDot(this.P(d+r+1),i,s-1,o-1),k=ht.gradDot(this.P(f+r+1),i-1,s-1,o-1),R=rr(i),x=rr(a),A=rr(o);return Os(R,x,A,p,E,m,v,b,w,S,k)}P(t){return this.p[t&255]&255}}class gt{constructor(t,e,r){_(this,"noiseLevels");_(this,"amplitudes");_(this,"lowestFreqInputFactor");_(this,"lowestFreqValueFactor");_(this,"maxValue");if(t instanceof W){const i=t.forkPositional();this.noiseLevels=Array(r.length);for(let s=0;s<r.length;s++)if(r[s]!==0){const o=e+s;this.noiseLevels[s]=new ni(i.fromHashOf("octave_"+o))}}else{if(1-e<r.length)throw new Error("Positive octaves are not allowed when using LegacyRandom");this.noiseLevels=Array(r.length);for(let i=-e;i>=0;i-=1)i<r.length&&r[i]!==0?this.noiseLevels[i]=new ni(t):t.consume(262)}this.amplitudes=r,this.lowestFreqInputFactor=Math.pow(2,e),this.lowestFreqValueFactor=Math.pow(2,r.length-1)/(Math.pow(2,r.length)-1),this.maxValue=this.edgeValue(2)}sample(t,e,r,i=0,s=0,o=!1){let a=0,h=this.lowestFreqInputFactor,l=this.lowestFreqValueFactor;for(let c=0;c<this.noiseLevels.length;c+=1){const d=this.noiseLevels[c];d&&(a+=this.amplitudes[c]*l*d.sample(gt.wrap(t*h),o?-d.yo:gt.wrap(e*h),gt.wrap(r*h),i*h,s*h)),h*=2,l/=2}return a}getOctaveNoise(t){return this.noiseLevels[this.noiseLevels.length-1-t]}edgeValue(t){let e=0,r=this.lowestFreqValueFactor;for(let i=0;i<this.noiseLevels.length;i+=1)this.noiseLevels[i]&&(e+=this.amplitudes[i]*t*r),r/=2;return e}static wrap(t){return t-Math.floor(t/33554432+.5)*33554432}}class Ys{constructor(t,e,r,i,s,o){_(this,"minLimitNoise");_(this,"maxLimitNoise");_(this,"mainNoise");_(this,"xzMultiplier");_(this,"yMultiplier");_(this,"maxValue");this.xzScale=e,this.yScale=r,this.xzFactor=i,this.yFactor=s,this.smearScaleMultiplier=o,this.minLimitNoise=new gt(t,-15,[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0]),this.maxLimitNoise=new gt(t,-15,[1,1,1,1,1,1,1,1,1,0,0,0,0,0,0,0]),this.mainNoise=new gt(t,-7,[1,1,1,1,1,0,0,0]),this.xzMultiplier=684.412*e,this.yMultiplier=684.412*r,this.maxValue=this.minLimitNoise.edgeValue(this.yScale+2)}sample(t,e,r){const i=t*this.xzMultiplier,s=e*this.yMultiplier,o=r*this.xzMultiplier,a=i/this.xzFactor,h=s/this.yFactor,l=o/this.xzFactor,c=this.yMultiplier*this.smearScaleMultiplier,d=c/this.yFactor;let g,f=0,p=1;for(let v=0;v<8;v+=1){if(g=this.mainNoise.getOctaveNoise(v),g){const b=gt.wrap(a*p),w=gt.wrap(h*p),S=gt.wrap(l*p);f+=g.sample(b,w,S,d*p,h*p)/p}p/=2}f=(f/10+1)/2,p=1;let E=0,m=0;for(let v=0;v<16;v+=1){const b=gt.wrap(i*p),w=gt.wrap(s*p),S=gt.wrap(o*p),k=c*p;f<1&&(g=this.minLimitNoise.getOctaveNoise(v))&&(E+=g.sample(b,w,S,k,s*p)/p),f>0&&(g=this.maxLimitNoise.getOctaveNoise(v))&&(m+=g.sample(b,w,S,k,s*p)/p),p/=2}return nr(E/512,m/512,f)/128}}const On=class{constructor(t,{firstOctave:e,amplitudes:r}){_(this,"valueFactor");_(this,"first");_(this,"second");_(this,"maxValue");this.first=new gt(t,e,r),this.second=new gt(t,e,r);let i=1/0,s=-1/0;for(let a=0;a<r.length;a+=1)r[a]!==0&&(i=Math.min(i,a),s=Math.max(s,a));const o=.1*(1+1/(s-i+1));this.valueFactor=1/6/o,this.maxValue=(this.first.maxValue+this.second.maxValue)*this.valueFactor}sample(t,e,r){const i=t*On.INPUT_FACTOR,s=e*On.INPUT_FACTOR,o=r*On.INPUT_FACTOR;return(this.first.sample(t,e,r)+this.second.sample(i,s,o))*this.valueFactor}};let ne=On;_(ne,"INPUT_FACTOR",1.0181268882175227),u.NoiseParameters=void 0,(n=>{function t(r,i){return{firstOctave:r,amplitudes:i}}n.create=t;function e(r){var s,o,a;const i=(s=u.Json.readObject(r))!=null?s:{};return{firstOctave:(o=u.Json.readInt(i.firstOctave))!=null?o:0,amplitudes:(a=u.Json.readArray(i.amplitudes,h=>{var l;return(l=u.Json.readNumber(h))!=null?l:0}))!=null?a:[]}}n.fromJson=e})(u.NoiseParameters||(u.NoiseParameters={}));class Wc{constructor(t,e){_(this,"noiseLevels");_(this,"highestFreqInputFactor");_(this,"highestFreqValueFactor");const r=e[e.length-1],s=-e[0]+r+1,o=new Set(e),a=new ht(t);this.noiseLevels=Array(s),r>=0&&r<s&&o.has(0)&&(this.noiseLevels[r]=a);for(let h=r+1;h<s;h+=1)h>=0&&o.has(r-h)?this.noiseLevels[h]=new ht(t):t.consume(262);if(r>0)throw new Error("Positive octaves are not allowed");this.highestFreqInputFactor=Math.pow(2,r),this.highestFreqValueFactor=1/(Math.pow(2,s)-1)}sample(t,e,r){let i=0,s=this.highestFreqInputFactor,o=this.highestFreqValueFactor;for(let a=0;a<this.noiseLevels.length;a+=1){const h=this.noiseLevels[a];h&&(i+=o*h.sample2D(t*s+(r?h.xo:0),e*s+(r?h.yo:0))),s/=2,o*=2}return i}}const re=[124/255,189/255,107/255],Xc=dt(6396257),jc=dt(8431445),Xe=dt(4764952),cr=dt(4159204),qs=dt(8431445),Kc=dt(2129968),Qc=n=>{const t=n/15,e=t*.6+(t>0?.4:.3),r=ve(t*t*.7-.5,0,1),i=ve(t*t*.6-.7,0,1);return[e,r,i]},Ws=n=>[n/8,1-n/32,n*64],_e={large_fern:()=>re,tall_grass:()=>re,grass_block:()=>re,fern:()=>re,grass:()=>re,short_grass:()=>re,potted_fern:()=>re,pink_petals:()=>re,spruce_leaves:()=>Xc,birch_leaves:()=>jc,oak_leaves:()=>Xe,jungle_leaves:()=>Xe,acacia_leaves:()=>Xe,dark_oak_leaves:()=>Xe,vine:()=>Xe,mangrove_leaves:()=>Xe,water:()=>cr,bubble_column:()=>cr,cauldron:()=>cr,water_cauldron:()=>cr,redstone_wire:n=>{var t;return Qc(parseInt((t=n.power)!=null?t:"0"))},sugar_cane:()=>re,attached_melon_stem:()=>qs,attached_pumpkin_stem:()=>qs,melon_stem:n=>{var t;return Ws(parseInt((t=n.age)!=null?t:"0"))},pumpkin_stem:n=>{var t;return Ws(parseInt((t=n.age)!=null?t:"0"))},lily_pad:()=>Kc};u.Cull=void 0,(n=>{function t(r,i,s){let{up:o,down:a,north:h,east:l,south:c,west:d}=r;switch(s){case 90:[h,l,c,d]=[l,c,d,h];break;case 180:[h,l,c,d]=[c,d,h,l];break;case 270:[h,l,c,d]=[d,h,l,c]}switch(i){case 90:[o,h,a,c]=[h,a,c,o];break;case 180:[o,h,a,c]=[a,c,o,h];break;case 270:[o,h,a,c]=[c,o,h,a]}return{up:o,down:a,north:h,east:l,south:c,west:d}}n.rotate=t;function e(){return Object.create(null)}n.none=e})(u.Cull||(u.Cull={}));const Pt=class{constructor(t,e,r,i,s){this.pos=t,this.color=e,this.texture=r,this.normal=i,this.blockPos=s}transform(t){return Pt.VEC[0]=this.pos.x,Pt.VEC[1]=this.pos.y,Pt.VEC[2]=this.pos.z,Vc(Pt.VEC,Pt.VEC,t),this.pos=new U(Pt.VEC[0],Pt.VEC[1],Pt.VEC[2]),this}static fromPos(t){return new Pt(t,[0,0,0],[0,0],void 0,void 0)}};let Mt=Pt;_(Mt,"VEC",Qr());class ur{constructor(t,e){this.v1=t,this.v2=e}vertices(){return[this.v1,this.v2]}forEach(t){return t(this.v1),t(this.v2),this}transform(t){return this.forEach(e=>e.transform(t)),this}setColor(t){return this.forEach(e=>e.color=t),this}toString(){return`Line(${this.v1.pos.toString()}, ${this.v2.pos.toString()})`}static fromPoints(t,e){return new ur(Mt.fromPos(t),Mt.fromPos(e))}}class ft{constructor(t=[],e=[]){_(this,"posBuffer");_(this,"colorBuffer");_(this,"textureBuffer");_(this,"normalBuffer");_(this,"blockPosBuffer");_(this,"indexBuffer");_(this,"linePosBuffer");_(this,"lineColorBuffer");this.quads=t,this.lines=e}clear(){return this.quads=[],this.lines=[],this}isEmpty(){return this.quads.length===0&&this.lines.length===0}quadVertices(){return this.quads.length*4}quadIndices(){return this.quads.length*6}lineVertices(){return this.lines.length*2}merge(t){return this.quads=this.quads.concat(t.quads),this.lines=this.lines.concat(t.lines),this}addLine(t,e,r,i,s,o,a){const h=new ur(Mt.fromPos(new U(t,e,r)),Mt.fromPos(new U(i,s,o))).setColor(a);return this.lines.push(h),this}addLineCube(t,e,r,i,s,o,a){return this.addLine(t,e,r,t,e,o,a),this.addLine(i,e,r,i,e,o,a),this.addLine(t,e,r,i,e,r,a),this.addLine(t,e,o,i,e,o,a),this.addLine(t,e,r,t,s,r,a),this.addLine(i,e,r,i,s,r,a),this.addLine(t,e,o,t,s,o,a),this.addLine(i,e,o,i,s,o,a),this.addLine(t,s,r,t,s,o,a),this.addLine(i,s,r,i,s,o,a),this.addLine(t,s,r,i,s,r,a),this.addLine(t,s,o,i,s,o,a),this}transform(t){for(const e of this.quads)e.transform(t);return this}computeNormals(){for(const t of this.quads){const e=t.normal();t.forEach(r=>r.normal=e)}}rebuild(t,e){const r=(s,o,a)=>{var h;if(s||(s=(h=t.createBuffer())!=null?h:void 0),!s)throw new Error("Cannot create new buffer");return t.bindBuffer(o,s),t.bufferData(o,a,t.DYNAMIC_DRAW),s},i=(s,o,a)=>{if(s.length===0){o&&t.deleteBuffer(o);return}const h=s.flatMap(l=>l.vertices().flatMap(c=>{const d=a(c);if(!d)throw new Error("Missing vertex component");return d}));return r(o,t.ARRAY_BUFFER,new Float32Array(h))};return e.pos&&(this.posBuffer=i(this.quads,this.posBuffer,s=>s.pos.components()),this.linePosBuffer=i(this.lines,this.linePosBuffer,s=>s.pos.components())),e.color&&(this.colorBuffer=i(this.quads,this.colorBuffer,s=>s.color),this.lineColorBuffer=i(this.lines,this.lineColorBuffer,s=>s.color)),e.texture&&(this.textureBuffer=i(this.quads,this.textureBuffer,s=>s.texture)),e.normal&&(this.normalBuffer=i(this.quads,this.normalBuffer,s=>{var o;return(o=s.normal)==null?void 0:o.components()})),e.blockPos&&(this.blockPosBuffer=i(this.quads,this.blockPosBuffer,s=>{var o;return(o=s.blockPos)==null?void 0:o.components()})),this.quads.length===0?(this.indexBuffer&&t.deleteBuffer(this.indexBuffer),this.indexBuffer=void 0):this.indexBuffer=r(this.indexBuffer,t.ELEMENT_ARRAY_BUFFER,new Uint16Array(this.quads.flatMap((s,o)=>[4*o,4*o+1,4*o+2,o*4,4*o+2,4*o+3],!0))),this}}class ri{constructor(t,e){this.variants=t,this.multipart=e}getModelVariants(t){if(this.variants){const e=Object.keys(this.variants).filter(i=>this.matchesVariant(i,t));if(e.length===0)return[];const r=this.variants[e[0]];return[Array.isArray(r)?r[0]:r]}else if(this.multipart)return this.multipart.filter(r=>r.when?this.matchesCase(r.when,t):!0).map(r=>Array.isArray(r.apply)?r.apply[0]:r.apply);return[]}getMesh(t,e,r,i,s){var l,c,d,g,f;const o=this.getModelVariants(e),a=new ft;for(const p of o){const E=u.Cull.rotate(s,(l=p.x)!=null?l:0,(c=p.y)!=null?c:0),m=i.getBlockModel(N.parse(p.model));if(!m)throw new Error(`Cannot find block model ${p.model}`);const v=t?(d=_e[t.path])==null?void 0:d.call(_e,e):void 0,b=m.getMesh(r,E,v);if(p.x||p.y){const w=K();G(w,w,[8,8,8]),bt(w,w,-jr((g=p.y)!=null?g:0)),Nn(w,w,-jr((f=p.x)!=null?f:0)),G(w,w,[-8,-8,-8]),b.transform(w)}a.merge(b)}const h=K();return At(h,h,[.0625,.0625,.0625]),a.transform(h)}matchesVariant(t,e){return t.split(",").every(r=>{const[i,s]=r.split("=");return e[i]===s})}matchesCase(t,e){if(Array.isArray(t.OR))return t.OR.some(i=>this.matchesCase(i,e));const r=t;return Object.keys(r).every(i=>r[i].split("|").includes(e[i]))}static fromJson(t){return new ri(t.variants,t.multipart)}}class Gt{constructor(t,e,r,i){this.v1=t,this.v2=e,this.v3=r,this.v4=i}vertices(){return[this.v1,this.v2,this.v3,this.v4]}forEach(t){return t(this.v1),t(this.v2),t(this.v3),t(this.v4),this}transform(t){return this.forEach(e=>e.transform(t)),this}normal(){const t=this.v2.pos.sub(this.v1.pos),e=this.v3.pos.sub(this.v1.pos);return t.cross(e).normalize()}reverse(){return[this.v1,this.v2,this.v3,this.v4]=[this.v4,this.v3,this.v2,this.v1],this}setColor(t){return this.forEach(e=>e.color=t),this}setTexture(t){return this.v1.texture=[t[0],t[1]],this.v2.texture=[t[2],t[3]],this.v3.texture=[t[4],t[5]],this.v4.texture=[t[6],t[7]],this}toString(){return`Quad(${this.v1.pos.toString()}, ${this.v2.pos.toString()}, ${this.v3.pos.toString()}, ${this.v4.pos.toString()})`}static fromPoints(t,e,r,i){return new Gt(Mt.fromPos(t),Mt.fromPos(e),Mt.fromPos(r),Mt.fromPos(i))}}const tu={0:[0,3,2,3,2,1,0,1],90:[2,3,2,1,0,1,0,3],180:[2,1,0,1,0,3,2,3],270:[0,1,0,3,2,3,2,1]},eu={x:[1,0,0],y:[0,1,0],z:[0,0,1]},je=1.41421356237,nu={x:[1,je,je],y:[je,1,je],z:[je,je,1]},rn=class{constructor(t,e,r,i,s){_(this,"generationMarker",!1);_(this,"uvEpsilon",1/16);this.parent=t,this.textures=e,this.elements=r,this.display=i,this.guiLight=s}getDisplayTransform(t){var i;const e=(i=this.display)==null?void 0:i[t],r=K();return G(r,r,[8,8,8]),e!=null&&e.translation&&G(r,r,e.translation),e!=null&&e.rotation&&(Nn(r,r,e.rotation[0]*Math.PI/180),bt(r,r,e.rotation[1]*Math.PI/180),Us(r,r,-e.rotation[2]*Math.PI/180)),e!=null&&e.scale&&At(r,r,e.scale),G(r,r,[-8,-8,-8]),r}getMesh(t,e,r){var o;const i=new ft,s=a=>r===void 0?[1,1,1]:a===void 0||a<0?[1,1,1]:typeof r=="function"?r(a):r;for(const a of(o=this.elements)!=null?o:[])i.merge(this.getElementMesh(a,t,e,s));return i}getElementMesh(t,e,r,i){var p,E,m,v,b,w,S,k,R,x,A,B;const s=new ft,[o,a,h]=t.from,[l,c,d]=t.to,g=(M,C,O)=>{var z,q,Ot,zt,Bt,at,ot,lt,Ie;const F=Gt.fromPoints(new U(O[0],O[1],O[2]),new U(O[3],O[4],O[5]),new U(O[6],O[7],O[8]),new U(O[9],O[10],O[11])),D=i(M.tintindex);F.setColor(D);const[X,Q,rt,mt]=e.getTextureUV(this.getTexture(M.texture)),j=(rt-X)/16,I=(mt-Q)/16,y=j*this.uvEpsilon,T=I*this.uvEpsilon;C[0]=((q=(z=M.uv)==null?void 0:z[0])!=null?q:C[0])*j+y,C[1]=((zt=(Ot=M.uv)==null?void 0:Ot[1])!=null?zt:C[1])*I+T,C[2]=((at=(Bt=M.uv)==null?void 0:Bt[2])!=null?at:C[2])*j-y,C[3]=((lt=(ot=M.uv)==null?void 0:ot[3])!=null?lt:C[3])*I-T;const P=tu[(Ie=M.rotation)!=null?Ie:0];F.setTexture([X+C[P[0]],Q+C[P[1]],X+C[P[2]],Q+C[P[3]],X+C[P[4]],Q+C[P[5]],X+C[P[6]],Q+C[P[7]]]),s.quads.push(F)};((E=(p=t.faces)==null?void 0:p.up)==null?void 0:E.texture)&&(!t.faces.up.cullface||!r[t.faces.up.cullface])&&g(t.faces.up,[o,16-d,l,16-h],[o,c,d,l,c,d,l,c,h,o,c,h]),((v=(m=t.faces)==null?void 0:m.down)==null?void 0:v.texture)&&(!t.faces.down.cullface||!r[t.faces.down.cullface])&&g(t.faces.down,[16-d,16-l,16-h,16-o],[o,a,h,l,a,h,l,a,d,o,a,d]),((w=(b=t.faces)==null?void 0:b.south)==null?void 0:w.texture)&&(!t.faces.south.cullface||!r[t.faces.south.cullface])&&g(t.faces.south,[o,16-c,l,16-a],[o,a,d,l,a,d,l,c,d,o,c,d]),((k=(S=t.faces)==null?void 0:S.north)==null?void 0:k.texture)&&(!t.faces.north.cullface||!r[t.faces.north.cullface])&&g(t.faces.north,[16-l,16-c,16-o,16-a],[l,a,h,o,a,h,o,c,h,l,c,h]),((x=(R=t.faces)==null?void 0:R.east)==null?void 0:x.texture)&&(!t.faces.east.cullface||!r[t.faces.east.cullface])&&g(t.faces.east,[16-d,16-c,16-h,16-a],[l,a,d,l,a,h,l,c,h,l,c,d]),((B=(A=t.faces)==null?void 0:A.west)==null?void 0:B.texture)&&(!t.faces.west.cullface||!r[t.faces.west.cullface])&&g(t.faces.west,[h,16-c,d,16-a],[o,a,h,o,a,d,o,c,d,o,c,h]);const f=K();if(t.rotation){const M=Hc(...t.rotation.origin);G(f,f,M),Cc(f,f,jr(t.rotation.angle),eu[t.rotation.axis]),t.rotation.rescale&&At(f,f,nu[t.rotation.axis]),Gc(M,M),G(f,f,M)}return s.transform(f)}getTexture(t){var e,r;for(;t.startsWith("#");)t=(r=(e=this.textures)==null?void 0:e[t.slice(1)])!=null?r:"";return N.parse(t)}withUvEpsilon(t){return this.uvEpsilon=t,this}flatten(t){var r,i,s,o;if(!this.parent)return;if(this.parent.equals(rn.BUILTIN_GENERATED)){this.generationMarker=!0;return}const e=this.getParent(t);if(!e){console.warn(`parent ${this.parent} does not exist!`),this.parent=void 0;return}if(e.flatten(t),this.elements||(this.elements=e.elements),this.textures||(this.textures={}),Object.keys((r=e.textures)!=null?r:{}).forEach(a=>{this.textures[a]||(this.textures[a]=e.textures[a])}),this.display||(this.display={}),Object.keys((i=e.display)!=null?i:{}).forEach(a=>{var l;const h=a;this.display[h]?Object.keys((l=e.display[h])!=null?l:{}).forEach(c=>{const d=c;this.display[h][d]||(this.display[h][d]=e.display[h][d])}):this.display[h]=e.display[h]}),this.guiLight||(this.guiLight=e.guiLight),e.generationMarker&&(this.generationMarker=!0),this.generationMarker&&((o=(s=this.elements)==null?void 0:s.length)!=null?o:0)===0)for(let a=0;a<rn.GENERATED_LAYERS.length;a+=1){const h=rn.GENERATED_LAYERS[a];if(!Object.hasOwn(this.textures,h))break;this.elements||(this.elements=[]),this.elements.push({from:[0,0,0],to:[16,16,0],faces:{south:{texture:`#${h}`,tintindex:a}}})}this.parent=void 0}getParent(t){return this.parent?t.getBlockModel(this.parent):null}static fromJson(t){const e=t.parent===void 0?void 0:N.parse(t.parent);return new rn(e,t.textures,t.elements,t.display)}};let et=rn;_(et,"BUILTIN_GENERATED",N.create("builtin/generated")),_(et,"GENERATED_LAYERS",["layer0","layer1","layer2","layer3","layer4"]);function ii(n,t,e,r,i){var o;const s=r.up?16:[14.2,12.5,10.5,9,7,5.3,3.7,1.9,16,16,16,16,16,16,16,16][t];return new et(void 0,{still:`block/${n}_still`,flow:`block/${n}_flow`},[{from:[0,0,0],to:[16,s,16],faces:{up:{texture:"#still",tintindex:i,cullface:u.Direction.UP},down:{texture:"#still",tintindex:i,cullface:u.Direction.DOWN},north:{texture:"#flow",tintindex:i,cullface:u.Direction.NORTH},east:{texture:"#flow",tintindex:i,cullface:u.Direction.EAST},south:{texture:"#flow",tintindex:i,cullface:u.Direction.SOUTH},west:{texture:"#flow",tintindex:i,cullface:u.Direction.WEST}}}]).getMesh(e,r,(o=_e[n])==null?void 0:o.call(_e,{}))}function si(n){return t=>new et(void 0,{0:`entity/chest/${n}`},[{from:[1,0,1],to:[15,10,15],faces:{north:{uv:[10.5,8.25,14,10.75],rotation:180,texture:"#0"},east:{uv:[7,8.25,10.5,10.75],rotation:180,texture:"#0"},south:{uv:[3.5,8.25,7,10.75],rotation:180,texture:"#0"},west:{uv:[0,8.25,3.5,10.75],rotation:180,texture:"#0"},up:{uv:[7,4.75,10.5,8.25],texture:"#0"},down:{uv:[3.5,4.75,7,8.25],texture:"#0"}}},{from:[1,10,1],to:[15,14,15],faces:{north:{uv:[10.5,3.75,14,4.75],rotation:180,texture:"#0"},east:{uv:[7,3.75,10.5,4.75],rotation:180,texture:"#0"},south:{uv:[3.5,3.75,7,4.75],rotation:180,texture:"#0"},west:{uv:[0,3.75,3.5,4.75],rotation:180,texture:"#0"},up:{uv:[7,0,10.5,3.5],texture:"#0"},down:{uv:[3.5,0,7,3.5],texture:"#0"}}},{from:[7,7,0],to:[9,11,2],faces:{north:{uv:[.25,.25,.75,1.25],rotation:180,texture:"#0"},east:{uv:[0,.25,.25,1.25],rotation:180,texture:"#0"},south:{uv:[1,.25,1.5,1.25],rotation:180,texture:"#0"},west:{uv:[.75,.25,1,1.25],rotation:180,texture:"#0"},up:{uv:[.25,0,.75,.25],rotation:180,texture:"#0"},down:{uv:[.75,0,1.25,.25],rotation:180,texture:"#0"}}}]).getMesh(t,u.Cull.none())}function ru(n){return new et(void 0,{0:"entity/decorated_pot/decorated_pot_side",1:"entity/decorated_pot/decorated_pot_base"},[{from:[1,0,1],to:[15,16,15],faces:{north:{uv:[1,0,15,16],texture:"#0"},east:{uv:[1,0,15,16],texture:"#0"},south:{uv:[1,0,15,16],texture:"#0"},west:{uv:[1,0,15,16],texture:"#0"},up:{uv:[0,6.5,7,13.5],texture:"#1"},down:{uv:[7,6.5,14,13.5],texture:"#1"}}},{from:[5,16,5],to:[11,17,11],faces:{north:{uv:[0,5.5,3,6],texture:"#1"},east:{uv:[3,5.5,6,6],texture:"#1"},south:{uv:[6,5.5,9,6],texture:"#1"},west:{uv:[9,5.5,12,6],texture:"#1"}}},{from:[4,17,4],to:[12,20,12],faces:{north:{uv:[0,4,4,5.5],texture:"#1"},east:{uv:[4,4,8,5.5],texture:"#1"},south:{uv:[8,4,12,5.5],texture:"#1"},west:{uv:[12,4,16,5.5],texture:"#1"},up:{uv:[4,0,8,4],texture:"#1"},down:{uv:[8,0,12,4],texture:"#1"}}}]).getMesh(n,u.Cull.none())}function iu(n){return new et(void 0,{0:"entity/shield_base_nopattern"},[{from:[-6,-11,-2],to:[6,11,-1],faces:{north:{uv:[3.5,.25,6.5,5.75],texture:"#0"},east:{uv:[3.25,.25,3.5,5.75],texture:"#0"},south:{uv:[.25,.25,3.25,5.75],texture:"#0"},west:{uv:[0,.25,.25,5.75],texture:"#0"},up:{uv:[.25,0,3.25,.25],texture:"#0"},down:{uv:[3.25,0,6.25,.25],texture:"#0"}}}]).getMesh(n,u.Cull.none())}function Cn(n,t){return e=>new et(void 0,{0:`entity/${n}`},[{from:[4,0,4],to:[12,8,12],faces:{north:{uv:[6,2*t,8,4*t],texture:"#0"},east:{uv:[2,2*t,0,4*t],texture:"#0"},south:{uv:[2,2*t,4,4*t],texture:"#0"},west:{uv:[6,2*t,4,4*t],texture:"#0"},up:{uv:[2,0*t,4,2*t],texture:"#0"},down:{uv:[4,0*t,6,2*t],texture:"#0"}}}]).getMesh(e,u.Cull.none())}function su(n){const t=K();return G(t,t,[8,8,8]),At(t,t,[.75,.75,.75]),bt(t,t,Math.PI),G(t,t,[-8,-11.2,-8]),new et(void 0,{0:"entity/enderdragon/dragon"},[{from:[2,4,-16],to:[14,9,0],faces:{north:{uv:[12,3.75,12.75,4.0625],texture:"#0"},east:{uv:[11,3.75,12,4.0625],texture:"#0"},south:{uv:[13.75,3.75,14.5,4.0625],texture:"#0"},west:{uv:[12.75,3.75,13.75,4.0625],texture:"#0"},up:{uv:[12.75,3.75,12,2.75],texture:"#0"},down:{uv:[13.5,2.75,12.75,3.75],texture:"#0"}}},{from:[0,0,-2],to:[16,16,14],faces:{north:{uv:[8,2.875,9,3.875],texture:"#0"},east:{uv:[7,2.875,8,3.875],texture:"#0"},south:{uv:[10,2.875,11,3.875],texture:"#0"},west:{uv:[9,2.875,10,3.875],texture:"#0"},up:{uv:[9,2.875,8,1.875],texture:"#0"},down:{uv:[10,1.875,9,2.875],texture:"#0"}}},{from:[2,0,-16],to:[14,4,0],rotation:{angle:-.2*180/Math.PI,axis:"x",origin:[8,4,-2]},faces:{north:{uv:[12,5.0625,12.75,5.3125],texture:"#0"},east:{uv:[11,5.0625,12,5.3125],texture:"#0"},south:{uv:[13.75,5.0625,14.5,5.3125],texture:"#0"},west:{uv:[12.75,5.0625,13.75,5.3125],texture:"#0"},up:{uv:[12.75,5.0625,12,4.0625],texture:"#0"},down:{uv:[13.5,4.0625,12.75,5.0625],texture:"#0"}}},{from:[3,16,4],to:[5,20,10],faces:{north:{uv:[.375,.375,.5,.625],texture:"#0"},east:{uv:[0,.375,.375,.625],texture:"#0"},south:{uv:[.875,.375,1,.625],texture:"#0"},west:{uv:[.5,.375,.875,.625],texture:"#0"},up:{uv:[.5,.375,.375,0],texture:"#0"},down:{uv:[.625,0,.5,.375],texture:"#0"}}},{from:[11,16,4],to:[13,20,10],faces:{north:{uv:[.375,.375,.5,.625],texture:"#0"},east:{uv:[0,.375,.375,.625],texture:"#0"},south:{uv:[.875,.375,1,.625],texture:"#0"},west:{uv:[.5,.375,.875,.625],texture:"#0"},up:{uv:[.5,.375,.375,0],texture:"#0"},down:{uv:[.625,0,.5,.375],texture:"#0"}}},{from:[3,9,-14],to:[5,11,-10],faces:{north:{uv:[7.25,.25,7.375,.375],texture:"#0"},east:{uv:[7,.25,7.25,.375],texture:"#0"},south:{uv:[7.625,.25,7.75,.375],texture:"#0"},west:{uv:[7.375,.25,7.625,.375],texture:"#0"},up:{uv:[7.375,.25,7.25,0],texture:"#0"},down:{uv:[7.5,0,7.375,.25],texture:"#0"}}},{from:[11,9,-14],to:[13,11,-10],faces:{north:{uv:[7.25,.25,7.375,.375],texture:"#0"},east:{uv:[7,.25,7.25,.375],texture:"#0"},south:{uv:[7.625,.25,7.75,.375],texture:"#0"},west:{uv:[7.375,.25,7.625,.375],texture:"#0"},up:{uv:[7.375,.25,7.25,0],texture:"#0"},down:{uv:[7.5,0,7.375,.25],texture:"#0"}}}]).withUvEpsilon(1/256).getMesh(n,u.Cull.none()).transform(t)}function au(n){return new et(void 0,{0:"entity/piglin/piglin"},[{from:[3,0,4],to:[13,8,12],faces:{north:{uv:[6.5,2,9,4],texture:"#0"},east:{uv:[2,2,0,4],texture:"#0"},south:{uv:[2,2,4.5,4],texture:"#0"},west:{uv:[6.5,2,4.5,4],texture:"#0"},up:{uv:[2,0,4.5,2],texture:"#0"},down:{uv:[4.5,0,7,2],texture:"#0"}}},{from:[6,0,12],to:[10,4,13],faces:{north:{uv:[9.25,.5,10.25,1.5],texture:"#0"},east:{uv:[7.75,.5,8,1.5],texture:"#0"},south:{uv:[8,.5,9,1.5],texture:"#0"},west:{uv:[9,.5,9.25,1.5],texture:"#0"},up:{uv:[8,.25,9,.5],texture:"#0"},down:{uv:[9,.25,10,.5],texture:"#0"}}},{from:[5,0,12],to:[6,2,13],faces:{north:{uv:[1.25,.25,1.5,.75],texture:"#0"},east:{uv:[.5,.25,.75,.75],texture:"#0"},south:{uv:[.75,.25,1,.75],texture:"#0"},west:{uv:[1,.25,1.25,.75],texture:"#0"},up:{uv:[.75,0,1,.25],texture:"#0"},down:{uv:[1,0,1.25,.25],texture:"#0"}}},{from:[10,0,12],to:[11,2,13],faces:{north:{uv:[1.25,1.25,1.5,1.75],texture:"#0"},east:{uv:[.5,1.25,.75,1.75],texture:"#0"},south:{uv:[.75,1.25,1,1.75],texture:"#0"},west:{uv:[1,1.25,1.25,1.75],texture:"#0"},up:{uv:[.75,1,1,1.25],texture:"#0"},down:{uv:[1,1,1.25,1.25],texture:"#0"}}},{from:[2.5,1.5,6],to:[3.5,6.5,10],rotation:{angle:-30,axis:"z",origin:[3,7,8]},faces:{north:{uv:[12,2.5,12.25,3.75],texture:"#0"},east:{uv:[9.75,2.5,10.75,3.75],texture:"#0"},south:{uv:[10.75,2.5,11,3.75],texture:"#0"},west:{uv:[11,2.5,12,3.75],texture:"#0"},up:{uv:[10.75,1.5,11,2.5],texture:"#0"},down:{uv:[11,1.5,11.25,2.5],texture:"#0"}}},{from:[12.5,1.5,6],to:[13.5,6.5,10],rotation:{angle:30,axis:"z",origin:[13,7,8]},faces:{north:{uv:[15.25,2.5,15,3.75],texture:"#0"},east:{uv:[15,2.5,14,3.75],texture:"#0"},south:{uv:[14,2.5,13.75,3.75],texture:"#0"},west:{uv:[13.75,2.5,12.75,3.75],texture:"#0"},up:{uv:[14,1.5,13.75,2.5],texture:"#0"},down:{uv:[14.25,1.5,14,2.5],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(n,u.Cull.none())}function ou(n){return t=>new et(void 0,{0:`entity/signs/${n}`},[{from:[-4,8,7],to:[20,20,9],faces:{north:{uv:[.5,1,6.5,7],texture:"#0"},east:{uv:[0,1,.5,7],texture:"#0"},south:{uv:[7,1,13,7],texture:"#0"},west:{uv:[6.5,1,7,7],texture:"#0"},up:{uv:[6.5,1,.5,0],texture:"#0"},down:{uv:[12.5,0,6.5,1],texture:"#0"}}},{from:[7,-6,7],to:[9,8,9],faces:{north:{uv:[.5,8,1,15],texture:"#0"},east:{uv:[0,8,.5,15],texture:"#0"},south:{uv:[1.5,8,2,15],texture:"#0"},west:{uv:[1,8,1.5,15],texture:"#0"},up:{uv:[1,8,.5,7],texture:"#0"},down:{uv:[1.5,7,1,8],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(t,u.Cull.none())}function lu(n){return t=>new et(void 0,{0:`entity/signs/${n}`},[{from:[-4,4,17],to:[20,16,19],faces:{north:{uv:[.5,1,6.5,7],texture:"#0"},east:{uv:[0,1,.5,7],texture:"#0"},south:{uv:[7,1,13,7],texture:"#0"},west:{uv:[6.5,1,7,7],texture:"#0"},up:{uv:[6.5,1,.5,0],texture:"#0"},down:{uv:[12.5,0,6.5,1],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(t,u.Cull.none())}function cu(n){return(t,e)=>t?new et(void 0,{0:`entity/signs/hanging/${n}`},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[2,10,8],to:[14,16,8],faces:{north:{uv:[3.5,3,6.5,6],texture:"#0"},south:{uv:[3.5,3,6.5,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(e,u.Cull.none()):new et(void 0,{0:`entity/signs/hanging/${n}`},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[1.5,10,8],to:[4.5,16,8],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[3,10,6.5],to:[3,16,9.5],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}},{from:[11.5,10,8],to:[14.5,16,8],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[13,10,6.5],to:[13,16,9.5],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(e,u.Cull.none())}function uu(n){return t=>new et(void 0,{0:`entity/signs/hanging/${n}`},[{from:[1,0,7],to:[15,10,9],faces:{north:{uv:[.5,7,4,12],texture:"#0"},east:{uv:[0,7,.5,12],texture:"#0"},south:{uv:[4.5,7,8,12],texture:"#0"},west:{uv:[4,7,4.5,12],texture:"#0"},up:{uv:[4,7,.5,6],texture:"#0"},down:{uv:[7.5,6,4,7],texture:"#0"}}},{from:[0,14,6],to:[16,16,10],faces:{north:{uv:[1,2,5,3],texture:"#0"},east:{uv:[0,2,1,3],texture:"#0"},south:{uv:[6,2,10,3],texture:"#0"},west:{uv:[5,2,6,3],texture:"#0"},up:{uv:[5,2,1,0],texture:"#0"},down:{uv:[9,0,5,2],texture:"#0"}}},{from:[1.5,10,8],to:[4.5,16,8],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[3,10,6.5],to:[3,16,9.5],rotation:{angle:45,axis:"y",origin:[3,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}},{from:[11.5,10,8],to:[14.5,16,8],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{north:{uv:[0,3,.75,6],texture:"#0"},south:{uv:[0,3,.75,6],texture:"#0"}}},{from:[13,10,6.5],to:[13,16,9.5],rotation:{angle:45,axis:"y",origin:[13,12,8]},faces:{east:{uv:[1.5,3,2.25,6],texture:"#0"},west:{uv:[1.5,3,2.25,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(t,u.Cull.none())}function hu(n){return new et(void 0,{0:"entity/conduit/base"},[{from:[5,5,5],to:[11,11,11],faces:{north:{uv:[3,6,6,12],texture:"#0"},east:{uv:[0,6,3,12],texture:"#0"},south:{uv:[9,6,12,12],texture:"#0"},west:{uv:[6,6,9,12],texture:"#0"},up:{uv:[6,6,3,0],texture:"#0"},down:{uv:[9,0,6,6],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(n,u.Cull.none())}function fu(n){return t=>new et(void 0,{0:`entity/shulker/shulker_${n}`},[{from:[0,0,0],to:[16,8,16],faces:{north:{uv:[4,11,8,13],texture:"#0"},east:{uv:[0,11,4,13],texture:"#0"},south:{uv:[12,11,16,13],texture:"#0"},west:{uv:[8,11,12,13],texture:"#0"},up:{uv:[8,11,4,7],texture:"#0"},down:{uv:[12,7,8,11],texture:"#0"}}},{from:[0,4,0],to:[16,16,16],faces:{north:{uv:[4,4,8,7],texture:"#0"},east:{uv:[0,4,4,7],texture:"#0"},south:{uv:[12,4,16,7],texture:"#0"},west:{uv:[8,4,12,7],texture:"#0"},up:{uv:[8,4,4,0],texture:"#0"},down:{uv:[12,0,8,4],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(t,u.Cull.none())}function du(n){return t=>new et(void 0,{0:"entity/banner_base"},[{from:[-2,-8,9],to:[18,32,10],faces:{north:{uv:[.25,.25,5.25,10.25],texture:"#0"},east:{uv:[0,.25,.25,10.25],texture:"#0"},south:{uv:[5.5,.25,10.5,10.25],texture:"#0"},west:{uv:[5.25,.25,5.5,10.25],texture:"#0"},up:{uv:[5.25,.25,.25,0],texture:"#0"},down:{uv:[10.25,0,5.25,.25],texture:"#0"}}},{from:[7,-12,7],to:[9,30,9],faces:{north:{uv:[11.5,.5,12,11],texture:"#0"},east:{uv:[11,.5,11.5,11],texture:"#0"},south:{uv:[12.5,.5,13,11],texture:"#0"},west:{uv:[12,.5,12.5,11],texture:"#0"},up:{uv:[12,.5,11.5,0],texture:"#0"},down:{uv:[12.5,0,12,.5],texture:"#0"}}},{from:[-2,30,7],to:[18,32,9],faces:{north:{uv:[.5,11,5.5,11.5],texture:"#0"},east:{uv:[0,11,.5,11.5],texture:"#0"},south:{uv:[6,11,11,11.5],texture:"#0"},west:{uv:[5.5,11,6,11.5],texture:"#0"},up:{uv:[5.5,11,.5,10.5],texture:"#0"},down:{uv:[10.5,10.5,5.5,11],texture:"#0"}}}]).getMesh(t,u.Cull.none())}function gu(n){return t=>new et(void 0,{0:"entity/banner_base"},[{from:[-2,-8,-1.5],to:[18,32,-.5],faces:{north:{uv:[.25,.25,5.25,10.25],texture:"#0"},east:{uv:[0,.25,.25,10.25],texture:"#0"},south:{uv:[5.5,.25,10.5,10.25],texture:"#0"},west:{uv:[5.25,.25,5.5,10.25],texture:"#0"},up:{uv:[5.25,.25,.25,0],texture:"#0"},down:{uv:[10.25,0,5.25,.25],texture:"#0"}}},{from:[-2,30,-3.5],to:[18,32,-1.5],faces:{north:{uv:[.5,11,5.5,11.5],texture:"#0"},east:{uv:[0,11,.5,11.5],texture:"#0"},south:{uv:[6,11,11,11.5],texture:"#0"},west:{uv:[5.5,11,6,11.5],texture:"#0"},up:{uv:[5.5,11,.5,10.5],texture:"#0"},down:{uv:[10.5,10.5,5.5,11],texture:"#0"}}}]).getMesh(t,u.Cull.none())}function mu(n){return new et(void 0,{0:"entity/bell/bell_body"},[{from:[5,3,5],to:[11,10,11],faces:{north:{uv:[3,3,6,6.5],texture:"#0"},east:{uv:[0,3,3,6.5],texture:"#0"},south:{uv:[9,3,12,6.5],texture:"#0"},west:{uv:[6,3,9,6.5],texture:"#0"},up:{uv:[6,3,3,0],texture:"#0"},down:{uv:[9,0,6,3],texture:"#0"}}},{from:[4,10,4],to:[12,12,12],faces:{north:{uv:[4,10.5,8,11.5],texture:"#0"},east:{uv:[0,10.5,4,11.5],texture:"#0"},south:{uv:[12,10.5,16,11.5],texture:"#0"},west:{uv:[8,10.5,12,11.5],texture:"#0"},up:{uv:[8,10.5,4,6.5],texture:"#0"},down:{uv:[12,6.5,8,10.5],texture:"#0"}}}]).withUvEpsilon(1/64).getMesh(n,u.Cull.none())}function pu(n){return(t,e)=>t==="foot"?new et(void 0,{0:`entity/bed/${n}`},[{from:[0,3,0],to:[16,9,16],faces:{north:{uv:[5.5,5.5,9.5,7],rotation:180,texture:"#0"},east:{uv:[0,7,1.5,11],rotation:270,texture:"#0"},west:{uv:[5.5,7,7,11],rotation:90,texture:"#0"},up:{uv:[5.5,11,1.5,7],texture:"#0"},down:{uv:[11,7,7,11],texture:"#0"}}},{from:[0,0,0],to:[3,3,3],faces:{north:{uv:[12.5,5.25,13.25,6],texture:"#0"},east:{uv:[14.75,5.25,15.5,6],texture:"#0"},south:{uv:[14,5.25,14.75,6],texture:"#0"},west:{uv:[13.25,5.25,14,6],texture:"#0"},up:{uv:[13.25,4.5,14,5.25],texture:"#0"},down:{uv:[14,4.5,14.75,5.25],texture:"#0"}}},{from:[13,0,0],to:[16,3,3],faces:{north:{uv:[13.25,3.75,14,4.5],texture:"#0"},east:{uv:[12.5,3.75,13.25,4.5],texture:"#0"},south:{uv:[14.75,3.75,15.5,4.5],texture:"#0"},west:{uv:[14,3.75,14.75,4.5],texture:"#0"},up:{uv:[13.25,3,14,3.75],texture:"#0"},down:{uv:[14,3,14.75,3.75],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(e,u.Cull.none()):new et(void 0,{0:`entity/bed/${n}`},[{from:[0,3,0],to:[16,9,16],faces:{east:{uv:[0,1.5,1.5,5.5],rotation:270,texture:"#0"},south:{uv:[1.5,0,5.5,1.5],rotation:180,texture:"#0"},west:{uv:[5.5,1.5,7,5.5],rotation:90,texture:"#0"},up:{uv:[5.5,5.5,1.5,1.5],texture:"#0"},down:{uv:[11,1.5,7,5.5],texture:"#0"}}},{from:[0,0,13],to:[3,3,16],faces:{north:{uv:[14.75,.75,15.5,1.5],texture:"#0"},east:{uv:[14,.75,14.75,1.5],texture:"#0"},south:{uv:[13.25,.75,14,1.5],texture:"#0"},west:{uv:[12.5,.75,13.25,1.5],texture:"#0"},up:{uv:[13.25,0,14,.75],texture:"#0"},down:{uv:[14,0,14.75,.75],texture:"#0"}}},{from:[13,0,13],to:[16,3,16],faces:{north:{uv:[14,2.25,14.75,3],texture:"#0"},east:{uv:[13.25,2.25,14,3],texture:"#0"},south:{uv:[12.5,2.25,13.25,3],texture:"#0"},west:{uv:[14.75,2.25,15.5,3],texture:"#0"},up:{uv:[13.25,1.5,14,2.25],texture:"#0"},down:{uv:[14,1.5,14.75,2.25],texture:"#0"}}}]).withUvEpsilon(1/128).getMesh(e,u.Cull.none())}function be(n,t,e=""){var r;return(r=n.getProperty(t))!=null?r:e}function Ke(n,t,e="0"){var r;return parseInt((r=n.getProperty(t))!=null?r:e)}const wu=new Map(Object.entries({"minecraft:chest":si("normal"),"minecraft:ender_chest":si("ender"),"minecraft:trapped_chest":si("trapped")})),vu=new Map(Object.entries({"minecraft:skeleton_skull":Cn("skeleton/skeleton",2),"minecraft:wither_skeleton_skull":Cn("skeleton/wither_skeleton",2),"minecraft:zombie_head":Cn("zombie/zombie",1),"minecraft:creeper_head":Cn("creeper/creeper",2),"minecraft:dragon_head":su,"minecraft:piglin_head":au,"minecraft:player_head":Cn("player/wide/steve",1)})),hr=["oak","spruce","birch","jungle","acacia","dark_oak","mangrove","cherry","bamboo","crimson","warped"],Xs=new Map(hr.map(n=>[`minecraft:${n}_sign`,ou(n)])),_u=new Map(hr.map(n=>[`minecraft:${n}_wall_sign`,lu(n)])),js=new Map(hr.map(n=>[`minecraft:${n}_hanging_sign`,cu(n)])),bu=new Map(hr.map(n=>[`minecraft:${n}_wall_hanging_sign`,uu(n)])),fr=["white","orange","magenta","light_blue","yellow","lime","pink","gray","light_gray","cyan","purple","blue","brown","green","red","black"],yu=new Map(fr.map(n=>[`minecraft:${n}_shulker_box`,fu(n)])),Ks=new Map(fr.map(n=>[`minecraft:${n}_bed`,pu(n)])),Su=new Map(fr.map(n=>[`minecraft:${n}_banner`,du()])),Eu=new Map(fr.map(n=>[`minecraft:${n}_wall_banner`,gu()]));u.SpecialRenderers=void 0,(n=>{function t(i,s,o){if(i.is("water"))return ii("water",Ke(i,"level"),s,o,0);if(i.is("lava"))return ii("lava",Ke(i,"level"),s,o);const a=new ft,h=wu.get(i.getName().toString());if(h!==void 0){const b=be(i,"facing","south"),w=K();G(w,w,[8,8,8]),bt(w,w,b==="west"?Math.PI/2:b==="south"?Math.PI:b==="east"?Math.PI*3/2:0),G(w,w,[-8,-8,-8]),a.merge(h(s).transform(w))}i.is("decorated_pot")&&a.merge(ru(s));const l=vu.get(i.getName().toString());if(l!==void 0){const b=Ke(i,"rotation")/16*Math.PI*2,w=K();G(w,w,[8,8,8]),bt(w,w,b),G(w,w,[-8,-8,-8]),a.merge(l(s).transform(w))}const c=Xs.get(i.getName().toString());if(c!==void 0){const b=Ke(i,"rotation")/16*Math.PI*2,w=K();G(w,w,[8,8,8]),bt(w,w,b),At(w,w,[2/3,2/3,2/3]),G(w,w,[-8,-8,-8]),a.merge(c(s).transform(w))}const d=_u.get(i.getName().toString());if(d!==void 0){const b=be(i,"facing","south"),w=K();G(w,w,[8,8,8]),bt(w,w,b==="west"?Math.PI/2:b==="south"?Math.PI:b==="east"?Math.PI*3/2:0),At(w,w,[2/3,2/3,2/3]),G(w,w,[-8,-8,-8]),a.merge(d(s).transform(w))}const g=js.get(i.getName().toString());if(g!==void 0){const b=be(i,"attached","false")==="true",w=Ke(i,"rotation")/16*Math.PI*2,S=K();G(S,S,[8,8,8]),bt(S,S,w),At(S,S,[2/3,2/3,2/3]),G(S,S,[-8,-8,-8]),a.merge(g(b,s).transform(S))}const f=bu.get(i.getName().toString());if(f!==void 0){const b=be(i,"facing","south"),w=K();G(w,w,[8,8,8]),bt(w,w,b==="west"?Math.PI/2:b==="south"?Math.PI:b==="east"?Math.PI*3/2:0),G(w,w,[-8,-8,-8]),a.merge(f(s).transform(w))}i.is("conduit")&&a.merge(hu(s));const p=yu.get(i.getName().toString());if(p!==void 0){const b=be(i,"facing","up"),w=K();G(w,w,[8,8,8]),b==="down"?Nn(w,w,Math.PI):b!=="up"&&(bt(w,w,b==="east"?Math.PI/2:b==="north"?Math.PI:b==="west"?Math.PI*3/2:0),Nn(w,w,Math.PI/2)),G(w,w,[-8,-8,-8]),a.merge(p(s).transform(w))}if(i.is("bell")){const b=K();G(b,b,[8,8,8]),At(b,b,[1,-1,-1]),G(b,b,[-8,-8,-8]),a.merge(mu(s).transform(b))}const E=Ks.get(i.getName().toString());if(E!==void 0){const b=be(i,"part","head"),w=be(i,"facing","south"),S=K();G(S,S,[8,8,8]),bt(S,S,w==="east"?Math.PI/2:w==="north"?Math.PI:w==="west"?Math.PI*3/2:0),G(S,S,[-8,-8,-8]),a.merge(E(b,s).transform(S))}const m=Su.get(i.getName().toString());if(m!==void 0){const b=Ke(i,"rotation")/16*Math.PI*2,w=K();G(w,w,[8,24,8]),bt(w,w,b),At(w,w,[2/3,2/3,2/3]),G(w,w,[-8,-24,-8]),a.merge(m(s).transform(w))}const v=Eu.get(i.getName().toString());if(v!==void 0){const b=be(i,"facing","south"),w=K();G(w,w,[8,8,8]),bt(w,w,b==="east"?Math.PI/2:b==="north"?Math.PI:b==="west"?Math.PI*3/2:0),At(w,w,[2/3,2/3,2/3]),G(w,w,[-8,-23.2,-8]),a.merge(v(s).transform(w))}return i.isWaterlogged()&&a.merge(ii("water",0,s,o,0)),a}function e(i,s,o){const a=t(i,s,o),h=K();return At(h,h,[.0625,.0625,.0625]),a.transform(h)}n.getBlockMesh=e;function r(i,s){if(i.is("shield")){const a=iu(s),h=K();return G(h,h,[-3,1,0]),Nn(h,h,-10*Math.PI/180),bt(h,h,-10*Math.PI/180),Us(h,h,-5*Math.PI/180),a.transform(h)}if(Ks.get(i.id.toString())!==void 0){const a=t(new H(i.id,{part:"head"}),s,u.Cull.none()),h=t(new H(i.id,{part:"foot"}),s,u.Cull.none()),l=K();return G(l,l,[0,0,-16]),a.merge(h.transform(l))}return i.is("bell")||Xs.has(i.id.toString())||js.has(i.id.toString())?new ft:t(new H(i.id),s,u.Cull.none())}n.getItemMesh=r})(u.SpecialRenderers||(u.SpecialRenderers={}));class Qs{constructor(t,e,r,i=16){_(this,"chunks",[]);_(this,"chunkSize");this.gl=t,this.structure=e,this.resources=r,this.chunkSize=typeof i=="number"?[i,i,i]:i,this.updateStructureBuffers()}setStructure(t){this.structure=t,this.updateStructureBuffers()}updateStructureBuffers(t){var e,r;if(!!this.structure){t?t.forEach(i=>{const s=this.getChunk(i);s.mesh.clear(),s.transparentMesh.clear()}):this.chunks.forEach(i=>i.forEach(s=>s.forEach(o=>{o.mesh.clear(),o.transparentMesh.clear()})));for(const i of this.structure.getBlocks()){const s=i.state.getName(),o=i.state.getProperties(),a=(e=this.resources.getDefaultBlockProperties(s))!=null?e:{};Object.entries(a).forEach(([c,d])=>{o[c]||(o[c]=d)});const h=[Math.floor(i.pos[0]/this.chunkSize[0]),Math.floor(i.pos[1]/this.chunkSize[1]),Math.floor(i.pos[2]/this.chunkSize[2])];if(t&&!t.some(c=>$c(c,h)))continue;const l=this.getChunk(h);try{const c=this.resources.getBlockDefinition(s),d={up:this.needsCull(i,u.Direction.UP),down:this.needsCull(i,u.Direction.DOWN),west:this.needsCull(i,u.Direction.WEST),east:this.needsCull(i,u.Direction.EAST),north:this.needsCull(i,u.Direction.NORTH),south:this.needsCull(i,u.Direction.SOUTH)},g=new ft;c&&g.merge(c.getMesh(s,o,this.resources,this.resources,d));const f=u.SpecialRenderers.getBlockMesh(i.state,this.resources,d);f.isEmpty()||g.merge(f),g.isEmpty()||(this.finishChunkMesh(g,i.pos),(r=this.resources.getBlockFlags(i.state.getName()))!=null&&r.semi_transparent?l.transparentMesh.merge(g):l.mesh.merge(g))}catch(c){console.error(`Error rendering block ${s}`,c)}}t?t.forEach(i=>{const s=this.getChunk(i);s.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0}),s.transparentMesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})}):this.chunks.forEach(i=>i.forEach(s=>s.forEach(o=>{o.mesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0}),o.transparentMesh.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0,blockPos:!0})})))}}getMeshes(){const t=this.chunks.flatMap(e=>e.flatMap(r=>r.flatMap(i=>i!=null?i:[])));return t.flatMap(e=>e.mesh.isEmpty()?[]:e.mesh).concat(t.flatMap(e=>e.transparentMesh.isEmpty()?[]:e.transparentMesh))}needsCull(t,e){var s;const r=(s=this.structure.getBlock(u.BlockPos.towards(t.pos,e)))==null?void 0:s.state;if(!r)return!1;const i=this.resources.getBlockFlags(r.getName());return t.state.getName().equals(r.getName())&&(i==null?void 0:i.self_culling)?!0:i!=null&&i.opaque?!(e===u.Direction.UP&&t.state.isWaterlogged()):t.state.isWaterlogged()&&r.isWaterlogged()}finishChunkMesh(t,e){const r=K();G(r,r,e),t.transform(r);for(const i of t.quads){const s=i.normal();i.forEach(o=>o.normal=s),i.forEach(o=>o.blockPos=new U(e[0],e[1],e[2]))}}getChunk(t){const e=Math.abs(t[0])*2+(t[0]<0?1:0),r=Math.abs(t[1])*2+(t[1]<0?1:0),i=Math.abs(t[2])*2+(t[2]<0?1:0);return this.chunks[e]||(this.chunks[e]=[]),this.chunks[e][r]||(this.chunks[e][r]=[]),this.chunks[e][r][i]||(this.chunks[e][r][i]={mesh:new ft,transparentMesh:new ft}),this.chunks[e][r][i]}}const ta=new Map;function ea(n){if(n.id.namespace!==N.DEFAULT_NAMESPACE)return[1,1,1];const t=ta.get(n.id.path);return t?t(n):[1,1,1]}function ie(n,t){for(const e of n)ta.set(e,t)}function na(n,t){const e=n.getComponent("dyed_color",r=>r.isCompound()?r.getNumber("rgb"):r.getAsNumber());return dt(e!=null?e:t)}ie(["leather_helmet","leather_chestplate","leather_leggings","leather_boots","leather_horse_armor"],n=>{const t=na(n,-6265536);return e=>e>0?[1,1,1]:t}),ie(["wolf_armor"],n=>{const t=na(n,0);return e=>e!==1?[1,1,1]:t}),ie(["tall_grass","large_fern"],()=>[124/255,189/255,107/255]),ie(["firework_star"],n=>{const t=n.getComponent("firework_explosion",r=>r.isCompound()?r.getIntArray("colors"):new Wt),e=(()=>{if(!t||t.length===0)return dt(9079434);if(t.length===1)return dt(t.get(0).getAsNumber());let[r,i,s]=[0,0,0];for(const o of t.getItems())r+=(o.getAsNumber()&16711680)>>16,i+=(o.getAsNumber()&65280)>>8,s+=(o.getAsNumber()&255)>>0;return r/=t.length,i/=t.length,s/=t.length,[r,i,s]})();return r=>r!==1?[1,1,1]:e}),ie(["potion","splash_potion","lingering_potion","tipped_arrow"],n=>{const t=n.getComponent("potion_contents",u.PotionContents.fromNbt);if(!t)return()=>[1,1,1];const e=u.PotionContents.getColor(t);return r=>r>0?[1,1,1]:e});const Iu=[["allay",56063,44543],["armadillo",11366765,8538184],["axolotl",16499171,10890612],["bat",4996656,986895],["bee",15582019,4400155],["blaze",16167425,16775294],["bogged",9084018,3231003],["breeze",11506911,9529055],["cat",15714446,9794134],["camel",16565097,13341495],["cave_spider",803406,11013646],["chicken",10592673,16711680],["cod",12691306,15058059],["cow",4470310,10592673],["creeper",894731,0],["dolphin",2243405,16382457],["donkey",5457209,8811878],["drowned",9433559,7969893],["elder_guardian",13552826,7632531],["ender_dragon",1842204,14711290],["enderman",1447446,0],["endermite",1447446,7237230],["evoker",9804699,1973274],["fox",14005919,13396256],["frog",13661252,16762748],["ghast",16382457,12369084],["glow_squid",611926,8778172],["goat",10851452,5589310],["guardian",5931634,15826224],["hoglin",13004373,6251620],["horse",12623485,15656192],["husk",7958625,15125652],["iron_golem",14405058,7643954],["llama",12623485,10051392],["magma_cube",3407872,16579584],["mooshroom",10489616,12040119],["mule",1769984,5321501],["ocelot",15720061,5653556],["panda",15198183,1776418],["parrot",894731,16711680],["phantom",4411786,8978176],["pig",15771042,14377823],["piglin",10051392,16380836],["piglin_brute",5843472,16380836],["pillager",5451574,9804699],["polar_bear",15658718,14014157],["pufferfish",16167425,3654642],["rabbit",10051392,7555121],["ravager",7697520,5984329],["salmon",10489616,951412],["sheep",15198183,16758197],["shulker",9725844,5060690],["silverfish",7237230,3158064],["skeleton",12698049,4802889],["skeleton_horse",6842447,15066584],["slime",5349438,8306542],["sniffer",8855049,2468720],["snow_golem",14283506,8496292],["spider",3419431,11013646],["squid",2243405,7375001],["stray",6387319,14543594],["strider",10236982,5065037],["tadpole",7164733,1444352],["trader_llama",15377456,4547222],["tropical_fish",15690005,16775663],["turtle",15198183,44975],["vex",8032420,15265265],["villager",5651507,12422002],["vindicator",9804699,2580065],["wandering_trader",4547222,15377456],["warden",1001033,3790560],["witch",3407872,5349438],["wither",1315860,5075616],["wither_skeleton",1315860,4672845],["wolf",14144467,13545366],["zoglin",13004373,15132390],["zombie",44975,7969893],["zombie_horse",3232308,9945732],["zombie_villager",5651507,7969893],["zombified_piglin",15373203,5009705]];for(const n of Iu)ie([`${n[0]}_spawn_egg`],()=>t=>dt(t===0?n[1]:n[2]));for(const n of["grass_block","short_grass","fern","vine","oak_leaves","spruce_leaves","birch_leaves","jungle_leaves","acacia_leaves","dark_oak_leaves","lily_pad"]){const t=_e[n]({});ie([n],()=>t)}ie(["mangrove_leaves"],()=>dt(9619016)),ie(["filled_map"],n=>{const t=n.getComponent("map_color",r=>r.getAsNumber()),e=dt(t!=null?t:4603950);return r=>r===0?[1,1,1]:e});class Tn{constructor(t,e,r){_(this,"gl");_(this,"program");this.gl=t,this.program=this.initShaderProgram(e,r)}getProgram(){return this.program}initShaderProgram(t,e){const r=this.loadShader(this.gl.VERTEX_SHADER,t),i=this.loadShader(this.gl.FRAGMENT_SHADER,e),s=this.gl.createProgram();if(this.gl.attachShader(s,r),this.gl.attachShader(s,i),this.gl.linkProgram(s),!this.gl.getProgramParameter(s,this.gl.LINK_STATUS))throw new Error(`Unable to link shader program: ${this.gl.getProgramInfoLog(s)}`);return s}loadShader(t,e){const r=this.gl.createShader(t);if(this.gl.shaderSource(r,e),this.gl.compileShader(r),!this.gl.getShaderParameter(r,this.gl.COMPILE_STATUS)){const i=new Error(`Compiling ${t===this.gl.VERTEX_SHADER?"vertex":"fragment"} shader: ${this.gl.getShaderInfoLog(r)}`);throw this.gl.deleteShader(r),i}return r}}const xu=`
  attribute vec4 vertPos;
  attribute vec2 texCoord;
  attribute vec3 vertColor;
  attribute vec3 normal;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec2 vTexCoord;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vTexCoord = texCoord;
    vTintColor = vertColor;
    vLighting = normal.y * 0.2 + abs(normal.z) * 0.1 + 0.8;
  }
`,ku=`
  precision highp float;
  varying highp vec2 vTexCoord;
  varying highp vec3 vTintColor;
  varying highp float vLighting;

  uniform sampler2D sampler;

  void main(void) {
		vec4 texColor = texture2D(sampler, vTexCoord);
		if(texColor.a < 0.01) discard;
		gl_FragColor = vec4(texColor.xyz * vTintColor * vLighting, texColor.a);
  }
`;class dr{constructor(t){_(this,"shaderProgram");_(this,"projMatrix");_(this,"activeShader");this.gl=t,this.shaderProgram=new Tn(t,xu,ku).getProgram(),this.activeShader=this.shaderProgram,this.projMatrix=this.getPerspective(),this.initialize()}setViewport(t,e,r,i){this.gl.viewport(t,e,r,i),this.projMatrix=this.getPerspective()}getPerspective(){const t=70*Math.PI/180,e=this.gl.canvas.clientWidth/this.gl.canvas.clientHeight,r=K();return Pc(r,t,e,.1,500),r}initialize(){this.gl.enable(this.gl.DEPTH_TEST),this.gl.depthFunc(this.gl.LEQUAL),this.gl.enable(this.gl.BLEND),this.gl.blendFunc(this.gl.SRC_ALPHA,this.gl.ONE_MINUS_SRC_ALPHA),this.gl.enable(this.gl.CULL_FACE),this.gl.cullFace(this.gl.BACK)}setShader(t){this.gl.useProgram(t),this.activeShader=t}setVertexAttr(t,e,r){if(r===void 0)throw new Error(`Expected buffer for ${t}`);const i=this.gl.getAttribLocation(this.activeShader,t);this.gl.bindBuffer(this.gl.ARRAY_BUFFER,r),this.gl.vertexAttribPointer(i,e,this.gl.FLOAT,!1,0,0),this.gl.enableVertexAttribArray(i)}setUniform(t,e){const r=this.gl.getUniformLocation(this.activeShader,t);this.gl.uniformMatrix4fv(r,!1,e)}setTexture(t){this.gl.activeTexture(this.gl.TEXTURE0),this.gl.bindTexture(this.gl.TEXTURE_2D,t)}createAtlasTexture(t){const e=this.gl.createTexture();return this.gl.bindTexture(this.gl.TEXTURE_2D,e),this.gl.texImage2D(this.gl.TEXTURE_2D,0,this.gl.RGBA,this.gl.RGBA,this.gl.UNSIGNED_BYTE,t),this.gl.generateMipmap(this.gl.TEXTURE_2D),this.gl.texParameteri(this.gl.TEXTURE_2D,this.gl.TEXTURE_MAG_FILTER,this.gl.NEAREST),e}prepareDraw(t){this.setUniform("mView",t),this.setUniform("mProj",this.projMatrix)}drawMesh(t,e){if(t.quadVertices()>0){if(e.pos&&this.setVertexAttr("vertPos",3,t.posBuffer),e.color&&this.setVertexAttr("vertColor",3,t.colorBuffer),e.texture&&this.setVertexAttr("texCoord",2,t.textureBuffer),e.normal&&this.setVertexAttr("normal",3,t.normalBuffer),e.blockPos&&this.setVertexAttr("blockPos",3,t.blockPosBuffer),!t.indexBuffer)throw new Error("Expected index buffer");this.gl.bindBuffer(this.gl.ELEMENT_ARRAY_BUFFER,t.indexBuffer),this.gl.drawElements(this.gl.TRIANGLES,t.quadIndices(),this.gl.UNSIGNED_SHORT,0)}t.lineVertices()>0&&(e.pos&&this.setVertexAttr("vertPos",3,t.linePosBuffer),e.color&&this.setVertexAttr("vertColor",3,t.lineColorBuffer),this.gl.drawArrays(this.gl.LINES,0,t.lineVertices()))}}class Au extends dr{constructor(e,r,i,s){super(e);_(this,"item");_(this,"mesh");_(this,"tint");_(this,"atlasTexture");this.resources=i,this.item=r instanceof jt?r:new jt(r,1),this.mesh=this.getItemMesh(),this.tint=s==null?void 0:s.tint,this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setItem(e){this.item=e instanceof jt?e:new jt(e,1),this.mesh=this.getItemMesh()}getItemMesh(){const e=this.resources.getBlockModel(this.item.id.withPrefix("item/"));if(!e)throw new Error(`Item model for ${this.item.toString()} does not exist`);let r=this.tint;!r&&this.item.id.namespace===N.DEFAULT_NAMESPACE&&(r=ea(this.item));const i=e.getMesh(this.resources,u.Cull.none(),r),s=u.SpecialRenderers.getItemMesh(this.item,this.resources);return i.merge(s),i.transform(e.getDisplayTransform("gui")),i.computeNormals(),i.rebuild(this.gl,{pos:!0,color:!0,texture:!0,normal:!0}),i}getPerspective(){const e=K();return Oc(e,0,16,0,16,.1,500),e}drawItem(){const e=K();G(e,e,[0,0,-32]),this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture),this.prepareDraw(e),this.drawMesh(this.mesh,{pos:!0,color:!0,texture:!0,normal:!0})}}const Mu=`
  attribute vec4 vertPos;
  attribute vec3 blockPos;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = blockPos / 256.0;
  }
`,Ru=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`,Nu=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,Bu=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class Cu extends dr{constructor(e,r,i,s){var a,h;super(e);_(this,"gridShaderProgram");_(this,"colorShaderProgram");_(this,"gridMesh",new ft);_(this,"outlineMesh",new ft);_(this,"invisibleBlocksMesh",new ft);_(this,"atlasTexture");_(this,"useInvisibleBlocks");_(this,"chunkBuilder");this.structure=r,this.resources=i;const o=(a=s==null?void 0:s.chunkSize)!=null?a:16;this.chunkBuilder=new Qs(e,r,i,o),s!=null&&s.facesPerBuffer&&console.warn("[deepslate renderer warning]: facesPerBuffer option has been removed in favor of chunkSize"),this.useInvisibleBlocks=(h=s==null?void 0:s.useInvisibleBlockBuffer)!=null?h:!0,this.gridShaderProgram=new Tn(e,Nu,Bu).getProgram(),this.colorShaderProgram=new Tn(e,Mu,Ru).getProgram(),this.gridMesh=this.getGridMesh(),this.outlineMesh=this.getOutlineMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh(),this.atlasTexture=this.createAtlasTexture(this.resources.getTextureAtlas())}setStructure(e){this.structure=e,this.chunkBuilder.setStructure(e),this.gridMesh=this.getGridMesh(),this.invisibleBlocksMesh=this.getInvisibleBlocksMesh()}updateStructureBuffers(e){this.chunkBuilder.updateStructureBuffers(e)}getGridMesh(){const[e,r,i]=this.structure.getSize(),s=new ft;s.addLine(0,0,0,e,0,0,[1,0,0]),s.addLine(0,0,0,0,0,i,[0,0,1]);const o=[.8,.8,.8];s.addLine(0,0,0,0,r,0,o),s.addLine(e,0,0,e,r,0,o),s.addLine(0,0,i,0,r,i,o),s.addLine(e,0,i,e,r,i,o),s.addLine(0,r,0,0,r,i,o),s.addLine(e,r,0,e,r,i,o),s.addLine(0,r,0,e,r,0,o),s.addLine(0,r,i,e,r,i,o);for(let a=1;a<=e;a+=1)s.addLine(a,0,0,a,0,i,o);for(let a=1;a<=i;a+=1)s.addLine(0,0,a,e,0,a,o);return s.rebuild(this.gl,{pos:!0,color:!0})}getOutlineMesh(){return new ft().addLineCube(0,0,0,1,1,1,[1,1,1]).rebuild(this.gl,{pos:!0,color:!0})}getInvisibleBlocksMesh(){const e=new ft;if(!this.useInvisibleBlocks)return e;const r=this.structure.getSize();for(let i=0;i<r[0];i+=1)for(let s=0;s<r[1];s+=1)for(let o=0;o<r[2];o+=1){const a=this.structure.getBlock([i,s,o]);a!==void 0&&(a===null?e.addLineCube(i+.4375,s+.4375,o+.4375,i+.5625,s+.5625,o+.5625,[1,.25,.25]):a.state.is(H.AIR)?e.addLineCube(i+.375,s+.375,o+.375,i+.625,s+.625,o+.625,[.5,.5,1]):a.state.is(new H("cave_air"))&&e.addLineCube(i+.375,s+.375,o+.375,i+.625,s+.625,o+.625,[.5,1,.5]))}return e.rebuild(this.gl,{pos:!0,color:!0})}drawGrid(e){this.setShader(this.gridShaderProgram),this.prepareDraw(e),this.drawMesh(this.gridMesh,{pos:!0,color:!0})}drawInvisibleBlocks(e){!this.useInvisibleBlocks||(this.setShader(this.gridShaderProgram),this.prepareDraw(e),this.drawMesh(this.invisibleBlocksMesh,{pos:!0,color:!0}))}drawStructure(e){this.setShader(this.shaderProgram),this.setTexture(this.atlasTexture),this.prepareDraw(e),this.chunkBuilder.getMeshes().forEach(r=>{this.drawMesh(r,{pos:!0,color:!0,texture:!0,normal:!0})})}drawColoredStructure(e){this.setShader(this.colorShaderProgram),this.prepareDraw(e),this.chunkBuilder.getMeshes().forEach(r=>{this.drawMesh(r,{pos:!0,color:!0,normal:!0,blockPos:!0})})}drawOutline(e,r){this.setShader(this.gridShaderProgram);const i=K();Mc(i,e),G(i,i,r),this.prepareDraw(i),this.drawMesh(this.outlineMesh,{pos:!0,color:!0})}}class Ln{constructor(t,e){_(this,"part");if(this.img=t,this.idMap=e,!Xr(t.width)||!Xr(t.height))throw new Error(`Expected texture atlas dimensions to be powers of two, got ${t.width}x${t.height}.`);this.part=16/t.width}getTextureAtlas(){return this.img}getTextureUV(t){var e;return(e=this.idMap[t.toString()])!=null?e:[0,0,this.part,this.part]}static async fromBlobs(t){const e=Math.sqrt(Object.keys(t).length+1),r=Ds(e),i=r*16,s=1/r,o=document.createElement("canvas");o.width=i,o.height=i;const a=o.getContext("2d");this.drawInvalidTexture(a);const h={};let l=1;return await Promise.all(Object.keys(t).map(async c=>{const d=l%r,g=Math.floor(l/r);l+=1,h[c]=[s*d,s*g,s*d+s,s*g+s];const f=await createImageBitmap(t[c]);a.drawImage(f,0,0,16,16,16*d,16*g,16,16)})),new Ln(a.getImageData(0,0,i,i),h)}static empty(){const t=document.createElement("canvas");t.width=16,t.height=16;const e=t.getContext("2d");return Ln.drawInvalidTexture(e),new Ln(e.getImageData(0,0,16,16),{})}static drawInvalidTexture(t){t.fillStyle="black",t.fillRect(0,0,16,16),t.fillStyle="magenta",t.fillRect(0,0,8,8),t.fillRect(8,8,8,8)}}const Tu=`
  attribute vec4 vertPos;
  attribute vec3 vertColor;

  uniform mat4 mView;
  uniform mat4 mProj;

  varying highp vec3 vColor;

  void main(void) {
    gl_Position = mProj * mView * vertPos;
    vColor = vertColor;
  }
`,Lu=`
  precision highp float;
  varying highp vec3 vColor;

  void main(void) {
    gl_FragColor = vec4(vColor, 1.0);
  }
`;class Pu extends dr{constructor(e){super(e);_(this,"voxelShaderProgram");_(this,"voxels",[]);_(this,"quads",[]);_(this,"meshes",[]);this.voxelShaderProgram=new Tn(e,Tu,Lu).getProgram()}setVoxels(e){this.voxels=e,this.quads=this.getQuads(),this.meshes=this.getMeshes()}getQuads(){var i,s,o,a,h,l,c,d,g,f,p,E;const e=new Map;for(const m of this.voxels)_r(e,m.x,new Map,v=>{_r(v,m.y,new Set,b=>{b.add(m.z)})});const r=[];for(const m of this.voxels)(s=(i=e.get(m.x+1))==null?void 0:i.get(m.y))!=null&&s.has(m.z)||r.push(Gt.fromPoints(new U(m.x+1,m.y,m.z),new U(m.x+1,m.y+1,m.z),new U(m.x+1,m.y+1,m.z+1),new U(m.x+1,m.y,m.z+1)).setColor(m.color)),(a=(o=e.get(m.x-1))==null?void 0:o.get(m.y))!=null&&a.has(m.z)||r.push(Gt.fromPoints(new U(m.x,m.y,m.z+1),new U(m.x,m.y+1,m.z+1),new U(m.x,m.y+1,m.z),new U(m.x,m.y,m.z)).setColor(m.color)),(l=(h=e.get(m.x))==null?void 0:h.get(m.y+1))!=null&&l.has(m.z)||r.push(Gt.fromPoints(new U(m.x,m.y+1,m.z+1),new U(m.x+1,m.y+1,m.z+1),new U(m.x+1,m.y+1,m.z),new U(m.x,m.y+1,m.z)).setColor(m.color)),(d=(c=e.get(m.x))==null?void 0:c.get(m.y-1))!=null&&d.has(m.z)||r.push(Gt.fromPoints(new U(m.x,m.y,m.z),new U(m.x+1,m.y,m.z),new U(m.x+1,m.y,m.z+1),new U(m.x,m.y,m.z+1)).setColor(m.color)),(f=(g=e.get(m.x))==null?void 0:g.get(m.y))!=null&&f.has(m.z+1)||r.push(Gt.fromPoints(new U(m.x,m.y,m.z+1),new U(m.x+1,m.y,m.z+1),new U(m.x+1,m.y+1,m.z+1),new U(m.x,m.y+1,m.z+1)).setColor(m.color)),(E=(p=e.get(m.x))==null?void 0:p.get(m.y))!=null&&E.has(m.z-1)||r.push(Gt.fromPoints(new U(m.x,m.y+1,m.z),new U(m.x+1,m.y+1,m.z),new U(m.x+1,m.y,m.z),new U(m.x,m.y,m.z)).setColor(m.color));return console.debug(`Converted ${this.voxels.length} voxels into ${r.length} quads!`),r}getMeshes(){const e=[];let r=new ft;for(const i of this.quads){const s=i.normal(),o=(s.y*.25+Math.abs(s.z)*.125+.75)/256;i.forEach(a=>a.color=[a.color[0]*o,a.color[1]*o,a.color[2]*o]),r.quads.push(i),r.quadVertices()>65e3&&(e.push(r),r=new ft)}r.isEmpty()||e.push(r);for(const i of e)i.rebuild(this.gl,{pos:!0,color:!0});return e}draw(e){if(console.debug(`Drawing ${this.meshes.length} meshes...`),this.setShader(this.voxelShaderProgram),this.prepareDraw(e),this.meshes.length===0){this.gl.clearColor(0,0,0,0),this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT);return}for(const r of this.meshes)this.drawMesh(r,{pos:!0,color:!0})}}u.NoiseRouter=void 0,(n=>{const t=a=>new Z.HolderHolder(u.Holder.parser(u.WorldgenRegistries.DENSITY_FUNCTION,Z.fromJson)(a));function e(a){var l;const h=(l=u.Json.readObject(a))!=null?l:{};return{barrier:t(h.barrier),fluidLevelFloodedness:t(h.fluid_level_floodedness),fluidLevelSpread:t(h.fluid_level_spread),lava:t(h.lava),temperature:t(h.temperature),vegetation:t(h.vegetation),continents:t(h.continents),erosion:t(h.erosion),depth:t(h.depth),ridges:t(h.ridges),initialDensityWithoutJaggedness:t(h.initial_density_without_jaggedness),finalDensity:t(h.final_density),veinToggle:t(h.vein_toggle),veinRidged:t(h.vein_ridged),veinGap:t(h.vein_gap)}}n.fromJson=e;function r(a){return{barrier:Z.Constant.ZERO,fluidLevelFloodedness:Z.Constant.ZERO,fluidLevelSpread:Z.Constant.ZERO,lava:Z.Constant.ZERO,temperature:Z.Constant.ZERO,vegetation:Z.Constant.ZERO,continents:Z.Constant.ZERO,erosion:Z.Constant.ZERO,depth:Z.Constant.ZERO,ridges:Z.Constant.ZERO,initialDensityWithoutJaggedness:Z.Constant.ZERO,finalDensity:Z.Constant.ZERO,veinToggle:Z.Constant.ZERO,veinRidged:Z.Constant.ZERO,veinGap:Z.Constant.ZERO,...a}}n.create=r;function i(a,h){return{barrier:a.barrier.mapAll(h),fluidLevelFloodedness:a.fluidLevelFloodedness.mapAll(h),fluidLevelSpread:a.fluidLevelSpread.mapAll(h),lava:a.lava.mapAll(h),temperature:a.temperature.mapAll(h),vegetation:a.vegetation.mapAll(h),continents:a.continents.mapAll(h),erosion:a.erosion.mapAll(h),depth:a.depth.mapAll(h),ridges:a.ridges.mapAll(h),initialDensityWithoutJaggedness:a.initialDensityWithoutJaggedness.mapAll(h),finalDensity:a.finalDensity.mapAll(h),veinToggle:a.veinToggle.mapAll(h),veinRidged:a.veinRidged.mapAll(h),veinGap:a.veinGap.mapAll(h)}}n.mapAll=i;const s=new Map;function o(a,h){var f;const l=(f=h.key())==null?void 0:f.toString();if(!l)throw new Error("Cannot instantiate noise from direct holder");const c=a.seedKey(),d=s.get(l);if(d&&d[0]===c[0]&&d[1]===c[1])return d[2];const g=new ne(a.fromHashOf(l),h.value());return s.set(l,[c[0],c[1],g]),g}n.instantiate=o})(u.NoiseRouter||(u.NoiseRouter={})),u.NoiseSettings=void 0,(n=>{function t(a){var l,c,d,g,f;const h=(l=u.Json.readObject(a))!=null?l:{};return{minY:(c=u.Json.readInt(h.min_y))!=null?c:0,height:(d=u.Json.readInt(h.height))!=null?d:256,xzSize:(g=u.Json.readInt(h.size_horizontal))!=null?g:1,ySize:(f=u.Json.readInt(h.size_vertical))!=null?f:1}}n.fromJson=t;function e(a){return{minY:0,height:256,xzSize:1,ySize:1,...a}}n.create=e;function r(a){return a.ySize<<2}n.cellHeight=r;function i(a){return a.xzSize<<2}n.cellWidth=i;function s(a){return a.height/r(a)}n.cellCountY=s;function o(a){return Math.floor(a.minY/r(a))}n.minCellY=o})(u.NoiseSettings||(u.NoiseSettings={})),u.NoiseSlideSettings=void 0,(n=>{function t(r){var s,o,a,h;const i=(s=u.Json.readObject(r))!=null?s:{};return{target:(o=u.Json.readNumber(i.target))!=null?o:0,size:(a=u.Json.readInt(i.size))!=null?a:0,offset:(h=u.Json.readInt(i.offset))!=null?h:0}}n.fromJson=t;function e(r,i,s){if(r.size<=0)return i;const o=(s-r.offset)/r.size;return nr(r.target,i,o)}n.apply=e})(u.NoiseSlideSettings||(u.NoiseSlideSettings={})),u.VerticalAnchor=void 0,(n=>{function t(s){var a,h,l,c;const o=(a=u.Json.readObject(s))!=null?a:{};return o.absolute!==void 0?e((h=u.Json.readNumber(o.absolute))!=null?h:0):o.above_bottom!==void 0?r((l=u.Json.readNumber(o.above_bottom))!=null?l:0):o.below_top!==void 0?i((c=u.Json.readNumber(o.below_top))!=null?c:0):()=>0}n.fromJson=t;function e(s){return()=>s}n.absolute=e;function r(s){return o=>o.minY+s}n.aboveBottom=r;function i(s){return o=>o.minY+o.height-1-s}n.belowTop=i})(u.VerticalAnchor||(u.VerticalAnchor={}));class ra{constructor(t,e,r){_(this,"surfaceNoise");_(this,"surfaceSecondaryNoise");_(this,"random");_(this,"positionalRandoms");this.rule=t,this.defaultBlock=e,this.random=W.create(r).forkPositional(),this.surfaceNoise=u.NoiseRouter.instantiate(this.random,u.WorldgenRegistries.SURFACE_NOISE),this.surfaceSecondaryNoise=u.NoiseRouter.instantiate(this.random,u.WorldgenRegistries.SURFACE_SECONDARY_NOISE),this.positionalRandoms=new Map}buildSurface(t,e,r,i){const s=u.ChunkPos.minBlockX(t.pos),o=u.ChunkPos.minBlockZ(t.pos),a=new ia(this,t,e,r,i),h=this.rule(a);for(let l=0;l<16;l+=1){const c=s+l;for(let d=0;d<1;d+=1){const g=o+d;a.updateXZ(c,g);let f=0,p=Number.MIN_SAFE_INTEGER,E=Number.MAX_SAFE_INTEGER;for(let m=t.maxY;m>=t.minY;m-=1){const v=u.BlockPos.create(c,m,g),b=t.getBlockState(v);if(b.equals(H.AIR)){f=0,p=Number.MIN_SAFE_INTEGER;continue}if(b.isFluid()){p===Number.MIN_SAFE_INTEGER&&(p=m+1);continue}if(E>=m){E=Number.MIN_SAFE_INTEGER;for(let k=m-1;k>=t.minY;k-=1){const R=t.getBlockState(u.BlockPos.create(c,k,g));if(R.equals(H.AIR)||R.isFluid()){E=k+1;break}}}f+=1;const w=m-E+1;if(!b.equals(this.defaultBlock))continue;a.updateY(f,w,p,m);const S=h(c,m,g);S&&t.setBlockState(v,S)}}}}getSurfaceDepth(t,e){const r=this.surfaceNoise.sample(t,0,e),i=this.random.at(t,0,e).nextDouble()*.25;return r*2.75+3+i}getSurfaceSecondary(t,e){return this.surfaceSecondaryNoise.sample(t,0,e)}getRandom(t){return ke(this.positionalRandoms,t,()=>this.random.fromHashOf(t))}}class ia{constructor(t,e,r,i,s){_(this,"blockX",0);_(this,"blockY",0);_(this,"blockZ",0);_(this,"stoneDepthAbove",0);_(this,"stoneDepthBelow",0);_(this,"surfaceDepth",0);_(this,"waterHeight",0);_(this,"biome",()=>"");_(this,"surfaceSecondary",()=>0);_(this,"minSurfaceLevel",()=>0);this.system=t,this.chunk=e,this.noiseChunk=r,this.context=i,this.getBiome=s}updateXZ(t,e){this.blockX=t,this.blockZ=e,this.surfaceDepth=this.system.getSurfaceDepth(t,e),this.surfaceSecondary=on(()=>this.system.getSurfaceSecondary(t,e)),this.minSurfaceLevel=on(()=>this.calculateMinSurfaceLevel(t,e))}updateY(t,e,r,i){this.blockY=i,this.stoneDepthAbove=t,this.stoneDepthBelow=e,this.waterHeight=r,this.biome=on(()=>this.getBiome(u.BlockPos.create(this.blockX,this.blockY,this.blockZ)))}calculateMinSurfaceLevel(t,e){const r=t>>4,i=e>>4,s=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,i<<4),o=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,i<<4),a=this.noiseChunk.getPreliminarySurfaceLevel(r<<4,i+1<<4),h=this.noiseChunk.getPreliminarySurfaceLevel(r+1<<4,i+1<<4);return Math.floor(er((t&15)/16,(e&15)/16,s,o,a,h))+this.surfaceDepth-8}}u.SurfaceRule=void 0,(n=>{n.NOOP=()=>()=>{};function t(s){var h,l,c;const o=(h=u.Json.readObject(s))!=null?h:{};switch((l=u.Json.readString(o.type))==null?void 0:l.replace(/^minecraft:/,"")){case"block":return e(H.fromJson(o.result_state));case"sequence":return r((c=u.Json.readArray(o.sequence,n.fromJson))!=null?c:[]);case"condition":return i(u.SurfaceCondition.fromJson(o.if_true),n.fromJson(o.then_run))}return n.NOOP}n.fromJson=t;function e(s){return()=>()=>s}n.block=e;function r(s){return o=>{const a=s.map(h=>h(o));return(h,l,c)=>{for(const d of a){const g=d(h,l,c);if(g)return g}}}}n.sequence=r;function i(s,o){return a=>(h,l,c)=>{if(s(a))return o(a)(h,l,c)}}n.condition=i})(u.SurfaceRule||(u.SurfaceRule={})),u.SurfaceCondition=void 0,(n=>{n.FALSE=()=>!1,n.TRUE=()=>!0;function t(l){var g,f,p,E,m,v,b,w,S,k,R,x;const c=(g=u.Json.readObject(l))!=null?g:{};switch((f=u.Json.readString(c.type))==null?void 0:f.replace(/^minecraft:/,"")){case"above_preliminary_surface":return e();case"biome":return r((p=u.Json.readArray(c.biome_is,A=>{var B;return(B=u.Json.readString(A))!=null?B:""}))!=null?p:[]);case"not":return i(n.fromJson(c.invert));case"stone_depth":return s((E=u.Json.readInt(c.offset))!=null?E:0,(m=u.Json.readBoolean(c.add_surface_depth))!=null?m:!1,(v=u.Json.readInt(c.secondary_depth_range))!=null?v:0,u.Json.readString(c.surface_type)==="ceiling");case"vertical_gradient":return o((b=u.Json.readString(c.random_name))!=null?b:"",u.VerticalAnchor.fromJson(c.true_at_and_below),u.VerticalAnchor.fromJson(c.false_at_and_above));case"water":return a((w=u.Json.readInt(c.offset))!=null?w:0,(S=u.Json.readInt(c.surface_depth_multiplier))!=null?S:0,(k=u.Json.readBoolean(c.add_surface_depth))!=null?k:!1);case"y_above":return h(u.VerticalAnchor.fromJson(c.anchor),(R=u.Json.readInt(c.surface_depth_multiplier))!=null?R:0,(x=u.Json.readBoolean(c.add_surface_depth))!=null?x:!1)}return n.FALSE}n.fromJson=t;function e(){return l=>l.blockY>=l.minSurfaceLevel()}n.abovePreliminarySurface=e;function r(l){const c=new Set(l);return d=>c.has(d.biome())}n.biome=r;function i(l){return c=>!l(c)}n.not=i;function s(l,c,d,g){return f=>{const p=g?f.stoneDepthBelow:f.stoneDepthAbove,E=c?f.surfaceDepth:0,m=d===0?0:Rn(f.surfaceSecondary(),-1,1,0,d);return p<=1+l+E+m}}n.stoneDepth=s;function o(l,c,d){return g=>{const f=c(g.context),p=d(g.context);if(g.blockY<=f)return!0;if(g.blockY>=p)return!1;const E=g.system.getRandom(l),m=Rn(g.blockY,f,p,1,0);return E.nextFloat()<m}}n.verticalGradient=o;function a(l,c,d){return g=>{if(g.waterHeight===Number.MIN_SAFE_INTEGER)return!0;const f=d?g.stoneDepthAbove:0;return g.blockY+f>=g.waterHeight+l+g.surfaceDepth*c}}n.water=a;function h(l,c,d){return g=>{const f=d?g.stoneDepthAbove:0;return g.blockY+f>=l(g.context)+g.surfaceDepth*c}}n.yAbove=h})(u.SurfaceCondition||(u.SurfaceCondition={})),u.NoiseGeneratorSettings=void 0,(n=>{function t(r){var s,o,a,h,l,c;const i=(s=u.Json.readObject(r))!=null?s:{};return{surfaceRule:u.SurfaceRule.fromJson(i.surface_rule),noise:u.NoiseSettings.fromJson(i.noise),defaultBlock:H.fromJson(i.default_block),defaultFluid:H.fromJson(i.default_fluid),noiseRouter:u.NoiseRouter.fromJson(i.noise_router),seaLevel:(o=u.Json.readInt(i.sea_level))!=null?o:0,disableMobGeneration:(a=u.Json.readBoolean(i.disable_mob_generation))!=null?a:!1,aquifersEnabled:(h=u.Json.readBoolean(i.aquifers_enabled))!=null?h:!1,oreVeinsEnabled:(l=u.Json.readBoolean(i.ore_veins_enabled))!=null?l:!1,legacyRandomSource:(c=u.Json.readBoolean(i.legacy_random_source))!=null?c:!1}}n.fromJson=t;function e(r){return{surfaceRule:u.SurfaceRule.NOOP,noise:u.NoiseSettings.create({}),defaultBlock:H.STONE,defaultFluid:H.WATER,noiseRouter:u.NoiseRouter.create({}),seaLevel:0,disableMobGeneration:!1,aquifersEnabled:!1,oreVeinsEnabled:!1,legacyRandomSource:!1,...r}}n.create=e})(u.NoiseGeneratorSettings||(u.NoiseGeneratorSettings={})),u.WorldgenRegistries=void 0,(n=>{n.NOISE=Et.createAndRegister("worldgen/noise",u.NoiseParameters.fromJson),n.DENSITY_FUNCTION=Et.createAndRegister("worldgen/density_function",e=>Z.fromJson(e)),n.NOISE_SETTINGS=Et.createAndRegister("worldgen/noise_settings",u.NoiseGeneratorSettings.fromJson),n.BIOME=Et.createAndRegister("worldgen/biome"),n.SURFACE_NOISE=t("surface",-6,[1,1,1]),n.SURFACE_SECONDARY_NOISE=t("surface_secondary",-6,[1,1,0,1]);function t(e,r,i){return n.NOISE.register(N.create(e),u.NoiseParameters.create(r,i),!0)}})(u.WorldgenRegistries||(u.WorldgenRegistries={}));class Z{minValue(){return-this.maxValue()}mapAll(t){return t.map(this)}}(n=>{function t(j,I,y){return{x:j,y:I,z:y}}n.context=t;class e extends n{constructor(I){super(),this.input=I}compute(I){return this.transform(I,this.input.compute(I))}}const r=u.Holder.parser(u.WorldgenRegistries.NOISE,u.NoiseParameters.fromJson);function i(j,I=i){var P,z,q,Ot,zt,Bt,at,ot,lt,Ie,sn,an,Jn,Dn,oi,li,ci,oa,la,ca;if(typeof j=="string")return new o(u.Holder.reference(u.WorldgenRegistries.DENSITY_FUNCTION,N.parse(j)));if(typeof j=="number")return new s(j);const y=(P=u.Json.readObject(j))!=null?P:{},T=(z=u.Json.readString(y.type))==null?void 0:z.replace(/^minecraft:/,"");switch(T){case"blend_alpha":return new a(1,0,1);case"blend_offset":return new a(0,-1/0,1/0);case"beardifier":return new a(0,-1/0,1/0);case"old_blended_noise":return new h((q=u.Json.readNumber(y.xz_scale))!=null?q:1,(Ot=u.Json.readNumber(y.y_scale))!=null?Ot:1,(zt=u.Json.readNumber(y.xz_factor))!=null?zt:80,(Bt=u.Json.readNumber(y.y_factor))!=null?Bt:160,(at=u.Json.readNumber(y.smear_scale_multiplier))!=null?at:8);case"flat_cache":return new c(I(y.argument));case"interpolated":return new p(I(y.argument));case"cache_2d":return new g(I(y.argument));case"cache_once":return new f(I(y.argument));case"cache_all_in_cell":return new d(I(y.argument));case"noise":return new E((ot=u.Json.readNumber(y.xz_scale))!=null?ot:1,(lt=u.Json.readNumber(y.y_scale))!=null?lt:1,r(y.noise));case"end_islands":return new m;case"weird_scaled_sampler":return new b(I(y.input),u.Json.readEnum(y.rarity_value_mapper,v),r(y.noise));case"shifted_noise":return new w(I(y.shift_x),I(y.shift_y),I(y.shift_z),(Ie=u.Json.readNumber(y.xz_scale))!=null?Ie:1,(sn=u.Json.readNumber(y.y_scale))!=null?sn:1,r(y.noise));case"range_choice":return new S(I(y.input),(an=u.Json.readNumber(y.min_inclusive))!=null?an:0,(Jn=u.Json.readNumber(y.max_exclusive))!=null?Jn:1,I(y.when_in_range),I(y.when_out_of_range));case"shift_a":return new R(r(y.argument));case"shift_b":return new x(r(y.argument));case"shift":return new A(r(y.argument));case"blend_density":return new B(I(y.argument));case"clamp":return new M(I(y.input),(Dn=u.Json.readNumber(y.min))!=null?Dn:0,(oi=u.Json.readNumber(y.max))!=null?oi:1);case"abs":case"square":case"cube":case"half_negative":case"quarter_negative":case"squeeze":return new C(T,I(y.argument));case"add":case"mul":case"min":case"max":return new F(u.Json.readEnum(T,O),I(y.argument1),I(y.argument2));case"spline":return new D(u.CubicSpline.fromJson(y.spline,I));case"constant":return new s((li=u.Json.readNumber(y.argument))!=null?li:0);case"y_clamped_gradient":return new X((ci=u.Json.readInt(y.from_y))!=null?ci:-4064,(oa=u.Json.readInt(y.to_y))!=null?oa:4062,(la=u.Json.readNumber(y.from_value))!=null?la:-4064,(ca=u.Json.readNumber(y.to_value))!=null?ca:4062)}return s.ZERO}n.fromJson=i;const Q=class extends n{constructor(I){super(),this.value=I}compute(){return this.value}minValue(){return this.value}maxValue(){return this.value}};let s=Q;_(s,"ZERO",new Q(0)),_(s,"ONE",new Q(1)),n.Constant=s;class o extends n{constructor(I){super(),this.holder=I}compute(I){return this.holder.value().compute(I)}minValue(){return this.holder.value().minValue()}maxValue(){return this.holder.value().maxValue()}}n.HolderHolder=o;class a extends n.Constant{constructor(I,y,T){super(I),this.min=y,this.max=T}minValue(){return this.min}maxValue(){return this.max}}n.ConstantMinMax=a;class h extends n{constructor(I,y,T,P,z,q){super(),this.xzScale=I,this.yScale=y,this.xzFactor=T,this.yFactor=P,this.smearScaleMultiplier=z,this.blendedNoise=q}compute(I){var y,T;return(T=(y=this.blendedNoise)==null?void 0:y.sample(I.x,I.y,I.z))!=null?T:0}maxValue(){var I,y;return(y=(I=this.blendedNoise)==null?void 0:I.maxValue)!=null?y:0}}n.OldBlendedNoise=h;class l extends n{constructor(I){super(),this.wrapped=I}minValue(){return this.wrapped.minValue()}maxValue(){return this.wrapped.maxValue()}}class c extends l{constructor(y){super(y);_(this,"lastQuartX");_(this,"lastQuartZ");_(this,"lastValue",0)}compute(y){const T=y.x>>2,P=y.z>>2;return(this.lastQuartX!==T||this.lastQuartZ!==P)&&(this.lastValue=this.wrapped.compute(n.context(T<<2,0,P<<2)),this.lastQuartX=T,this.lastQuartZ=P),this.lastValue}mapAll(y){return y.map(new c(this.wrapped.mapAll(y)))}}n.FlatCache=c;class d extends l{constructor(I){super(I)}compute(I){return this.wrapped.compute(I)}mapAll(I){return I.map(new d(this.wrapped.mapAll(I)))}}n.CacheAllInCell=d;class g extends l{constructor(y){super(y);_(this,"lastBlockX");_(this,"lastBlockZ");_(this,"lastValue",0)}compute(y){const T=y.x,P=y.z;return(this.lastBlockX!==T||this.lastBlockZ!==P)&&(this.lastValue=this.wrapped.compute(y),this.lastBlockX=T,this.lastBlockZ=P),this.lastValue}mapAll(y){return y.map(new g(this.wrapped.mapAll(y)))}}n.Cache2D=g;class f extends l{constructor(y){super(y);_(this,"lastBlockX");_(this,"lastBlockY");_(this,"lastBlockZ");_(this,"lastValue",0)}compute(y){const T=y.x,P=y.y,z=y.z;return(this.lastBlockX!==T||this.lastBlockY!==P||this.lastBlockZ!==z)&&(this.lastValue=this.wrapped.compute(y),this.lastBlockX=T,this.lastBlockY=P,this.lastBlockZ=z),this.lastValue}mapAll(y){return y.map(new f(this.wrapped.mapAll(y)))}}n.CacheOnce=f;class p extends l{constructor(y,T=4,P=4){super(y);_(this,"values");this.cellWidth=T,this.cellHeight=P,this.values=new Map}compute({x:y,y:T,z:P}){const z=this.cellWidth,q=this.cellHeight,Ot=(y%z+z)%z/z,zt=(T%q+q)%q/q,Bt=(P%z+z)%z/z,at=Math.floor(y/z)*z,ot=Math.floor(T/q)*q,lt=Math.floor(P/z)*z;return zs(Ot,zt,Bt,()=>this.computeCorner(at,ot,lt),()=>this.computeCorner(at+z,ot,lt),()=>this.computeCorner(at,ot+q,lt),()=>this.computeCorner(at+z,ot+q,lt),()=>this.computeCorner(at,ot,lt+z),()=>this.computeCorner(at+z,ot,lt+z),()=>this.computeCorner(at,ot+q,lt+z),()=>this.computeCorner(at+z,ot+q,lt+z))}computeCorner(y,T,P){return ke(this.values,`${y} ${T} ${P}`,()=>this.wrapped.compute(n.context(y,T,P)))}mapAll(y){return y.map(new p(this.wrapped.mapAll(y)))}withCellSize(y,T){return new p(this.wrapped,y,T)}}n.Interpolated=p;class E extends n{constructor(I,y,T,P){super(),this.xzScale=I,this.yScale=y,this.noiseData=T,this.noise=P}compute(I){var y,T;return(T=(y=this.noise)==null?void 0:y.sample(I.x*this.xzScale,I.y*this.yScale,I.z*this.xzScale))!=null?T:0}maxValue(){var I,y;return(y=(I=this.noise)==null?void 0:I.maxValue)!=null?y:2}}n.Noise=E;class m extends n{constructor(y){super();_(this,"islandNoise");const T=new nt(y!=null?y:BigInt(0));T.consume(17292),this.islandNoise=new ht(T)}getHeightValue(y,T){const P=Math.floor(y/2),z=Math.floor(T/2),q=y%2,Ot=T%2;let zt=ve(100-Math.sqrt(y*y+T*T),-100,80);for(let Bt=-12;Bt<=12;Bt+=1)for(let at=-12;at<=12;at+=1){const ot=P+Bt,lt=z+at;if(ot*ot+lt*lt<=4096||this.islandNoise.sample2D(ot,lt)>=-.9)continue;const Ie=(Math.abs(ot)*3439+Math.abs(lt)*147)%13+9,sn=q+Bt*2,an=Ot+at*2,Jn=100-Math.sqrt(sn*sn+an*an)*Ie,Dn=ve(Jn,-100,80);zt=Math.max(zt,Dn)}return zt}compute({x:y,y:T,z:P}){return(this.getHeightValue(Math.floor(y/8),Math.floor(P/8))-8)/128}minValue(){return-.84375}maxValue(){return .5625}}n.EndIslands=m;const v=["type_1","type_2"],rt=class extends e{constructor(y,T,P,z){super(y);_(this,"mapper");this.rarityValueMapper=T,this.noiseData=P,this.noise=z,this.mapper=rt.ValueMapper[this.rarityValueMapper]}transform(y,T){if(!this.noise)return 0;const P=this.mapper(T);return P*Math.abs(this.noise.sample(y.x/P,y.y/P,y.z/P))}mapAll(y){return y.map(new rt(this.input.mapAll(y),this.rarityValueMapper,this.noiseData,this.noise))}minValue(){return 0}maxValue(){return this.rarityValueMapper==="type_1"?2:3}static rarityValueMapper1(y){return y<-.5?.75:y<0?1:y<.5?1.5:2}static rarityValueMapper2(y){return y<-.75?.5:y<-.5?.75:y<.5?1:y<.75?2:3}};let b=rt;_(b,"ValueMapper",{type_1:rt.rarityValueMapper1,type_2:rt.rarityValueMapper2}),n.WeirdScaledSampler=b;class w extends E{constructor(I,y,T,P,z,q,Ot){super(P,z,q,Ot),this.shiftX=I,this.shiftY=y,this.shiftZ=T}compute(I){var z,q;const y=I.x*this.xzScale+this.shiftX.compute(I),T=I.y*this.yScale+this.shiftY.compute(I),P=I.z*this.xzScale+this.shiftZ.compute(I);return(q=(z=this.noise)==null?void 0:z.sample(y,T,P))!=null?q:0}mapAll(I){return I.map(new w(this.shiftX.mapAll(I),this.shiftY.mapAll(I),this.shiftZ.mapAll(I),this.xzScale,this.yScale,this.noiseData,this.noise))}}n.ShiftedNoise=w;class S extends n{constructor(I,y,T,P,z){super(),this.input=I,this.minInclusive=y,this.maxExclusive=T,this.whenInRange=P,this.whenOutOfRange=z}compute(I){const y=this.input.compute(I);return this.minInclusive<=y&&y<this.maxExclusive?this.whenInRange.compute(I):this.whenOutOfRange.compute(I)}mapAll(I){return I.map(new S(this.input.mapAll(I),this.minInclusive,this.maxExclusive,this.whenInRange.mapAll(I),this.whenOutOfRange.mapAll(I)))}minValue(){return Math.min(this.whenInRange.minValue(),this.whenOutOfRange.minValue())}maxValue(){return Math.max(this.whenInRange.maxValue(),this.whenOutOfRange.maxValue())}}n.RangeChoice=S;class k extends n{constructor(I,y){super(),this.noiseData=I,this.offsetNoise=y}compute(I){var y,T;return(T=(y=this.offsetNoise)==null?void 0:y.sample(I.x*.25,I.y*.25,I.z*.25))!=null?T:0}maxValue(){var I,y;return((y=(I=this.offsetNoise)==null?void 0:I.maxValue)!=null?y:2)*4}}n.ShiftNoise=k;class R extends k{constructor(I,y){super(I,y)}compute(I){return super.compute(n.context(I.x,0,I.z))}withNewNoise(I){return new R(this.noiseData,I)}}n.ShiftA=R;class x extends k{constructor(I,y){super(I,y)}compute(I){return super.compute(n.context(I.z,I.x,0))}withNewNoise(I){return new x(this.noiseData,I)}}n.ShiftB=x;class A extends k{constructor(I,y){super(I,y)}withNewNoise(I){return new A(this.noiseData,I)}}n.Shift=A;class B extends e{constructor(I){super(I)}transform(I,y){return y}mapAll(I){return I.map(new B(this.input.mapAll(I)))}minValue(){return-1/0}maxValue(){return 1/0}}n.BlendDensity=B;class M extends e{constructor(I,y,T){super(I),this.min=y,this.max=T}transform(I,y){return ve(y,this.min,this.max)}mapAll(I){return I.map(new M(this.input.mapAll(I),this.min,this.max))}minValue(){return this.min}maxValue(){return this.max}}n.Clamp=M;const mt=class extends e{constructor(y,T,P,z){super(T);_(this,"transformer");this.type=y,this.min=P,this.max=z,this.transformer=mt.MappedTypes[this.type]}transform(y,T){return this.transformer(T)}mapAll(y){return y.map(new mt(this.type,this.input.mapAll(y)))}minValue(){var y;return(y=this.min)!=null?y:-1/0}maxValue(){var y;return(y=this.max)!=null?y:1/0}withMinMax(){const y=this.input.minValue();let T=this.transformer(y),P=this.transformer(this.input.maxValue());return(this.type==="abs"||this.type==="square")&&(P=Math.max(T,P),T=Math.max(0,y)),new mt(this.type,this.input,T,P)}};let C=mt;_(C,"MappedTypes",{abs:y=>Math.abs(y),square:y=>y*y,cube:y=>y*y*y,half_negative:y=>y>0?y:y*.5,quarter_negative:y=>y>0?y:y*.25,squeeze:y=>{const T=ve(y,-1,1);return T/2-T*T*T/24}}),n.Mapped=C;const O=["add","mul","min","max"];class F extends n{constructor(I,y,T,P,z){super(),this.type=I,this.argument1=y,this.argument2=T,this.min=P,this.max=z}compute(I){const y=this.argument1.compute(I);switch(this.type){case"add":return y+this.argument2.compute(I);case"mul":return y===0?0:y*this.argument2.compute(I);case"min":return y<this.argument2.minValue()?y:Math.min(y,this.argument2.compute(I));case"max":return y>this.argument2.maxValue()?y:Math.max(y,this.argument2.compute(I))}}mapAll(I){return I.map(new F(this.type,this.argument1.mapAll(I),this.argument2.mapAll(I)))}minValue(){var I;return(I=this.min)!=null?I:-1/0}maxValue(){var I;return(I=this.max)!=null?I:1/0}withMinMax(){const I=this.argument1.minValue(),y=this.argument2.minValue(),T=this.argument1.maxValue(),P=this.argument2.maxValue();(this.type==="min"||this.type==="max")&&(I>=P||y>=T)&&console.warn(`Creating a ${this.type} function between two non-overlapping inputs`);let z,q;switch(this.type){case"add":z=I+y,q=T+P;break;case"mul":z=I>0&&y>0?I*y||0:T<0&&P<0?T*P||0:Math.min(I*P||0,y*T||0),q=I>0&&y>0?T*P||0:T<0&&P<0?I*y||0:Math.max(I*y||0,T*P||0);break;case"min":z=Math.min(I,y),q=Math.min(T,P);break;case"max":z=Math.max(I,y),q=Math.max(T,P);break}return new F(this.type,this.argument1,this.argument2,z,q)}}n.Ap2=F;class D extends n{constructor(I){super(),this.spline=I}compute(I){return this.spline.compute(I)}mapAll(I){const y=this.spline.mapAll(T=>T instanceof n?T.mapAll(I):T);return y.calculateMinMax(),I.map(new D(y))}minValue(){return this.spline.min()}maxValue(){return this.spline.max()}}n.Spline=D;class X extends n{constructor(I,y,T,P){super(),this.fromY=I,this.toY=y,this.fromValue=T,this.toValue=P}compute(I){return qr(I.y,this.fromY,this.toY,this.fromValue,this.toValue)}minValue(){return Math.min(this.fromValue,this.toValue)}maxValue(){return Math.max(this.fromValue,this.toValue)}}n.YClampedGradient=X})(Z||(Z={}));class Pn{constructor(t,e){this.level=t,this.type=e}at(t){return t<this.level?this.type:H.AIR}}u.Aquifer=void 0,(n=>{function t(e){return{compute({x:r,y:i,z:s},o){if(!(o>0))return e(r,i,s).at(i)}}}n.createDisabled=t})(u.Aquifer||(u.Aquifer={}));const Nt=class{constructor(t,e,r,i,s,o,a){_(this,"minGridX");_(this,"minGridY");_(this,"minGridZ");_(this,"gridSizeX");_(this,"gridSizeZ");_(this,"gridSize");_(this,"aquiferCache");_(this,"aquiferLocationCache");this.noiseChunk=t,this.router=r,this.random=i,this.globalFluidPicker=a,this.minGridX=this.gridX(u.ChunkPos.minBlockX(e))-1,this.gridSizeX=this.gridX(u.ChunkPos.maxBlockX(e))+1-this.minGridX+1,this.minGridY=this.gridY(s)-1,this.minGridZ=this.gridZ(u.ChunkPos.minBlockZ(e))-1,this.gridSizeZ=this.gridZ(u.ChunkPos.maxBlockZ(e))+1-this.minGridZ+1;const h=this.gridY(s+o)+1-this.minGridY+1;this.gridSize=this.gridSizeX*h*this.gridSizeZ,this.aquiferCache=Array(this.gridSize).fill(void 0),this.aquiferLocationCache=Array(this.gridSize).fill(u.BlockPos.ZERO)}compute({x:t,y:e,z:r},i){if(i<=0){if(this.globalFluidPicker(t,e,r).at(e).is(H.LAVA))return H.LAVA;{const s=this.gridX(t-5),o=this.gridY(e+1),a=this.gridZ(r-5);let h=Number.MAX_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER,c=Number.MAX_SAFE_INTEGER,d=u.BlockPos.ZERO,g=u.BlockPos.ZERO,f=u.BlockPos.ZERO;for(let k=0;k<=1;k+=1)for(let R=-1;R<=1;R+=1)for(let x=0;x<=1;x+=1){const A=this.getLocation(s+k,o+R,a+x),B=u.BlockPos.magnitude(A);h>=B?(f=g,g=d,d=A,c=l,l=h,h=B):l>=B?(f=g,g=A,c=l,l=B):c>=B&&(f=A,c=B)}const p=this.getStatus(d),E=this.getStatus(g),m=this.getStatus(f),v=Nt.similarity(h,l),b=Nt.similarity(h,c),w=Nt.similarity(l,c);let S;if(p.at(e).is(H.WATER)&&this.globalFluidPicker(t,e-1,r).at(e-1).is(H.LAVA))S=1;else if(v>-1){const k=on(()=>this.router.barrier.compute(Z.context(t,e*.5,r))),R=this.calculatePressure(e,p,E,k),x=this.calculatePressure(e,p,m,k),A=this.calculatePressure(e,E,m,k),B=Math.max(R,x*Math.max(0,b),A*Math.max(w));S=Math.max(0,2*Math.max(0,v)*B)}else S=0;if(i+S<=0)return p.at(e)}}}static similarity(t,e){return 1-Math.abs(e-t)/25}calculatePressure(t,e,r,i){const s=e.at(t),o=r.at(t);if(s.is(H.LAVA)&&o.is(H.WATER)||s.is(H.WATER)&&o.is(H.LAVA))return 1;const a=Math.abs(e.level-r.level);if(a===0)return 0;const h=(e.level+r.level)/2,l=t+.5-h,c=a/2-Math.abs(l),d=l>0?c>0?c/1.5:c/2.5:c>-3?(c+3)/3:(c+3)/10;return d<-2||d>2?d:d+i()}getStatus(t){const[e,r,i]=t,s=this.getIndex(this.gridX(e),this.gridY(r),this.gridZ(i)),o=this.aquiferCache[s];if(o!==void 0)return o;const a=this.computeStatus(e,r,i);return this.aquiferCache[s]=a,a}computeStatus(t,e,r){const i=this.globalFluidPicker(t,e,r);let s=Number.MAX_SAFE_INTEGER,o=!1;for(const[p,E]of Nt.SURFACE_SAMPLING){const m=t+(E<<4),v=r+(E<<4),b=this.noiseChunk.getPreliminarySurfaceLevel(m,v);s=Math.min(s,b);const w=p===0&&E===0;if(w&&e-12>b+8)return i;if(w||e+12>b+8){const S=this.globalFluidPicker(m,b+8,v);if(!S.at(b+8).is(H.AIR)){if(w)return S;o=!0}}}const a=o?qr(s+8-e,0,64,1,0):0,h=ve(this.router.fluidLevelFloodedness.compute(Z.context(t,e*.67,r)),-1,1);if(h>Rn(a,1,0,-.3,.8))return i;if(h<=Rn(a,1,0,-.8,.4))return new Pn(Number.MIN_SAFE_INTEGER,i.type);const l=Math.floor(e/40),c=this.router.fluidLevelSpread.compute(Z.context(Math.floor(t/16),l,Math.floor(r/16))),d=l*40+20+Math.floor(c/3)*3,g=Math.min(s,d),f=this.getFluidType(t,e,r,i.type,d);return new Pn(g,f)}getFluidType(t,e,r,i,s){if(s<=-10){const o=this.router.lava.compute(Z.context(Math.floor(t/64),Math.floor(e/40),Math.floor(r/64)));if(Math.abs(o)>.3)return H.LAVA}return i}getLocation(t,e,r){const i=this.getIndex(t,e,r),s=this.aquiferLocationCache[i];if(u.BlockPos.equals(s,u.BlockPos.ZERO))return s;const o=this.random.at(t,e,r),a=u.BlockPos.create(t*Nt.X_SPACING+o.nextInt(10),e*Nt.Y_SPACING+o.nextInt(9),r*Nt.Z_SPACING+o.nextInt(10));return this.aquiferLocationCache[i]=a,a}getIndex(t,e,r){const i=t-this.minGridX,s=e-this.minGridY,o=r-this.minGridZ,a=(s*this.gridSizeZ+o)*this.gridSizeX+i;if(a<0||a>=this.gridSize)throw new Error(`Invalid aquifer index at ${t} ${e} ${r}: 0 <= ${a} < ${this.gridSize}`);return a}gridX(t){return Math.floor(t/Nt.X_SPACING)}gridY(t){return Math.floor(t/Nt.Y_SPACING)}gridZ(t){return Math.floor(t/Nt.Z_SPACING)}};let Je=Nt;_(Je,"X_SPACING",16),_(Je,"Y_SPACING",12),_(Je,"Z_SPACING",16),_(Je,"SURFACE_SAMPLING",[[-2,-1],[-1,-1],[0,-1],[1,-1],[-3,0],[-2,0],[-1,0],[0,0],[1,0],[-2,1],[-1,1],[0,1],[1,1]]);class gr{constructor(t,e){_(this,"n");if(this.shift=t,this.biomes=e,e.length===0)throw new Error("Cannot create checkerboard biome source without biomes");this.n=e.length}getBiome(t,e,r){const i=(((t>>this.shift)+(r>>this.shift))%this.n+this.n)%this.n;return N.parse(this.biomes[i].toString())}static fromJson(t){var s,o,a;const e=(s=u.Json.readObject(t))!=null?s:{},r=(o=u.Json.readInt(e.scale))!=null?o:2;let i;return typeof e.biomes=="string"?i=[N.parse(e.biomes)]:i=(a=u.Json.readArray(e.biomes,h=>{var l;return N.parse((l=u.Json.readString(h))!=null?l:"")}))!=null?a:[],new gr(r+2,i)}}class Qe{constructor(t){this.biome=t}getBiome(){return this.biome}static fromJson(t){var i,s;const e=(i=u.Json.readObject(t))!=null?i:{},r=N.parse((s=u.Json.readString(e.biome))!=null?s:"plains");return new Qe(r)}}u.Climate=void 0,(n=>{function e(E,m,v,b,w,S){return new a(E,m,v,b,w,S)}n.target=e;function r(E,m,v,b,w,S,k){return new o(i(E),i(m),i(v),i(b),i(w),i(S),k)}n.parameters=r;function i(E,m){return typeof E=="number"?new s(E,m!=null?m:E):E}n.param=i;class s{constructor(m,v){this.min=m,this.max=v}distance(m){const v=(typeof m=="number"?m:m.min)-this.max,b=this.min-(typeof m=="number"?m:m.max);return v>0?v:Math.max(b,0)}union(m){return new s(Math.min(this.min,m.min),Math.max(this.max,m.max))}static fromJson(m){var w;if(typeof m=="number")return new s(m,m);const[v,b]=(w=u.Json.readArray(m,S=>u.Json.readNumber(S)))!=null?w:[];return new s(v!=null?v:0,b!=null?b:0)}}n.Param=s;class o{constructor(m,v,b,w,S,k,R){this.temperature=m,this.humidity=v,this.continentalness=b,this.erosion=w,this.depth=S,this.weirdness=k,this.offset=R}fittness(m){return Qt(this.temperature.distance(m.temperature))+Qt(this.humidity.distance(m.humidity))+Qt(this.continentalness.distance(m.continentalness))+Qt(this.erosion.distance(m.erosion))+Qt(this.depth.distance(m.depth))+Qt(this.weirdness.distance(m.weirdness))+Qt(this.offset-m.offset)}space(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,new s(this.offset,this.offset)]}static fromJson(m){var b,w;const v=(b=u.Json.readObject(m))!=null?b:{};return new o(s.fromJson(v.temperature),s.fromJson(v.humidity),s.fromJson(v.continentalness),s.fromJson(v.erosion),s.fromJson(v.depth),s.fromJson(v.weirdness),(w=u.Json.readNumber(v.offset))!=null?w:0)}}n.ParamPoint=o;class a{constructor(m,v,b,w,S,k){this.temperature=m,this.humidity=v,this.continentalness=b,this.erosion=w,this.depth=S,this.weirdness=k}get offset(){return 0}toArray(){return[this.temperature,this.humidity,this.continentalness,this.erosion,this.depth,this.weirdness,this.offset]}}n.TargetPoint=a;class h{constructor(m){_(this,"index");this.things=m,this.index=new c(m)}find(m){return this.index.search(m,(v,b)=>v.distance(b))}}n.Parameters=h;class l{constructor(m,v,b,w,S,k){this.temperature=m,this.humidity=v,this.continentalness=b,this.erosion=w,this.depth=S,this.weirdness=k}static fromRouter(m){return new n.Sampler(m.temperature,m.vegetation,m.continents,m.erosion,m.depth,m.ridges)}sample(m,v,b){const w=Z.context(m<<2,v<<2,b<<2);return n.target(this.temperature.compute(w),this.humidity.compute(w),this.continentalness.compute(w),this.erosion.compute(w),this.depth.compute(w),this.weirdness.compute(w))}}n.Sampler=l;const p=class{constructor(m){_(this,"root");_(this,"last_leaf",null);if(m.length===0)throw new Error("At least one point is required to build search tree");this.root=p.build(m.map(([v,b])=>new f(v,b)))}static build(m){if(m.length===1)return m[0];if(m.length<=p.CHILDREN_PER_NODE){const S=m.map(k=>{let R=0;for(let x=0;x<7;x+=1){const A=k.space[x];R+=Math.abs((A.min+A.max)/2)}return{key:R,node:k}}).sort((k,R)=>k.key-R.key).map(({node:k})=>k);return new g(S)}let v=1/0,b=-1,w=[];for(let S=0;S<7;++S){m=p.sort(m,S,!1),w=p.bucketize(m);let k=0;for(const R of w)k+=p.area(R.space);v>k&&(v=k,b=S)}return m=p.sort(m,b,!1),w=p.bucketize(m),w=p.sort(w,b,!0),new g(w.map(S=>p.build(S.children)))}static sort(m,v,b){return m.map(w=>{const S=w.space[v],k=(S.min+S.max)/2;return{key:b?Math.abs(k):k,node:w}}).sort((w,S)=>w.key-S.key).map(({node:w})=>w)}static bucketize(m){const v=[];let b=[];const w=Math.pow(10,Math.floor(Math.log(m.length-.01)/Math.log(10)));for(const S of m)b.push(S),!(b.length<w)&&(v.push(new g(b)),b=[]);return b.length!==0&&v.push(new g(b)),v}static area(m){let v=0;for(const b of m)v+=Math.abs(b.max-b.min);return v}search(m,v){const b=this.root.search(m.toArray(),this.last_leaf,v);return this.last_leaf=b,b.thing()}};let c=p;_(c,"CHILDREN_PER_NODE",10),n.RTree=c;class d{constructor(m){this.space=m}distance(m){let v=0;for(let b=0;b<7;b+=1)v+=Qt(this.space[b].distance(m[b]));return v}}n.RNode=d;class g extends d{constructor(m){super(g.buildSpace(m)),this.children=m}static buildSpace(m){let v=[...Array(7)].map(()=>new s(1/0,-1/0));for(const b of m)v=[...Array(7)].map((w,S)=>v[S].union(b.space[S]));return v}search(m,v,b){let w=v?b(v,m):1/0,S=v;for(const k of this.children){const R=b(k,m);if(w<=R)continue;const x=k.search(m,S,b);if(x===null)continue;const A=k==x?R:b(x,m);if(A===0)return x;w<=A||(w=A,S=x)}return S}}n.RSubTree=g;class f extends d{constructor(m,v){super(m.space()),this.thing=v}search(){return this}}n.RLeaf=f})(u.Climate||(u.Climate={}));class mr{constructor(t){_(this,"parameters");this.parameters=new u.Climate.Parameters(t)}getBiome(t,e,r,i){const s=i.sample(t,e,r);return this.parameters.find(s)}static fromJson(t){var s,o;const e=(s=u.Json.readObject(t))!=null?s:{},i=((o=u.Json.readArray(e.biomes,a=>{var h;return(l=>{var c;return{biome:N.parse((c=u.Json.readString(l.biome))!=null?c:"plains"),parameters:u.Climate.ParamPoint.fromJson(l.parameters)}})((h=u.Json.readObject(a))!=null?h:{})}))!=null?o:[]).map(a=>[a.parameters,()=>a.biome]);return new mr(i)}}const Ee=class{getBiome(t,e,r,i){const s=t<<2,o=e<<2,a=r<<2,h=s>>4,l=a>>4;if(h*h+l*l<=4096)return Ee.END;const c=Z.context((h*2+1)*8,o,(l*2+1)*8),d=i.erosion.compute(c);return d>.25?Ee.HIGHLANDS:d>=-.0625?Ee.MIDLANDS:d>=-.21875?Ee.BARRENS:Ee.ISLANDS}static fromJson(t){return new Ee}};let ye=Ee;_(ye,"END",N.create("the_end")),_(ye,"HIGHLANDS",N.create("end_highlands")),_(ye,"MIDLANDS",N.create("end_midlands")),_(ye,"ISLANDS",N.create("small_end_islands")),_(ye,"BARRENS",N.create("end_barrens")),u.BiomeSource=void 0,(n=>{function t(r){var o,a;const i=(o=u.Json.readObject(r))!=null?o:{};switch((a=u.Json.readString(i.type))==null?void 0:a.replace(/^minecraft:/,"")){case"fixed":return Qe.fromJson(r);case"checkerboard":return gr.fromJson(r);case"multi_noise":return mr.fromJson(r);case"the_end":return ye.fromJson(r);default:return new Qe(N.create("plains"))}}n.fromJson=t;function e(r,i,s,o,a,h,l,c,d=1,g=!1){if(r instanceof Qe)return h(r.getBiome())?g?{pos:u.BlockPos.create(i,s,o),biome:r.getBiome()}:{pos:u.BlockPos.create(i-a+l.nextInt(a*2+1),s,o-a+l.nextInt(a*2+1)),biome:r.getBiome()}:void 0;const f=i>>2,p=o>>2,E=a>>2,m=s>>2;for(var v=void 0,b=0,w=g?0:E,S=w;S<=E;S+=d)for(var k=-S;k<=S;k+=d){const x=Math.abs(k)===S;for(var R=-S;R<=S;R+=d){if(g&&!(Math.abs(R)===S)&&!x)continue;const A=f+R,B=p+k,M=r.getBiome(A,m,B,c);if(h(M)){if((v===void 0||l.nextInt(b+1)<=.5)&&(v={pos:u.BlockPos.create(A<<2,s,B<<2),biome:M},g))return v;b++}}}return v}n.findBiomeHorizontal=e})(u.BiomeSource||(u.BiomeSource={})),u.Heightmap=void 0,(n=>{function t(e){if(typeof e=="string"&&(e==="WORLD_SURFACE_WG"||e==="WORLD_SURFACE"||e==="OCEAN_FLOOR_WG"||e==="OCEAN_FLOOR"||e==="MOTION_BLOCKING"||e==="MOTION_BLOCKING_NO_LEAVES"))return e}n.fromJson=t})(u.Heightmap||(u.Heightmap={})),u.HeightProvider=void 0,(n=>{function t(h){var d,g,f;const l=(d=u.Json.readObject(h))!=null?d:{};switch((g=u.Json.readString(l.type))==null?void 0:g.replace(/^minecraft:/,"")){case void 0:return e(u.VerticalAnchor.fromJson(h));case"constant":return e(u.VerticalAnchor.fromJson(l.value));case"uniform":return r(u.VerticalAnchor.fromJson(l.min_inclusive),u.VerticalAnchor.fromJson(l.max_inclusive));case"biased_to_bottom":return i(u.VerticalAnchor.fromJson(l.min_inclusive),u.VerticalAnchor.fromJson(l.max_inclusive),u.Json.readInt(l.inner));case"very_biased_to_bottom":return s(u.VerticalAnchor.fromJson(l.min_inclusive),u.VerticalAnchor.fromJson(l.max_inclusive),u.Json.readInt(l.inner));case"trapezoid":return o(u.VerticalAnchor.fromJson(l.min_inclusive),u.VerticalAnchor.fromJson(l.max_inclusive),u.Json.readInt(l.plateau));case"weighted_list":return a((f=u.Json.readArray(l.distribution,p=>{var m,v;const E=(m=u.Json.readObject(p))!=null?m:{};return{weight:(v=u.Json.readInt(E.weight))!=null?v:1,data:t(E.data)}}))!=null?f:[])}return()=>0}n.fromJson=t;function e(h){return(l,c)=>h(c)}n.constant=e;function r(h,l){return(c,d)=>{const g=h(d),f=l(d);return g>f?g:c.nextInt(f-g+1)+g}}n.uniform=r;function i(h,l,c=1){return(d,g)=>{const f=h(g),p=l(g);if(p-f-c+1<=0)return f;{const E=d.nextInt(p-f-c+1);return d.nextInt(E+c)+f}}}n.biased_to_bottom=i;function s(h,l,c=1){return(d,g)=>{const f=h(g),p=l(g);if(p-f-c+1<=0)return f;{const E=ar(d,f+c,p),m=ar(d,f,E-1);return ar(d,f,m-1+c)}}}n.very_biased_to_bottom=s;function o(h,l,c=0){return(d,g)=>{const f=h(g),p=l(g);if(f>p)return f;{const E=p-f;if(c>=E)return sr(d,f,p);{const m=(E-c)/2,v=E-m;return f+sr(d,0,v)+sr(d,0,m)}}}}n.trapezoid=o;function a(h){const l=h.reduce((c,d,g)=>c+d.weight,0);return(c,d)=>{let g=c.nextInt(l);for(const f of h)if(g-=f.weight,g<=0)return f.data(c,d);return 0}}n.weighted_list=a})(u.HeightProvider||(u.HeightProvider={}));class ai{constructor(t,e,r,i,s,o,a,h,l){_(this,"cellWidth");_(this,"cellHeight");_(this,"firstCellX");_(this,"firstCellZ");_(this,"firstNoiseX");_(this,"firstNoiseZ");_(this,"noiseSizeXZ");_(this,"preliminarySurfaceLevel",new Map);_(this,"aquifer");_(this,"materialRule");_(this,"initialDensity");this.cellCountXZ=t,this.cellCountY=e,this.cellNoiseMinY=r,this.minX=s,this.minZ=o,this.settings=a,this.cellWidth=u.NoiseSettings.cellWidth(a),this.cellHeight=u.NoiseSettings.cellHeight(a),this.firstCellX=Math.floor(s/this.cellWidth),this.firstCellZ=Math.floor(o/this.cellWidth),this.firstNoiseX=s>>2,this.firstNoiseZ=o>>2,this.noiseSizeXZ=t*this.cellWidth>>2,this.aquifer=u.Aquifer.createDisabled(l);const c=i.router.finalDensity;this.materialRule=u.MaterialRule.fromList([d=>this.aquifer.compute(d,c.compute(d))]),this.initialDensity=i.router.initialDensityWithoutJaggedness}getFinalState(t,e,r){return this.materialRule({x:t,y:e,z:r})}getPreliminarySurfaceLevel(t,e){return ke(this.preliminarySurfaceLevel,u.ChunkPos.asLong(t,e),()=>{const r=t<<2,i=e<<2;for(let s=this.settings.minY+this.settings.height;s>=this.settings.minY;s-=this.cellHeight)if(this.initialDensity.compute(Z.context(r,s,i))>.390625)return s;return Number.MAX_SAFE_INTEGER})}}u.MaterialRule=void 0,(n=>{function t(e){return r=>{for(const i of e){const s=i(r);if(s)return s}}}n.fromList=t})(u.MaterialRule||(u.MaterialRule={}));class sa{constructor(t,e){_(this,"noiseChunkCache");_(this,"globalFluidPicker");this.biomeSource=t,this.settings=e,this.noiseChunkCache=new Map;const r=new Pn(-54,H.LAVA),i=new Pn(e.seaLevel,e.defaultFluid);this.globalFluidPicker=(s,o,a)=>o<Math.min(-54,e.seaLevel)?r:i}getBaseHeight(t,e,r,i){var o;let s;return r==="OCEAN_FLOOR"||r==="OCEAN_FLOOR_WG"?s=a=>!a.equals(H.AIR):s=a=>a.equals(H.STONE),(o=this.iterateNoiseColumn(i,t,e,void 0,s,H.STONE))!=null?o:this.settings.noise.minY}iterateNoiseColumn(t,e,r,i,s,o){var E,m;const a=this.settings.noise.minY,h=u.NoiseSettings.cellHeight(this.settings.noise),l=Math.floor(a/h),c=Math.floor(this.settings.noise.height/h);if(c<=0)return;const d=u.NoiseSettings.cellWidth(this.settings.noise),g=Math.floor(e/d),f=Math.floor(r/d),p=new ai(1,c,l,t,g,f,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker);for(let v=c-1;v>=0;v-=1)for(let b=h-1;b>=0;b-=1){const w=(l+v)*h+b,S=(m=(E=p.getFinalState(e,w,r))!=null?E:o)!=null?m:this.settings.defaultBlock;if(i!==void 0&&(i[w+a]=S),s!==void 0&&s(S))return w+1}}fill(t,e,r=!1){var p;const i=Math.max(e.minY,this.settings.noise.minY),s=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),o=u.NoiseSettings.cellWidth(this.settings.noise),a=u.NoiseSettings.cellHeight(this.settings.noise),h=Math.floor(16/o),l=Math.floor(i/a),c=Math.floor((s-i)/a),d=u.ChunkPos.minBlockX(e.pos),g=u.ChunkPos.minBlockZ(e.pos),f=this.getOrCreateNoiseChunk(t,e);for(let E=0;E<h;E+=1)for(let m=0;m<(r?1:h);m+=1){let v=e.getOrCreateSection(e.sectionsCount-1);for(let b=c-1;b>=0;b-=1)for(let w=a-1;w>=0;w-=1){const S=(l+b)*a+w,k=S&15,R=e.getSectionIndex(S);e.getSectionIndex(v.minBlockY)!==R&&(v=e.getOrCreateSection(R));for(let x=0;x<o;x+=1){const A=d+E*o+x,B=A&15;for(let M=0;M<(r?1:o);M+=1){const C=g+m*o+M,O=C&15,F=(p=f.getFinalState(A,S,C))!=null?p:this.settings.defaultBlock;v.setBlockState(B,k,O,F)}}}}}buildSurface(t,e,r="minecraft:plains"){const i=this.getOrCreateNoiseChunk(t,e),s=this.settings.noise;t.surfaceSystem.buildSurface(e,i,s,()=>r)}computeBiome(t,e,r,i){return this.biomeSource.getBiome(e,r,i,t.sampler)}getOrCreateNoiseChunk(t,e){return ke(this.noiseChunkCache,u.ChunkPos.toLong(e.pos),()=>{const r=Math.max(e.minY,this.settings.noise.minY),i=Math.min(e.maxY,this.settings.noise.minY+this.settings.noise.height),s=u.NoiseSettings.cellWidth(this.settings.noise),o=u.NoiseSettings.cellHeight(this.settings.noise),a=Math.floor(16/s),h=Math.floor(r/o),l=Math.floor((i-r)/o),c=u.ChunkPos.minBlockX(e.pos),d=u.ChunkPos.minBlockZ(e.pos);return new ai(a,l,h,t,c,d,this.settings.noise,this.settings.aquifersEnabled,this.globalFluidPicker)})}}class aa{constructor(t,e){_(this,"noiseCache");_(this,"randomCache");_(this,"random");_(this,"aquiferRandom");_(this,"oreRandom");_(this,"surfaceSystem");_(this,"router");_(this,"sampler");this.seed=e,this.noiseCache=new Map,this.randomCache=new Map,this.random=(t.legacyRandomSource?new nt(e):W.create(e)).forkPositional(),this.aquiferRandom=this.random.fromHashOf(N.create("aquifer").toString()).forkPositional(),this.oreRandom=this.random.fromHashOf(N.create("ore").toString()).forkPositional(),this.surfaceSystem=new ra(t.surfaceRule,t.defaultBlock,e),this.router=u.NoiseRouter.mapAll(t.noiseRouter,this.createVisitor(t.noise,t.legacyRandomSource)),this.sampler=u.Climate.Sampler.fromRouter(this.router)}createVisitor(t,e){const r=new Map,i=o=>{const a=o.key();if(a===void 0)throw new Error("Cannot create noise without key");if(e){if(a.equals(N.create("temperature")))return new ne(new nt(this.seed+BigInt(0)),u.NoiseParameters.create(-7,[1,1]));if(a.equals(N.create("vegetation")))return new ne(new nt(this.seed+BigInt(1)),u.NoiseParameters.create(-7,[1,1]));if(a.equals(N.create("offset")))return new ne(this.random.fromHashOf("offset"),u.NoiseParameters.create(0,[0]))}return this.getOrCreateNoise(a)},s={map:o=>{if(o instanceof Z.HolderHolder){const a=o.holder.key();if(a!==void 0&&r.has(a.toString()))return r.get(a.toString());{const h=o.holder.value().mapAll(s);return a!==void 0&&r.set(a.toString(),h),h}}return o instanceof Z.Interpolated?o.withCellSize(u.NoiseSettings.cellWidth(t),u.NoiseSettings.cellHeight(t)):o instanceof Z.ShiftedNoise?new Z.ShiftedNoise(o.shiftX,o.shiftY,o.shiftZ,o.xzScale,o.yScale,o.noiseData,i(o.noiseData)):o instanceof Z.Noise?new Z.Noise(o.xzScale,o.yScale,o.noiseData,i(o.noiseData)):o instanceof Z.ShiftNoise?o.withNewNoise(i(o.noiseData)):o instanceof Z.WeirdScaledSampler?new Z.WeirdScaledSampler(o.input,o.rarityValueMapper,o.noiseData,i(o.noiseData)):o instanceof Z.OldBlendedNoise?new Z.OldBlendedNoise(o.xzScale,o.yScale,o.xzFactor,o.yFactor,o.smearScaleMultiplier,new Ys(this.random.fromHashOf(N.create("terrain").toString()),o.xzScale,o.yScale,o.xzFactor,o.yFactor,o.smearScaleMultiplier)):o instanceof Z.EndIslands?new Z.EndIslands(this.seed):o instanceof Z.Mapped||o instanceof Z.Ap2?o.withMinMax():o}};return s}getOrCreateNoise(t){const e=Et.REGISTRY.getOrThrow(N.create("worldgen/noise"));return ke(this.noiseCache,t.toString(),r=>new ne(this.random.fromHashOf(r),e.getOrThrow(t)))}getOrCreateRandom(t){return ke(this.randomCache,t.toString(),e=>this.random.fromHashOf(e).forkPositional())}}class Lt{static fromJson(t){var r,i,s,o;const e=(r=u.Json.readObject(t))!=null?r:{};switch((i=u.Json.readString(e.element_type))==null?void 0:i.replace(/^minecraft:/,"")){case"single_pool_element":case"legacy_single_pool_element":const a=N.parse((s=u.Json.readString(e.location))!=null?s:""),h={key:()=>a,value:()=>{var c;return(c=Kt.REGISTRY.get(a))!=null?c:Kt.EMPTY}};return new Lt.SinlgePoolElement(h);case"list_pool_element":const l=(o=u.Json.readArray("elements",Lt.fromJson))!=null?o:[];return new Lt.ListPoolElement(l);case"feature_pool_element":return new Lt.FeaturePoolElement;case"empty_pool_element":default:return new Lt.EmptyPoolElement}}}(n=>{class t extends n{getBoundingBox(a,h){throw new Error("Invalid call of EmptyPoolElement")}getShuffledJigsawBlocks(a,h){return[]}toString(){return"[Empty Pool Element]"}}n.EmptyPoolElement=t;class e extends n{constructor(){super();_(this,"defaultJigsawNBT");const h=new Map;h.set("name",new _t("minecraft:bottom")),h.set("final_state",new _t("minecraft:air")),h.set("pool",new _t("minecraft:empty")),h.set("target",new _t("minecraft:empty")),h.set("joint",new _t("rollable")),this.defaultJigsawNBT=new pt(h)}getBoundingBox(h,l){return[h,h]}getShuffledJigsawBlocks(h,l){return[{pos:[0,0,0],state:new H(N.create("jigsaw"),{orientation:"down_south"}),nbt:this.defaultJigsawNBT}]}toString(){return"[Feature Pool Element]"}}n.FeaturePoolElement=e;const s=class extends n{constructor(a){super(),this.template=a}getBoundingBox(a,h){const l=u.BlockPos.offset(this.template.value().getSize(),-1,-1,-1),c=a,d=u.BlockPos.add(Kt.transform(l,h,u.BlockPos.ZERO),a),g=u.BlockPos.create(Math.min(c[0],d[0]),c[1],Math.min(c[2],d[2])),f=u.BlockPos.create(Math.max(c[0],d[0]),d[1],Math.max(c[2],d[2]));return[g,f]}getShuffledJigsawBlocks(a,h){const l=this.template.value().getBlocks().filter(c=>c.state.getName().equals(s.JIGSAW_ID));return l.forEach(c=>c.pos=Kt.transform(c.pos,a,u.BlockPos.ZERO)),Fs(l,h),l}toString(){return`[Single Pool Element: ${this.template.key()}]`}};let r=s;_(r,"JIGSAW_ID",N.parse("jigsaw")),n.SinlgePoolElement=r;class i extends n{constructor(a){super(),this.elements=a}getBoundingBox(a,h){var l=void 0,c=void 0;for(const d of this.elements){const g=d.getBoundingBox(a,h);!l||!c?(l=g[0],c=g[1]):(l[0]=Math.min(l[0],g[0][0]),l[1]=Math.min(l[1],g[0][1]),l[2]=Math.min(l[2],g[0][2]),c[0]=Math.min(l[0],g[1][0]),c[1]=Math.min(l[1],g[1][1]),c[2]=Math.min(l[2],g[1][2]))}return[l,c]}getShuffledJigsawBlocks(a,h){return this.elements[0].getShuffledJigsawBlocks(a,h)}toString(){return`[List Pool Element: ${"; ".concat(...this.elements.map(a=>a.toString()))}]`}}n.ListPoolElement=i})(Lt||(Lt={}));const He=class{constructor(t,e){_(this,"totalWeight");this.rawTemplates=t,this.fallback=e,this.totalWeight=t.reduce((r,i)=>r+i.weight,0)}static fromJson(t){var s,o,a;const e=(s=u.Json.readObject(t))!=null?s:{},r=He.structurePoolParser((o=e.fallback)!=null?o:""),i=(a=u.Json.readArray(e.elements,h=>{var g,f;const l=(g=u.Json.readObject(h))!=null?g:{},c=Lt.fromJson(l.element),d=(f=u.Json.readInt(l.weight))!=null?f:1;return{element:c,weight:d}}))!=null?a:[];return new He(i,r)}getRandomTemplate(t){var e=t.nextInt(this.totalWeight);for(const r of this.rawTemplates)if(e-=r.weight,e<0)return r.element;return this.rawTemplates[this.rawTemplates.length-1].element}};let De=He;_(De,"REGISTRY",Et.createAndRegister("worldgen/template_pool",He.fromJson)),_(De,"structurePoolParser",u.Holder.parser(He.REGISTRY,He.fromJson));class pr{constructor(t){this.settings=t}onTopOfChunkCenter(t,e,r,i="WORLD_SURFACE_WG"){const s=(e<<4)+8,o=(r<<4)+8;return[s,t.chunkGenerator.getBaseHeight(s,o,i,t.randomState)-1,o]}getLowestY(t,e,r,i,s){return Math.min(t.chunkGenerator.getBaseHeight(e,r,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e,r+s,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e+i,r,"WORLD_SURFACE_WG",t.randomState)-1,t.chunkGenerator.getBaseHeight(e+i,r+s,"WORLD_SURFACE_WG",t.randomState)-1)}getLowestYIn5by5BoxOffset7Blocks(t,e,r,i){let s=5,o=5;i===u.Rotation.CLOCKWISE_90?s=-5:i===u.Rotation.CLOCKWISE_180?(s=-5,o=-5):i===u.Rotation.COUNTERCLOCKWISE_90&&(o=-5);const a=(e<<4)+7,h=(r<<4)+7;return u.BlockPos.create(a,this.getLowestY(t,a,h,s,o),h)}tryGenerate(t,e,r){const i=nt.fromLargeFeatureSeed(r.seed,t,e),s=this.findGenerationPoint(t,e,i,r);if(s===void 0)return!1;const o=r.biomeSource.getBiome(s[0]>>2,s[1],s[2]>>2,r.randomState.sampler);return[...this.settings.validBiomes.getEntries()].findIndex(a=>{var h;return(h=a.key())==null?void 0:h.equals(o)})>=0}}(n=>{n.REGISTRY=Et.createAndRegister("worldgen/structure",i);class t{constructor(x){this.validBiomes=x}}n.StructureSettings=t;class e{constructor(x,A,B){_(this,"chunkGenerator");_(this,"randomState");this.seed=x,this.biomeSource=A,this.settings=B,this.randomState=new aa(B,x),this.chunkGenerator=new sa(A,B)}}n.GenerationContext=e;const r=u.Holder.parser(De.REGISTRY,De.fromJson);function i(R){var C,O,F;const x=we.parser(u.WorldgenRegistries.BIOME),A=(C=u.Json.readObject(R))!=null?C:{},B=x(A.biomes),M=new t(B.value());switch((O=u.Json.readString(A.type))==null?void 0:O.replace(/^minecraft:/,"")){case"buried_treasure":return new o(M);case"desert_pyramid":return new h(M);case"end_city":return new l(M);case"fortress":return new c(M);case"igloo":return new d(M);case"jigsaw":const D=u.HeightProvider.fromJson(A.start_height),X=r(A.start_pool),Q=u.Json.readString(A.start_jigsaw_name),rt=Q?N.parse(Q):void 0,mt=u.Heightmap.fromJson(A.project_start_to_heightmap);return new s(M,X,D,mt,rt);case"jungle_temple":return new g(M);case"mineshaft":const j=u.Json.readString(A.mineshaft_type)==="mesa"?"mesa":"normal";return new f(M,j);case"nether_fossil":return new c(M);case"ocean_monument":return new E(M);case"ocean_ruin":return new m(M);case"ruined_portal":return new v(M);case"shipwreck":const I=(F=u.Json.readBoolean(A.is_beached))!=null?F:!1;return new b(M,I);case"stronghold":return new w(M);case"swamp_hut":return new S(M);case"woodland_mansion":return new k(M)}return new o(M)}n.fromJson=i;class s extends n{constructor(x,A,B,M,C){super(x),this.startingPoolHolder=A,this.startHeight=B,this.projectStartToHeightmap=M,this.startJigsawName=C}findGenerationPoint(x,A,B,M){var C=this.startHeight(B,M.settings.noise);const O=u.BlockPos.create(x<<4,C,A<<4),F=u.Rotation.getRandom(B),X=this.startingPoolHolder.value().getRandomTemplate(B);if(!(X instanceof Lt.EmptyPoolElement)){var Q;if(this.startJigsawName){const P=s.getRandomNamedJigsaw(X,this.startJigsawName,F,B);if(P===void 0)return;Q=P}else Q=u.BlockPos.ZERO;const rt=u.BlockPos.subtract(O,Q),mt=X.getBoundingBox(rt,F),j=(mt[1][0]+mt[0][0])/2^0,I=(mt[1][2]+mt[0][2])/2^0;var C;return this.projectStartToHeightmap?C=O[1]+M.chunkGenerator.getBaseHeight(j,I,this.projectStartToHeightmap,M.randomState):C=rt[1],u.BlockPos.create(j,C+Q[1],I)}}static getRandomNamedJigsaw(x,A,B,M){var O,F;const C=x.getShuffledJigsawBlocks(B,M);for(const D of C)if(N.parse((F=(O=D.nbt)==null?void 0:O.getString("name"))!=null?F:"minecraft:empty").equals(A))return D.pos}}n.JigsawStructure=s;class o extends n{findGenerationPoint(x,A,B,M){return this.onTopOfChunkCenter(M,x,A,"OCEAN_FLOOR_WG")}}n.BuriedTreasureStructure=o;class a extends n{constructor(x,A,B){super(x),this.width=A,this.depth=B}findGenerationPoint(x,A,B,M){if(!(this.getLowestY(M,x<<4,A<<4,this.width,this.depth)<M.settings.seaLevel))return this.onTopOfChunkCenter(M,x,A)}}class h extends a{constructor(x){super(x,21,21)}}n.DesertPyramidStructure=h;class l extends n{findGenerationPoint(x,A,B,M){const C=u.Rotation.getRandom(B),O=this.getLowestYIn5by5BoxOffset7Blocks(M,x,A,C);if(!(O[1]<60))return O}}n.EndCityStructure=l;class c extends n{findGenerationPoint(x,A){return u.BlockPos.create(x<<4,64,A<<4)}}n.NetherFortressStructure=c;class d extends n{findGenerationPoint(x,A,B,M){return this.onTopOfChunkCenter(M,x,A)}}n.IglooStructure=d;class g extends a{constructor(x){super(x,12,15)}}n.JungleTempleStructure=g;class f extends n{constructor(x,A){super(x),this.type=A}findGenerationPoint(x,A,B,M){throw new Error("Method not implemented.")}}n.MineshaftStructure=f;class p extends n{constructor(x,A){super(x),this.height=A}findGenerationPoint(x,A){throw new Error("Method not implemented.")}}n.NetherFossilStructure=p;class E extends n{findGenerationPoint(x,A){throw new Error("Method not implemented.")}}n.OceanMonumentStructure=E;class m extends n{findGenerationPoint(x,A,B,M){return this.onTopOfChunkCenter(M,x,A,"OCEAN_FLOOR_WG")}}n.OceanRuinStructure=m;class v extends n{findGenerationPoint(x,A){throw new Error("Method not implemented.")}}n.RuinedPortalStructure=v;class b extends n{constructor(x,A){super(x),this.isBeached=A}findGenerationPoint(x,A,B,M){return this.onTopOfChunkCenter(M,x,A,this.isBeached?"WORLD_SURFACE_WG":"OCEAN_FLOOR_WG")}}n.ShipwreckStructure=b;class w extends n{findGenerationPoint(x,A){return u.BlockPos.create(x<<4,0,A<<4)}}n.StrongholdStructure=w;class S extends n{findGenerationPoint(x,A,B,M){return this.onTopOfChunkCenter(M,x,A)}}n.SwampHutStructure=S;class k extends n{findGenerationPoint(x,A,B,M){const C=u.Rotation.getRandom(B),O=this.getLowestYIn5by5BoxOffset7Blocks(M,x,A,C);if(!(O[1]<60))return O}}n.WoodlandMansionStructure=k})(pr||(pr={}));const zn=class{constructor(t,e){this.structures=t,this.placement=e}static fromJson(t){var s,o;const e=(s=u.Json.readObject(t))!=null?s:{},r=(o=u.Json.readArray(e.structures,zn.StructureSelectionEntry.fromJson))!=null?o:[],i=Rt.fromJson(e.placement);return new zn(r,i)}getStructureInChunk(t,e,r){if(this.placement.prepare(r.biomeSource,r.randomState.sampler,r.seed),!!this.placement.isStructureChunk(r.seed,t,e)&&this.structures.length!==0)if(this.structures.length===1){if(this.structures[0].structure.value().tryGenerate(t,e,r))return this.structures[0].structure.key()}else{const i=nt.fromLargeFeatureSeed(r.seed,t,e),s=Object.assign([],this.structures);let o=s.reduce((a,h,l)=>a+h.weight,0);for(;s.length>0;){let a=i.nextInt(o),h,l;for([h,l]of s.entries())if(a-=l.weight,a<0)break;if(l.structure.value().tryGenerate(t,e,r))return l.structure.key();s.splice(h,1),o-=l.weight}}}};let Fe=zn;_(Fe,"REGISTRY",Et.createAndRegister("worldgen/structure_set",zn.fromJson)),(n=>{class t{constructor(r,i){this.structure=r,this.weight=i}static fromJson(r){var s,o,a;const i=(s=u.Json.readObject(r))!=null?s:{};return new t(u.Holder.reference(pr.REGISTRY,N.parse((o=u.Json.readString(i.structure))!=null?o:"minecraft:empty")),(a=u.Json.readInt(i.weight))!=null?a:1)}}n.StructureSelectionEntry=t})(Fe||(Fe={}));class Rt{constructor(t,e,r,i,s){this.locateOffset=t,this.frequencyReductionMethod=e,this.frequency=r,this.salt=i,this.exclusionZone=s}static fromJson(t){var l,c,d,g,f,p,E,m,v,b;const e=(l=u.Json.readObject(t))!=null?l:{},r=(c=u.Json.readString(e.type))==null?void 0:c.replace(/^minecraft:/,""),i=u.BlockPos.fromJson(e.locate_offset),s=Rt.FrequencyReducer.fromType((d=u.Json.readString(e.frequency_reduction_method))!=null?d:"default"),o=(g=u.Json.readNumber(e.frequency))!=null?g:1,a=(f=u.Json.readInt(e.salt))!=null?f:0,h="exclusion_zone"in e?Rt.ExclusionZone.fromJson(e.exclusion_zone):void 0;switch(r){case"random_spread":const w=(p=u.Json.readInt(e.spacing))!=null?p:1,S=(E=u.Json.readInt(e.separation))!=null?E:1,k=Rt.SpreadType.fromJson(e.spread_type);return new Rt.RandomSpreadStructurePlacement(i,s,o,a,h,w,S,k);case"concentric_rings":const R=(m=u.Json.readInt(e.distance))!=null?m:1,x=(v=u.Json.readInt(e.spread))!=null?v:1,A=(b=u.Json.readInt(e.count))!=null?b:1,B=we.parser(u.WorldgenRegistries.BIOME)(e.preferred_biomes);return new Rt.ConcentricRingsStructurePlacement(i,s,o,a,h,R,x,A,B)}return new Rt.RandomSpreadStructurePlacement([0,0,0],Rt.FrequencyReducer.ProbabilityReducer,1,0,void 0,1,1,"linear")}isStructureChunk(t,e,r){return this.isPlacementChunk(t,e,r)?this.frequency<1&&!this.frequencyReductionMethod(t,this.salt,e,r,this.frequency)?!1:!(this.exclusionZone&&this.exclusionZone.isPlacementForbidden(t,e,r)):!1}prepare(t,e,r){}}(n=>{(s=>{function o(d){switch(d){case"legacy_type_1":return c;case"legacy_type_2":return l;case"legacy_type_3":return h;case"default":default:return a}}s.fromType=o;function a(d,g,f,p,E){return nt.fromLargeFeatureWithSalt(d,g,f,p).nextFloat()<E}s.ProbabilityReducer=a;function h(d,g,f,p,E){return nt.fromLargeFeatureSeed(d,f,p).nextDouble()<E}s.LegacyProbabilityReducerWithDouble=h;function l(d,g,f,p,E){return nt.fromLargeFeatureWithSalt(d,f,p,10387320).nextFloat()<E}s.LegacyArbitrarySaltProbabilityReducer=l;function c(d,g,f,p,E){const m=f>>4,v=p>>4,b=new nt(BigInt(m^v<<4)^d);return b.nextInt(),b.nextInt(Math.floor(1/E))===0}s.LegacyPillagerOutpostReducer=c})(n.FrequencyReducer||(n.FrequencyReducer={}));class t{constructor(o,a){this.otherSet=o,this.chunkCount=a}static fromJson(o){var h,l,c;const a=(h=u.Json.readObject(o))!=null?h:{};return new t(u.Holder.reference(Fe.REGISTRY,N.parse((l=u.Json.readString(a.other_set))!=null?l:"")),(c=u.Json.readInt(a.chunk_count))!=null?c:1)}isPlacementForbidden(o,a,h){const l=this.otherSet.value().placement;return l.getPotentialStructureChunks(o,a-this.chunkCount,h-this.chunkCount,a+this.chunkCount,h+this.chunkCount).findIndex(c=>Math.abs(c[0]-a)<=this.chunkCount&&Math.abs(c[1]-h)<=this.chunkCount&&l.isStructureChunk(o,c[0],c[1]))>=0}}n.ExclusionZone=t,(s=>{function o(a){var l;return((l=u.Json.readString(a))!=null?l:"linear")==="triangular"?"triangular":"linear"}s.fromJson=o})(n.SpreadType||(n.SpreadType={}));class e extends n{constructor(o,a,h,l,c,d,g,f){super(o,a,h,l,c),this.spacing=d,this.separation=g,this.spreadType=f}evaluateSpread(o,a){switch(this.spreadType){case"linear":return o.nextInt(a);case"triangular":return Math.floor((o.nextInt(a)+o.nextInt(a))/2)}}getPotentialStructureChunk(o,a,h){const l=Math.floor(a/this.spacing),c=Math.floor(h/this.spacing),d=nt.fromLargeFeatureWithSalt(o,l,c,this.salt),g=this.spacing-this.separation,f=this.evaluateSpread(d,g),p=this.evaluateSpread(d,g);return[l*this.spacing+f,c*this.spacing+p]}isPlacementChunk(o,a,h){const[l,c]=this.getPotentialStructureChunk(o,a,h);return l===a&&c===h}getPotentialStructureChunks(o,a,h,l,c){const d=[];for(let g=Math.floor(a/this.spacing)*this.spacing;g<=l;g+=this.spacing)for(let f=Math.floor(h/this.spacing)*this.spacing;f<=c;f+=this.spacing)d.push(this.getPotentialStructureChunk(o,g,f));return d}}n.RandomSpreadStructurePlacement=e;const r=112;class i extends n{constructor(a,h,l,c,d,g,f,p,E){super(a,h,l,c,d);_(this,"positions");this.distance=g,this.spread=f,this.count=p,this.preferredBiomes=E}prepare(a,h,l){if(this.positions!==void 0||(this.positions=[],this.count===0))return;const c=new nt(l);var d=c.nextDouble()*Math.PI*2,g=this.spread,f=0,p=0;const E=[...this.preferredBiomes.value().getEntries()].flatMap(v=>{var b;return(b=v.key())!=null?b:[]});for(var m=0;m<this.count;m++){const v=4*this.distance+this.distance*f*6+(c.nextDouble()-.5)*this.distance*2.5,b=Math.round(Math.cos(d)*v),w=Math.round(Math.sin(d)*v),S=(b<<4)+8,k=(w<<4)+8,R=c.fork(),x=()=>{const A=u.BiomeSource.findBiomeHorizontal(a,S,0,k,r,B=>E.findIndex(M=>M.equals(B))>=0,R,h);return A?[A.pos[0]>>4,A.pos[2]>>4]:[b,w]};this.positions.push({center:[b,w],real:x}),d+=Math.PI*2/g,p++,p==g&&(f++,p=0,g+=2*g/(f+1),g=Math.min(g,this.count-m),d+=c.nextDouble()*Math.PI*2)}}isPlacementChunk(a,h,l){return this.positions===void 0?(console.warn("trying to access concentric rings placement before position calculation"),!1):this.getPotentialStructureChunks(a,h,l,h,l).findIndex(c=>c[0]===h&&c[1]===l)>=0}getPotentialStructureChunks(a,h,l,c,d){if(this.positions===void 0)return console.warn("trying to access concentric rings placement before position calculation"),[];const g=[];for(const f of this.positions)f.center[0]<h-(r>>4)||f.center[0]>c+(r>>4)||f.center[1]<l-(r>>4)||f.center[1]>d+(r>>4)||(f.real instanceof Function&&(f.real=f.real()),g.push(f.real));return g}}n.ConcentricRingsStructurePlacement=i})(Rt||(Rt={})),u.BlendedNoise=Ys,u.BlockColors=_e,u.BlockDefinition=ri,u.BlockModel=et,u.BlockState=H,u.CheckerboardBiomeSource=gr,u.Chunk=uc,u.ChunkBuilder=Qs,u.ChunkSection=We,u.DensityFunction=Z,u.EFFECT_COLORS=Ls,u.FixedBiomeSource=Qe,u.FluidStatus=Pn,u.HolderSet=we,u.Identifier=N,u.ImprovedNoise=ni,u.ItemRenderer=Au,u.ItemStack=jt,u.LegacyPositionalRandom=Vs,u.LegacyRandom=nt,u.Line=ur,u.Matrix3=Bn,u.Matrix4=lr,u.Mesh=ft,u.MultiNoiseBiomeSource=mr,u.NbtAbstractList=kn,u.NbtByte=Ut,u.NbtByteArray=de,u.NbtChunk=Xt,u.NbtCompound=pt,u.NbtDouble=pe,u.NbtEnd=An,u.NbtFile=Ht,u.NbtFloat=Pe,u.NbtInt=Zt,u.NbtIntArray=Wt,u.NbtList=Tt,u.NbtLong=Oe,u.NbtLongArray=ge,u.NbtRegion=me,u.NbtShort=ze,u.NbtString=_t,u.NbtTag=Y,u.NbtType=L,u.NoiseAquifer=Je,u.NoiseChunk=ai,u.NoiseChunkGenerator=sa,u.NormalNoise=ne,u.POTION_EFFECTS=Ps,u.PalettedContainer=Ts,u.PerlinNoise=gt,u.PerlinSimplexNoise=Wc,u.Quad=Gt,u.RandomState=aa,u.RawDataInput=ui,u.RawDataOutput=hi,u.Registry=Et,u.Renderer=dr,u.ShaderProgram=Tn,u.SimplexNoise=ht,u.StringReader=St,u.Structure=Kt,u.StructurePlacement=Rt,u.StructurePoolElement=Lt,u.StructureRenderer=Cu,u.StructureSet=Fe,u.StructureTemplatePool=De,u.SurfaceContext=ia,u.SurfaceSystem=ra,u.TextureAtlas=Ln,u.Vector=U,u.Vertex=Mt,u.VoxelRenderer=Pu,u.WorldgenStructure=pr,u.XoroshiroPositionalRandom=$s,u.XoroshiroRandom=W,u.binarySearch=Js,u.clamp=ve,u.clampedLerp=nr,u.clampedMap=qr,u.computeIfAbsent=ke,u.getItemColor=ea,u.getSeed=Wr,u.intToRgb=dt,u.inverseLerp=Yr,u.isPowerOfTwo=Xr,u.lazy=on,u.lazyLerp=Mn,u.lazyLerp2=$r,u.lazyLerp3=zs,u.lerp=te,u.lerp2=er,u.lerp3=Os,u.longfromBytes=ir,u.map=Rn,u.mutateWithDefault=_r,u.nextInt=ar,u.randomBetweenInclusive=sr,u.shuffle=Fs,u.smoothstep=rr,u.square=Qt,u.upperPowerOfTwo=Ds,Object.defineProperties(u,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});